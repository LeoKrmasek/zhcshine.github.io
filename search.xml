<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ffmpeg录制基础</title>
      <link href="/2019/07/24/ffmpeg%E5%BD%95%E5%88%B6%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E5%BD%95%E5%88%B6%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="ffmpeg录制功能"><a href="#ffmpeg录制功能" class="headerlink" title="ffmpeg录制功能"></a>ffmpeg录制功能</h4><blockquote><p>ffmpeg第一步：录制音视频</p></blockquote><h4 id="录制设备查询"><a href="#录制设备查询" class="headerlink" title="录制设备查询"></a>录制设备查询</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">➜  $ ffmpeg -hide_banner -devices</span><br><span class="line">Devices:</span><br><span class="line"> D. = Demuxing supported</span><br><span class="line"> .E = Muxing supported</span><br><span class="line"> --</span><br><span class="line"> DE alsa            ALSA audio output</span><br><span class="line"> DE fbdev           Linux framebuffer</span><br><span class="line"> D  iec61883        libiec61883 (new DV1394) A/V input device</span><br><span class="line"> D  jack            JACK Audio Connection Kit</span><br><span class="line"> D  kmsgrab         KMS screen capture</span><br><span class="line"> D  lavfi           Libavfilter virtual input device</span><br><span class="line"> DE oss             OSS (Open Sound System) playback</span><br><span class="line"> DE pulse           Pulse audio output</span><br><span class="line">  E sdl,sdl2        SDL2 output device</span><br><span class="line"> DE video4linux2,v4l2 Video4Linux2 output device</span><br><span class="line"> D  x11grab         X11 screen capture, using XCB</span><br><span class="line">  E xv              XV (XVideo) output device</span><br></pre></td></tr></table></figure><p>D：输入设备</p><p>E：输出设备 </p><p><a href="https://ffmpeg.org/ffmpeg-devices.html#Input-Devices" target="_blank" rel="noopener">ffmpeg输入设备列表</a></p><blockquote><p>alsa</p><blockquote><p>音频</p><p>ALSA是Advanced Linux Sound Architecture的缩写，高级Linux声音架构的简称,它在Linux操作系统上提供了音频和MIDI（Musical Instrument Digital Interface，音乐设备数字化接口）的支持，需要安装libasound库</p></blockquote><p>android_camera</p><blockquote><p>音视频</p><p>Android相机输入设备。 此输入设备使用Android Camera2 NDK API，该API可在API级别为24+的设备上使用。在配置期间自动检测android_camera的可用性。 该设备允许从Android设备上的所有摄像头进行捕获，这些摄像头集成在Camera2 NDK API中。 可用的摄像机在内部枚举，可以使用camera_index参数进行选择。输入文件字符串被丢弃。 通常，后置摄像头的索引为0，而前置摄像头的索引为1。</p></blockquote><p>avfoundation</p><blockquote><p>音视频</p><p>苹果设备</p></blockquote><p>bktr</p><blockquote><p>BSD 视频输入设备</p></blockquote><p>decklink</p><blockquote><p>BlackMagic Decklink是一款影像采集编辑产品，接口类型PCI-33/66、PCI-X 133&amp;100MHz 。</p></blockquote><p>dshow</p><blockquote><p>Windows DirectShow input device.</p></blockquote><p>fbdev</p><blockquote><p>Linux framebuffer（Linux帧缓冲）输入设备，只能录制终端的视频</p><p>Linux framebuffer是一种独立于硬件的图像抽象层，它用于在计算机屏幕上显示图像,通常是在控制台（环境）。它可以通过一个文件设备节点访问，通常为：<code>/dev/fb0</code></p></blockquote><p>gdigrab</p><blockquote><p>Win32 GDI 屏幕截取设备</p><p>这个设备允许你截取显示在Windows（系统）上的屏幕区域。</p></blockquote><p>iec61883</p><blockquote><p>使用<code>iec61883</code>的FireWire（火线） DV/HDV输入设备。</p><p>要允许这个输入设备，需要<code>libiec61883</code>, <code>libraw1394</code> 和 <code>libavc1394</code>被安装到系统中。此外还要在编译时配置<code>--enable-libiec61883</code>以支持。</p></blockquote><p>jack</p><blockquote><p>JACK输入设备。</p><p>为了能使用JACK设备，需要系统上存在<code>libjack</code></p></blockquote><p>kmsgrab</p><p>lavfi</p><blockquote><p><code>Libavfilter</code>输入虚拟设备</p><p>这个输入设备可以从<code>libavfilter</code>滤镜链图的一个开放输出端口读取数据。</p><p>对于每个滤镜链图开放输出端口，这个输入设备将创建一个对应的流映射到这个端口进行输出。当前只支持视频数据。滤镜链图是通过选项<code>graph</code>描述的。</p></blockquote><p>libcdio</p><blockquote><p>基于<code>libcdio</code>的音乐CD输入设备。</p><p>需要系统中有<code>libcdio</code>才能启用，且编译时需要用<code>--enable-libcdio</code>配置选项允许。</p></blockquote><p>libdc1394</p><blockquote><p>IIDC1394输入设备，其基于<code>libdc1394</code>和<code>libraw1394</code></p><p>编译允许需要配置<code>--enable-libdc1394</code></p></blockquote><p>openal</p><blockquote><p>这个OpenAL输入设备支持在所有实现了<code>OpenAL 1.1</code>的系统上进行音频捕获。</p><p>要编译使用它需要系统包含<code>OpenAL</code>头和<code>libraries</code>库，并且设置编译选项<code>--enable-openal</code></p></blockquote><p>oss</p><p>pulse</p><blockquote><p>PulseAudio（脉冲音频）输入设备</p><p>要使用须编译配置设置<code>--enable-libpulse</code></p></blockquote><p>sndio</p><blockquote><p>sndio输入设备。</p><p>要使用它需要系统安装并配置有<code>libsndio</code>库</p></blockquote><p>video4linux2, v4l2</p><blockquote><p>Video4Linux2 输入视频设备</p><p>“v4l2”是”video4linux2”的别名</p><p>编译需要<code>v4l-utiles</code>支持（<code>--enable-libv4l2</code>编译选项被配置），也可用于<code>-use_libv4l2</code>输入设备选项。</p><p>捕获的设备名是一个文件设备节点，通常Linux系统在设备（例如USB摄像头）插入到系统时自动创建这样的节点，会被命名为<code>/dev/videoN</code>，<code>N</code>是设备索引序号</p><p>Video4Linux设备通常只支持有限的分辨率（<code>width x height</code>）和帧率,通过<code>-list_formats all</code>选项来获取支持情况。一些设备，例如电视卡可以支持1个或者多个标准，它支持的标准可以通过<code>-list_standards all</code>来了解。</p><p>时间戳时基单位为1microsecond。根据内核版本和配置，时间戳可以基于实时间（real time clock——绝对时间，一种起源于Unix的表示方式）或者单调时钟（monotonic clock——通常源自启动时间，不受NTP或者手动改变）。<code>-timestamps abs</code>或者<code>-ts abs</code>选择启用实时间。</p></blockquote><p>vfwcap</p><blockquote><p>vfw（Video for Windows）捕获输入端</p><p>文件名必须是捕获设备索引，范围0-9可以用<code>list</code>作为文件名，将输出一个设备列表。任何数字外其它文件名被视作设备索引0。</p></blockquote><p>x11grab</p><blockquote><p>X11 视频输入设备</p><p>使用需要<code>libxcb</code>库，它会在编译时自动检测。</p></blockquote></blockquote><h5 id="fbdev：-linux终端录制设备"><a href="#fbdev：-linux终端录制设备" class="headerlink" title="fbdev： linux终端录制设备"></a>fbdev： linux终端录制设备</h5><p>查看使用指定采集设备参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -hide_banner -h demuxer=fbdev</span><br><span class="line">Demuxer fbdev [Linux framebuffer]:</span><br><span class="line">fbdev indev AVOptions:</span><br><span class="line">  -framerate         &lt;video_rate&gt; .D.......  (default "25")</span><br><span class="line"><span class="meta">#</span> framerate 帧数 默认25帧</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> sudo ffmpeg -framerate 30  -f fbdev -i /dev/fb0 output.mp4</span><br></pre></td></tr></table></figure><h5 id="v412：linux摄像头录制设备"><a href="#v412：linux摄像头录制设备" class="headerlink" title="v412：linux摄像头录制设备"></a>v412：linux摄像头录制设备</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -hide_banner -h demuxer=Video4Linux2</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>-standard</td><td>字符串</td><td>设置tv标准</td></tr><tr><td>-channel</td><td>整数</td><td>设置tv通道</td></tr><tr><td>-video_size</td><td>图像大小</td><td>设置采集视频频帧大小</td></tr><tr><td>-pixel_format</td><td>字符串</td><td>设置采集视频的分辨率</td></tr><tr><td>-input_format</td><td>字符串</td><td>设置采集视频的分辨率</td></tr><tr><td>-framerate</td><td>字符串</td><td>设置采集视频帧率</td></tr><tr><td>-list_formats</td><td>整数</td><td>列举输入视频信号的信息</td></tr><tr><td>-list_standards</td><td>整数</td><td>列举标准信息</td></tr><tr><td>-timestamps</td><td>整数</td><td>设置时间戳</td></tr><tr><td>-ts</td><td>整数</td><td>设置模拟器分析帧使用的时间戳</td></tr><tr><td>-use_libv4l2</td><td>布尔</td><td>使用第三方库libv412选项</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -hide_banner -f Video4Linux2 -list_formats all -i /dev/video0</span><br><span class="line"><span class="meta">#</span> /dev/video0根据自己的摄像头来设置</span><br></pre></td></tr></table></figure><h5 id="x11grab：linux桌面录制设备"><a href="#x11grab：linux桌面录制设备" class="headerlink" title="x11grab：linux桌面录制设备"></a>x11grab：linux桌面录制设备</h5><p><a href="https://trac.ffmpeg.org/wiki/Capture/Desktop" target="_blank" rel="noopener">桌面录制方法</a></p><p>linux环境下如果此方法报错</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cannot open display :0.0, error 1.</span><br><span class="line">:0.0: Input/output error</span><br></pre></td></tr></table></figure><p>则需要查看$DISPLAY， 在Linux/Unix类操作系统上, DISPLAY用来设置将图形显示到何处. 直接登陆图形界面或者登陆命令行界面后使用startx启动图形, DISPLAY环境变量将自动设置为:0:0</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> echo $DISPLAY</span><br><span class="line">:1</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 output.mp4</span><br></pre></td></tr></table></figure><blockquote><p>video_size 字符串 输入采集视频的分辨率</p><p>framerate 字符串 输入采集的视频帧率</p><p>-f 指定输入设备</p><p>-i 指定输入内容（此处为显示器）+100, 200 代表从100, 200处位移<br>使用pulse录制音频</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> pactl list sources  # 查看全部输入设备</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -f pulse -i default pulse.wav</span><br></pre></td></tr></table></figure><p>同时录制视频和音频</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -video_size 1366x768 -framerate 25 -f x11grab -i :1 -f pulse -ac 2 -i 1 output.mkv</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 -f alsa -ac 2 -i hw:0 output.mkv</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg封装与解封装基础</title>
      <link href="/2019/07/24/ffmpeg%E5%B0%81%E8%A3%85%E4%B8%8E%E8%A7%A3%E5%B0%81%E8%A3%85%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E5%B0%81%E8%A3%85%E4%B8%8E%E8%A7%A3%E5%B0%81%E8%A3%85%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="ffmpeg封装与解封装"><a href="#ffmpeg封装与解封装" class="headerlink" title="ffmpeg封装与解封装"></a>ffmpeg封装与解封装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i input.mkv -vcodec copy -acodec copy output.mp4</span><br></pre></td></tr></table></figure><blockquote><p>-i 输入文件</p><p>-vcodec copy 视频编码处理方式</p><p>-acodec copy 音频编码处理方式</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i input.mp4 -vn -acodec copy output.aac  # 抽出音频</span><br><span class="line">$ ffmpeg -i input.mp4 -vcodec copy -an output.h264  # 抽出视频</span><br></pre></td></tr></table></figure><h5 id="提取YUV数据"><a href="#提取YUV数据" class="headerlink" title="提取YUV数据"></a>提取YUV数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv</span><br></pre></td></tr></table></figure><blockquote><p>-i 输入设备</p><p>-an 不需要音频</p><p>-c:v 使用rawvideo对视频进行编码</p><p>-pix_fmt 像素格式</p></blockquote><p>播放源文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffplay -video_size 1366x768 out.yuv</span><br></pre></td></tr></table></figure><blockquote><p>-video_size 指定像素</p></blockquote><h5 id="提取PCM数据"><a href="#提取PCM数据" class="headerlink" title="提取PCM数据"></a>提取PCM数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure><blockquote><p>-i 输入设备</p><p>-vn 不需要视频</p><p>-ar 44100 -a 音频 read 音频采样率44.1k</p><p>-ac 2 -a 音频 c2 channel 2 双声道</p><p>-f 数据存储格式 s16le   s: 有符号的 </p></blockquote><p>播放源文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffplay -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg直播基础</title>
      <link href="/2019/07/24/ffmpeg%E7%9B%B4%E6%92%AD%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E7%9B%B4%E6%92%AD%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h5 id="直播推流"><a href="#直播推流" class="headerlink" title="直播推流"></a>直播推流</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName</span><br></pre></td></tr></table></figure><blockquote><p>-re 保持本地视频和流媒体服务器帧率一致</p><p>-c 不做操作，直接复制</p><p>-f 格式</p></blockquote><h5 id="直播拉流"><a href="#直播拉流" class="headerlink" title="直播拉流"></a>直播拉流</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i rmtp://server/live/streamName -c copy dump.flv</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg滤镜基础</title>
      <link href="/2019/07/24/ffmpeg%E6%BB%A4%E9%95%9C%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E6%BB%A4%E9%95%9C%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h5 id="裁剪滤镜"><a href="#裁剪滤镜" class="headerlink" title="裁剪滤镜"></a>裁剪滤镜</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i output.mkv -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy output.mp4</span><br></pre></td></tr></table></figure><blockquote><p>-i 输入</p><p>-vf -v 视频 f 滤镜 crop 裁剪滤镜</p><p>-c:v</p><p>-c:a copy 音频直接复制</p></blockquote><h5 id="视频裁剪"><a href="#视频裁剪" class="headerlink" title="视频裁剪"></a>视频裁剪</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i output.mkv -ss 00:00:00 -t 10 output.mp4</span><br></pre></td></tr></table></figure><blockquote><p>-ss 开始时间(时:分:秒)</p><p>-t 时常(秒)</p></blockquote><h5 id="视频合并"><a href="#视频合并" class="headerlink" title="视频合并"></a>视频合并</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -f concat -i inputs.txt output.mp4</span><br></pre></td></tr></table></figure><blockquote><p>-f  concat 拼接</p><p>-i 输入文件 inputs.txt 记录全部等待拼接的文件</p><p>inputs.txt每一行为“file filename”</p><pre><code>&gt; file &apos;out1.mp4&apos;&gt;&gt; file &apos;out2.mp4&apos;</code></pre><p>output.mp4 输出文件</p></blockquote><h5 id="视频转图片"><a href="#视频转图片" class="headerlink" title="视频转图片"></a>视频转图片</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i output.mp4 -r 1 -f image2 image-%3d.jpeg</span><br></pre></td></tr></table></figure><blockquote><p>-i 输入文件</p><p>-r 1, r 帧率， 1 每秒一张图片</p><p>-f image2, 转成image2格式</p><p>image-%3d.jpeg 输出文件</p></blockquote><h5 id="图片转视频"><a href="#图片转视频" class="headerlink" title="图片转视频"></a>图片转视频</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i image-%3d.jpeg output.mp4</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg命令基础</title>
      <link href="/2019/07/24/ffmpeg%E5%91%BD%E4%BB%A4%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E5%91%BD%E4%BB%A4%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="ffmpeg基本流程"><a href="#ffmpeg基本流程" class="headerlink" title="ffmpeg基本流程"></a>ffmpeg基本流程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文件-&gt;音视频流: demuxer解封装</span><br><span class="line">音视频流-&gt;数据包: decoder解码</span><br><span class="line">数据包-&gt;音视频流: encoder编码</span><br><span class="line">音视频流-&gt;文件: muxer封装</span><br></pre></td></tr></table></figure><h4 id="ffmpeg基本定义"><a href="#ffmpeg基本定义" class="headerlink" title="ffmpeg基本定义"></a>ffmpeg基本定义</h4><ol><li>文件：也叫容器Container，比如mp4文件、flv文件等，容器的类型决定了信息被存放在文件中的位置。</li><li>音视频流： </li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg视频基础</title>
      <link href="/2019/07/24/ffmpeg%E8%A7%86%E9%A2%91%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E8%A7%86%E9%A2%91%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><p>H264基本概念</p><blockquote><p>I帧： 关键帧、采用帧内压缩技术<br>P帧：向前参考帧，采用帧内压缩技术<br>B帧：双向参考帧，采用帧内压缩技术</p></blockquote><p>GOF:</p><blockquote><p>一组帧group of frame</p></blockquote><p>SPS:</p><blockquote><p>Sequence parameter set: 序列参数集：存放一组帧的存放帧数，参考帧数目，解码图像尺寸等</p></blockquote><p>PPS：</p><blockquote><p>picture parameter set: 图像参数集：存放熵编码模式选择标识、片组数目等</p></blockquote><h4 id="视频编解码器"><a href="#视频编解码器" class="headerlink" title="视频编解码器"></a>视频编解码器</h4><blockquote><p>x264：最流行的<br>x265：耗性能<br>openH264：支持svc视频技术<br>vp8: x264<br>vp9: x265</p></blockquote><h4 id="H264压缩技术"><a href="#H264压缩技术" class="headerlink" title="H264压缩技术"></a>H264压缩技术</h4><blockquote><p>帧内压缩：解决空域数据冗余技术</p><p>帧间压缩：解决时域数据冗余技术</p><p>整数离散余弦变换(DCT)：将空间上的相关性变为频域上无关的数据然后进行量化</p><p>CABAC压缩</p></blockquote><p><img src="https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/H264%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="H264结构图"></p><h4 id="H264编码分层"><a href="#H264编码分层" class="headerlink" title="H264编码分层"></a>H264编码分层</h4><blockquote><p>NAL层：network abstraction layer 视频数据网络抽象层<br>VCL层：video coding layer 视频数据编码层</p></blockquote><h4 id="码流"><a href="#码流" class="headerlink" title="码流"></a>码流</h4><p>SODB</p><blockquote><p>string of data bits 原始数据比特流，它是由vcl层产生的</p></blockquote><p>RBSP</p><blockquote><p>在SODB最后一位补1，不按字节对其则补0</p></blockquote><p>EBSP</p><blockquote></blockquote><p>NALU</p><blockquote><p>NAL HEADER + EBSP</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ffmpeg音频基础</title>
      <link href="/2019/07/24/ffmpeg%E9%9F%B3%E9%A2%91%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/07/24/ffmpeg%E9%9F%B3%E9%A2%91%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>2# 音频知识（未完工）</p><h4 id="声音的本质"><a href="#声音的本质" class="headerlink" title="声音的本质"></a>声音的本质</h4><blockquote><p>声音其实是一种能量波，因此也有频率和振幅的特征，频率对应于时间轴线，振幅对应于电平轴线。波是无限光滑的，弦线可以看成由无数点组成，由于存储空间是相对有限的，数字编码过程中，必须对弦线的点进行采样。</p></blockquote><h4 id="声音三要素"><a href="#声音三要素" class="headerlink" title="声音三要素"></a><a href="https://baike.baidu.com/item/%E5%A3%B0%E9%9F%B3%E5%90%AC%E8%A7%89" target="_blank" rel="noopener">声音三要素</a></h4><ol><li><p>音高/音调/音频： 客观上音高大小主要取决于声波基频的高低，频率高则音调高，反之则低，单位用赫兹(Hz）表示。儿童(高音区)-&gt;女生(高音区)-&gt;男生（低音区）</p></li><li><p>音量/响度/声强：常说的声音大小，主要取决于声波振幅的大小。</p></li><li><p>音色/音品：和材质相关（比如钢琴等），本质是谐波。</p></li></ol><p><img src="https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%87%8F%E5%92%8C%E5%A3%B0%E8%B0%83.png" alt="音量和声调"></p><p>心理声学</p><blockquote><p>人类的听觉范围：20Hz-20kHz</p></blockquote><h4 id="音频量化过程"><a href="#音频量化过程" class="headerlink" title="音频量化过程"></a>音频量化过程</h4><p><img src="https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%A2%91%E9%87%8F%E5%8C%96%E8%BF%87%E7%A8%8B.png" alt="音频量化过程"></p><ol><li>按横轴时间进行切割</li><li>按纵轴振幅(决定音量)进行切割</li><li>编码转成数字信号</li></ol><blockquote><p>采样大小：一个采样用多个bit存放，常用16位(2<sup>16</sup>=65535)，振幅<br>采样率：采样频率8k、16k、32k、44.1k、48k等 <a href="https://baike.baidu.com/item/音频采样率" target="_blank" rel="noopener">采样率概念</a><br>声道数：单声道、双声道、多声道</p></blockquote><p>码率计算</p><blockquote><p>音频流的码率=采样率×采样大小×声道数<br>例如：采样率44.1kHz、采样大小为16bit、双声道的pcm编码wav文件，码率=44.1k×16×2=1411.2kb/s</p></blockquote><h4 id="音频压缩技术"><a href="#音频压缩技术" class="headerlink" title="音频压缩技术"></a>音频压缩技术</h4><ol><li>消除音频冗余数据</li></ol><blockquote><p>删除人耳听觉范围外的音频信号：</p><blockquote><p>20Hz-20kHz</p></blockquote><p>被掩避掉的音频信号： </p><blockquote><p>频域遮蔽：</p><p>时域遮蔽：</p></blockquote></blockquote><ol start="2"><li>哈夫曼无损编码</li></ol><h4 id="音频编解码器"><a href="#音频编解码器" class="headerlink" title="音频编解码器"></a>音频编解码器</h4><p>常见的编解码器</p><blockquote><p>OPUS： 开源、rmtp协议不支持<br>AAC：收费、适合实时互动项目。<br>Vorbis：开源<br>Speex：开源、优势：还支持一些回音消除、降噪等处理办法<br>iLBC<br>AMR<br>G.711：与固定电话就行融合</p></blockquote><p>性能对比：</p><blockquote><p>OPUS &gt; AAC(常用) &gt; Vorbis<br>AAC： advanced audio coding<br>常见规格： AAC LC（低复杂度，码流128k）、AAC HE V1（）、 AAC HE V2<br>AAC LC + SBR = AAC HE V1<br>AAC HE V1 + PS = AAC HE V2</p></blockquote><p><img src="https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/aac%E8%A7%84%E6%A0%BC.png" alt="aac规格"></p><p>AAC格式：</p><blockquote><p>ADIF<br>ADTS</p></blockquote><p>AAC编码库：</p><blockquote><p>libfdk_aac(常用) &gt; ffmpeg aac &gt; libfaac &gt; libvo_aacenc</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ffmpeg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zabbix入门基础</title>
      <link href="/2018/11/16/zabbix%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/11/16/zabbix%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="安装服务器端"><a href="#安装服务器端" class="headerlink" title="安装服务器端"></a>安装服务器端</h4><p><a href="https://www.zabbix.com/download" target="_blank" rel="noopener">官方</a> 1. 根据实际情况选择数据库 2. 根据实际情况选择操作系统</p><h4 id="汉化"><a href="#汉化" class="headerlink" title="汉化"></a>汉化</h4><p><img src="/wp-content/uploads/2018/11/2018-11-16-17-36-53%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" alt> 错误提示</p><blockquote><p>You are not able to choose some of the languages, because locales for them are not installed on the web server.</p></blockquote><pre><code># 选中zh-CN UTF-8sudo dpkg-reconfigure localessudo service apache2 restart</code></pre><h4 id="安装客户端"><a href="#安装客户端" class="headerlink" title="安装客户端"></a>安装客户端</h4><p><a href="https://www.zabbix.com/documentation/3.2/manual/installation/install_from_packages/agent_installation" target="_blank" rel="noopener">官方</a> <a href="https://tecadmin.net/install-zabbix-agent-on-centos-rhel/" target="_blank" rel="noopener">参考</a></p><h4 id="设置邮件报警"><a href="#设置邮件报警" class="headerlink" title="设置邮件报警"></a>设置邮件报警</h4><p>Media types <img src="/wp-content/uploads/2018/11/zabbix-email.png" alt> <img src="/wp-content/uploads/2018/11/zabbix-email-1.png" alt></p><h4 id="交换分区错误问题"><a href="#交换分区错误问题" class="headerlink" title="交换分区错误问题"></a>交换分区错误问题</h4><pre><code>Lack of free swap space</code></pre><p>现在的云主机默认没有交换分区 Configuration-&gt;Templates-&gt;Template OS Linux-&gt;Triggers-&gt;Lack of free swap space on {HOST.NAME}-&gt;Expression</p><pre><code>{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50改成{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50 and {Template OS Linux:system.swap.size[,free].last(0)}&lt;&gt;0</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7.2安装使用openResty</title>
      <link href="/2018/11/14/centos7.2%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8openResty/"/>
      <url>/2018/11/14/centos7.2%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8openResty/</url>
      
        <content type="html"><![CDATA[<pre><code># 安装sudo yum install pcre-devel openssl-devel gcc curlwget https://openresty.org/download/openresty-1.13.6.2.tar.gztar -xzvf openresty-1.13.6.2.tar.gzcd openresty-1.13.6.2# 默认安装到/usr/local/openresty, 可以指定./configure --prefix=/your/path/openresty设置# 默认安装的组件https://openresty.org/cn/components.html./configure --with-luajit \            --without-http_redis2_module \            --with-http_iconv_module \            --with-http_postgres_modulemake &amp;&amp; sudo make install# 创建软链接ln -s /usr/local/openresty/nginx/sbin/nginx /usr/local/nginx# 启动/重启/停止nginx nginx -s reloadnginx -s stop</code></pre><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><ul><li>openResty的nginx和普通nginx配置一致</li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>linux环境nginx/php-fpm权限问题</title>
      <link href="/2018/11/10/linux%E7%8E%AF%E5%A2%83nginx-php-fpm%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/"/>
      <url>/2018/11/10/linux%E7%8E%AF%E5%A2%83nginx-php-fpm%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="当前用户hanchang-nginx用户nginx"><a href="#当前用户hanchang-nginx用户nginx" class="headerlink" title="当前用户hanchang, nginx用户nginx"></a>当前用户hanchang, nginx用户nginx</h4><pre><code>vim /etc/nginx/nginx.confuser hanchang;vim /etc/php-fpm.d/www.conf user = hanchanggroup = nginxlisten.owner = hanchanglisten.group = nginxlisten.mode = 0660</code></pre><h4 id="划重点-将当前用户加入nginx用户组"><a href="#划重点-将当前用户加入nginx用户组" class="headerlink" title="划重点 将当前用户加入nginx用户组"></a>划重点 将当前用户加入nginx用户组</h4><pre><code>sudo usermod -a -G nginx hanchang</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu16.04安装及使用SVN</title>
      <link href="/2018/10/09/ubuntu16.04%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8SVN/"/>
      <url>/2018/10/09/ubuntu16.04%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8SVN/</url>
      
        <content type="html"><![CDATA[<h4 id="服务器端安装"><a href="#服务器端安装" class="headerlink" title="服务器端安装"></a>服务器端安装</h4><p><a href="https://help.ubuntu.com/lts/serverguide/subversion.html.en/" target="_blank" rel="noopener">官方推荐</a></p><pre><code># 安装包sudo apt install subversion apache2 libapache2-svn# 创建目录及两个svn项目mkdir svnsvnadmin create svn/doneself-appsvnadmin create svn/doneself-web# 多个项目公用一个权限文件cp -rf svn/doneself/conf/passwd snv/cp -rf svn/doneself/conf/authz snv/# 编辑每个项目的配置文件vim svn/doneself/conf/svnserve.conf[general]   # 匿名用户没有权限anon-access = none# 验证用户写权限auth-access = write# 账号密码文件路径password-db = ../../passwd # 权限文件路径authz-db = ../../authz# 编写账号密码文件vim svn/passwd[users] ui = ui  # 注意空格# 编写组和权限文件vim svn/[groups]ui = ui  [doneself-app:/]  ui = wr</code></pre><h4 id="启动svn服务器"><a href="#启动svn服务器" class="headerlink" title="启动svn服务器"></a>启动svn服务器</h4><pre><code># 启动,默认端口号3690sudo svnserve -d -r /home/svn# 结束sudo pkill svnserve</code></pre>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vue.js</title>
      <link href="/2018/09/26/vuejs/"/>
      <url>/2018/09/26/vuejs/</url>
      
        <content type="html"><![CDATA[<h4 id="安装nodejs"><a href="#安装nodejs" class="headerlink" title="安装nodejs"></a>安装nodejs</h4><pre><code># 安装nodejs# https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributionscurl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -sudo apt-get install -y nodejs# 安装cnpmsudo npm install -g cnpm</code></pre><h4 id="安装vue-cli"><a href="#安装vue-cli" class="headerlink" title="安装vue-cli"></a>安装vue-cli</h4><pre><code>sudo cnpm install -g vue-cli</code></pre><h4 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h4><pre><code>vue init webpack your-project cnpm install npm run dev  # 启动项目</code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7.2安装及使用docker</title>
      <link href="/2018/09/08/centos7.2%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8docker/"/>
      <url>/2018/09/08/centos7.2%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8docker/</url>
      
        <content type="html"><![CDATA[<pre><code># https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce# 卸载旧版本$ sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine# 安装依赖包$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2# 安装源$ sudo yum-config-manager  --add-repo https://download.docker.com/linux/centos/docker-ce.repo# 安装$ sudo yum install docker-ce# 启动$ sudo systemctl start docker$ sudo systemctl enable docker# 测试$ sudo docker run hello-world# 加入用户组(记得退出重新登录) https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user# 安装docker-compose$ sudo yum install epel-release$ sudo yum install python-pip$ sudo pip install docker-compose# 换源https://lug.ustc.edu.cn/wiki/mirrors/help/docker</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7.2安装使用sentry</title>
      <link href="/2018/09/08/centos7.2%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8sentry/"/>
      <url>/2018/09/08/centos7.2%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8sentry/</url>
      
        <content type="html"><![CDATA[<pre><code># 先安装docker  https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce# 后安装sentry   https://github.com/getsentry/onpremise$ mkdir sentry$ cd sentry$ mkdir -p data/{sentry,postgres}$ git clone https://github.com/getsentry/onpremise$ cd onpremise$ docker-compose run --rm web config generate-secret-key # 创建一个secret key并配置到docker-compose.yml中的SENTRY_SECRET_KEY.$ docker-compose run --rm web upgrade # 创建数据库$ docker-compose up -d  # 后台执行</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7.2使用rabbitMQ</title>
      <link href="/2018/09/08/centos7.2%E4%BD%BF%E7%94%A8rabbitMQ/"/>
      <url>/2018/09/08/centos7.2%E4%BD%BF%E7%94%A8rabbitMQ/</url>
      
        <content type="html"><![CDATA[<pre><code># 安装 Erlangyum -y install epel-releaseyum -y updateyum -y install erlang socat# 查看是否安装成功erl -version# 安装rabbitMQwget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpmrpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.ascrpm -Uvh rabbitmq-server-3.6.10-1.el7.noarch.rpm# 启用,开机启动,状态systemctl start rabbitmq-serversystemctl enable rabbitmq-serversystemctl status rabbitmq-server# 启动图形界面管理rabbitmq-plugins enable rabbitmq_managementchown -R rabbitmq:rabbitmq /var/lib/rabbitmq/rabbitmqctl add_user admin StrongPassword  # 踩坑:密码不要以&apos;;&apos;结尾rabbitmqctl set_user_tags admin administratorrabbitmqctl set_permissions -p / admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;# 自定义配置文件cd /etc/rabbitmqtouch rabbitmq.conf# 访问图形界面http://Your_Server_IP:15672/# api文档http://Your_Server_IP:15672/api</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>postgresql入门基础</title>
      <link href="/2018/08/07/postgresql%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/08/07/postgresql%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="manjaro安装"><a href="#manjaro安装" class="headerlink" title="manjaro安装"></a>manjaro安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://aur.archlinux.org/postgresql-9.6.git</span><br><span class="line">$ cd postgresql-9.6-git</span><br><span class="line">$ less PKGBUILD  # 查看</span><br><span class="line">$ makepkg -si  # 安装</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 初始化数据</span><br><span class="line">$ sudo su postgres -l </span><br><span class="line">$ initdb --locale $LANG -E UTF8 -D &apos;/var/lib/postgres/data/&apos;</span><br><span class="line">$ exit</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 启动及开机启动</span><br><span class="line">sudo systemctl start postgresql.service </span><br><span class="line">sudo systemctl enable postgresql.service</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 登录</span><br><span class="line">$ sudo su postgres -l</span><br><span class="line">$ psql</span><br></pre></td></tr></table></figure><h4 id="安装postgis"><a href="#安装postgis" class="headerlink" title="安装postgis"></a>安装postgis</h4><p>1, 安装proj4.9</p><p>下载源码 <a href="https://proj.org/download.html" target="_blank" rel="noopener">地址</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar xfz proj-4.9.3.tar.gz</span><br><span class="line">cd proj-4.9.3</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line"># 安装postgis时，如果没有找到库则需要复制动态库</span><br><span class="line">sudo ln -s /usr/local/lib/libproj.so.12 /usr/lib/libproj.so.12</span><br></pre></td></tr></table></figure><p>2, 安装postgis2.5.2</p><p>下载源码 <a href="https://postgis.net/source/" target="_blank" rel="noopener">地址</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.osgeo.org/postgis/source/postgis-2.5.2.tar.gz</span><br><span class="line">tar xfz postgis-2.5.2.tar.gz</span><br><span class="line">cd postgis-2.5.2</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line">sudo make comments-install</span><br></pre></td></tr></table></figure><h4 id="ubuntu-centos安装"><a href="#ubuntu-centos安装" class="headerlink" title="ubuntu/centos安装"></a>ubuntu/centos安装</h4><p><a href="https://www.postgresql.org/download/linux/ubuntu/" target="_blank" rel="noopener">ubuntu安装</a> <a href="https://www.postgresql.org/download/linux/redhat/" target="_blank" rel="noopener">centos安装</a> centos7.2 安装postgresql9.6</p><pre><code># 添加RPMyum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm# 安装PostgreSQL 9.6# postgresql96-server 数据库核心服务端# postgresql96-contrib 附加第三方扩展# postgresql96-devel C语言开发Header头文件和库yum install postgresql96-server postgresql96-contrib postgresql96-devel# 验证是否安装成功rpm -aq| grep postgres# 设置目录（可省略）cd /mntsudo mkdir vdb1sudo chown -R postgres:postgres vdb1sudo chmod 700 vdb1vi /usr/lib/systemd/system/postgresql-9.6.serviceEnvironment=PGDATA=/mnt/vdb1/ 修改为自己的新的数据路径# 初始化数据库sudo /usr/pgsql-9.6/bin/postgresql96-setup initdb# 开启服务sudo service postgresql-9.6 start 或者 systemctl start postgresql-9.6.service# 开机启动sudo sudo chkconfig postgresql-9.6 on 或者 systemctl enable postgresql-9.6.service# 配置文件 /var/lib/pgsql/9.6/data/postgresql.conf 通用设置 /var/lib/pgsql/9.6/data/pg_hba.conf  控制访问安全 /var/lib/pgsql/9.6/data/pg_ident.conf 配合pg_hba.conf使用  sudo su postgrespsql # 进入命令行模式# 修改密码ALTER USER postgres WITH PASSWORD &apos;密码&apos;; # 创建用户CREATE USER userdoneself WITH PASSWORD &apos;密码passworddoneself&apos;;# 创建数据库create --encoding=UTF8 database dbdoneself owner userdoneself;# 赋予权限grant all privileges on database dbdoneself to userdoneself;\q# 安装postgresql时，系统会自动创建postgres用户# 开启远程访问vi /var/lib/pgsql/9.6/data/postgresql.conf 或者  vi /mnt/vdb1/postgresql.conf(创建了目录)修改#listen_addresses = &apos;localhost&apos; 为  listen_addresses=&apos;*&apos;# 连接数据库先配置登录权限vim pg_hba.conf# 是否远程登录 数据库 用户名 ip地段 方式# 允许doneself用户远程访问host doneself doneself 127.0.0.1/32 md5# 允许管理员密码登录local all postgres  md5# 如果不知道怎么配置， 将全部登录方式改成md5# 查看版本/usr/pgsql-9.6/bin/psql --version</code></pre><h4 id="安装postgis2"><a href="#安装postgis2" class="headerlink" title="安装postgis2"></a>安装postgis2</h4><p>centos7.2</p><pre><code>sudo yum install postgis2_96  # 96和安装的postgresql一致sudo yum install ogr_fdw96  # 安装ogrfdwsudo yum install pgrouting_96 # 安装pgrouting# 用管理员登录postgerysql&gt;-- Enable PostGIS (includes raster)CREATE EXTENSION postgis;-- Enable TopologyCREATE EXTENSION postgis_topology;-- Enable PostGIS Advanced 3D-- and other geoprocessing algorithms-- sfcgal not available with all distributionsCREATE EXTENSION postgis_sfcgal;-- fuzzy matching needed for TigerCREATE EXTENSION fuzzystrmatch;-- rule based standardizerCREATE EXTENSION address_standardizer;-- example rule data setCREATE EXTENSION address_standardizer_data_us;-- Enable US Tiger GeocoderCREATE EXTENSION postgis_tiger_geocoder;# 验证是否安装成功#postgres=&gt; postgis_full_version();</code></pre><h4 id="安装postgresql中文全文搜索zhparser"><a href="#安装postgresql中文全文搜索zhparser" class="headerlink" title="安装postgresql中文全文搜索zhparser"></a>安装postgresql中文全文搜索zhparser</h4><p>centos7.2</p><pre><code> yum install bzip2  # 安装解压包 # 安装SCWS中文分词 https://github.com/hightman/scws wget http://www.xunsearch.com/scws/down/scws-1.2.3.tar.bz2 tar -jxvf scws-1.2.3.tar.bz2  cd scws-1.2.3 ./configure make install # 测试 scws &apos;请问怎么自己动手做西红柿蛋炒饭&apos; -c utf-8 # 安装zhparser git clone https://github.com/amutu/zhparser.git cd zhparserexport PATH=$PATH:/usr/pgsql-9.6/bin/cmake &amp;&amp; make install# 登录（第一次登录）&gt; sudo su - postgres# 修改可以md5登录后&gt; &gt; psql -U user -D database -W&gt;  输入口令# 创建用户user=&gt;  CREATE USER dbuser WITH PASSWORD &apos;password&apos;;# 修改密码user=&gt;  ALTER USER dbuser WITH PASSWORD &apos;newpassword&apos;;# 赋予权限user=&gt;  GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;# 允许用户创建数据库user=&gt; ALTER USER doneself CREATEDB;# 设置为超级管理员user=&gt; ALTER ROLE doneself SUPERUSER;# 创建数据库user=&gt;  Create database exampledb owner=dbuser  template= template1  ENCODING = &apos;UTF8&apos;;# 选择数据库user=&gt; \c database# 查看当前数据库所有表user=&gt;  \dtuser=&gt;  \d 数据库 —— 得到所有表的名字user=&gt;  \d 表名 —— 得到表结构</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>java入门基础</title>
      <link href="/2018/01/31/java%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/01/31/java%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="linux安装java开发环境"><a href="#linux安装java开发环境" class="headerlink" title="linux安装java开发环境"></a>linux安装java开发环境</h3><pre><code>[root@localhost ~]# mkdir /usr/java[root@localhost ~]# cd /usr/java# 从官方网站下载javaLTS版本源码并复制到当前目录# 下载地址: https://www.oracle.com/technetwork/java/javase/downloads/index.html[root@localhost ~]# tar -zxvf jdk-11.0.3_linux-x64_bin.tar.gz &amp;&amp; rm  jdk-11.0.3_linux-x64_bin.tar.gz# 设置环境变量vi /etc/profile#set java environmentJAVA_HOME=/usr/java/jdk-11.0.3JRE_HOME=/usr/java/jdk-11.0.3/jreCLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASS_PATH PATH# 验证[root@localhost ~]# which java/usr/java/jdk-11.0.3/bin/java[root@localhost ~]# java -versionjava version &quot;11.0.3&quot; 2019-04-16 LTSJava(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS)                                           Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>微信本地开发及线上环境搭建</title>
      <link href="/2018/01/29/%E5%BE%AE%E4%BF%A1%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E5%8F%8A%E7%BA%BF%E4%B8%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2018/01/29/%E5%BE%AE%E4%BF%A1%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E5%8F%8A%E7%BA%BF%E4%B8%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="微信开发者中心"><a href="#微信开发者中心" class="headerlink" title="微信开发者中心"></a>微信开发者中心</h4><p><a href="https://open.weixin.qq.com" target="_blank" rel="noopener">https://open.weixin.qq.com</a> 1. 注册线上账号，开发者资质认证 2. 注册本地账号，开发者资质认证</p><h4 id="网站应用"><a href="#网站应用" class="headerlink" title="网站应用"></a>网站应用</h4><ol><li>添加相关信息，并盖章认证，添加授权回调域example.com</li><li>认证通过后获取AppId, AppSecret</li></ol><h4 id="公众号应用"><a href="#公众号应用" class="headerlink" title="公众号应用"></a>公众号应用</h4><h4 id="本地环境配置"><a href="#本地环境配置" class="headerlink" title="本地环境配置"></a>本地环境配置</h4><ol><li>将回调的url <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> 添加到host文件中</li></ol>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 微信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redis基础</title>
      <link href="/2018/01/11/redis%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/01/11/redis%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p><h3 id="redis安装"><a href="#redis安装" class="headerlink" title="redis安装"></a>redis安装</h3><pre><code>$sudo apt-get update$sudo apt-get install redis-server$redis-cli</code></pre><h3 id="redis配置"><a href="#redis配置" class="headerlink" title="redis配置"></a>redis配置</h3><pre><code>sudo vim /etc/redis.conf# 设置为守护进程protected-mode yes# 设置密码requirepass redispassword# portport 6379# bind 127.0.0.1bing 0.0.0.0 # 允许远程访问</code></pre><h3 id="客户端远程登录"><a href="#客户端远程登录" class="headerlink" title="客户端远程登录"></a>客户端远程登录</h3><pre><code>redis-cli -h 127.0.0.1 -p 6379 -a redispassword</code></pre><h3 id="redis客户端"><a href="#redis客户端" class="headerlink" title="redis客户端"></a>redis客户端</h3><pre><code># redis-commander，基于nodejs$ npm install -g redis-commander$ redis-commander</code></pre><h3 id="通用命令"><a href="#通用命令" class="headerlink" title="通用命令"></a>通用命令</h3><pre><code>$ 127.0.0.1:6379&gt; del name # 删除数据$ 127.0.0.1:6379&gt; type name # 查看数据类型$ 127.0.0.1:6379&gt; rename name # 重命名</code></pre><h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><p>字符串string</p><pre><code>$ 127.0.0.1:6379&gt;  set string-name value$ 127.0.0.1:6379&gt; get string-name$ 127.0.0.1:6379&gt;  del string-name</code></pre><p>列表list： 相当于默认键的数组</p><pre><code>$ 127.0.0.1:6379&gt; lpush list-name value1 value2 value3 ... # 左侧插入列表值(integer) 3$ 127.0.0.1:6379&gt; rpush list-name value4 value5 value6... # 右侧插入列表值(integer) 6$ 127.0.0.1:6379&gt;  lindex list-name 1 # 获取第1个的值&quot;value2&quot;$ 127.0.0.1:6379&gt;  lrange list-name 1 2 # 获取从第1位置到2位置的列表值1) &quot;value2&quot;2) &quot;value1&quot;$ 127.0.0.1:6379&gt;  lpop list-name # 弹出最左边值&quot;value3&quot;$ 127.0.0.1:6379&gt; rpop list-name # 弹出最右边值&quot;value6&quot;</code></pre><p>集合set：无序，不重复的列表</p><pre><code>$ 127.0.0.1:6379&gt;  sadd set-name value1 value2 value3 # 设置无序列表值(integer) 3$ 127.0.0.1:6379&gt; smembers set-name  # 查看所有值1) &quot;value3&quot;2) &quot;value2&quot;3) &quot;value1&quot;$ 127.0.0.1:6379&gt; srem set-name value1 # 删除值(integer) 1$ 127.0.0.1:6379&gt; sismember set-name value2 # 查看是否在无序列表内(integer) 1</code></pre><p>散列值hash：相当于自定义键的数组</p><pre><code>$ 127.0.0.1:6379&gt; HSET hash-name key1 value1 #设置键值对(integer) 1$ 127.0.0.1:6379&gt; HGET hash-name key1 # 获取指定键的值&quot;value1&quot;$ 127.0.0.1:6379&gt; HSET hash-name key1 value2 # 更新键的值(integer) 0$ 127.0.0.1:6379&gt; HGET hash-name key1 &quot;value2&quot;$ 127.0.0.1:6379&gt; HSET hash-name key2 value2(integer) 1$ 127.0.0.1:6379&gt; HGETALL hash-name # 查找所有键值对1) &quot;key1&quot;2) &quot;value2&quot;3) &quot;key2&quot;4) &quot;value2&quot;$ 127.0.0.1:6379&gt; HDEL hash-name key1 # 删除hash键值对(integer) 1</code></pre><p>有序集合zset：成员+分值，分值必须是浮点数，通过浮点数进行排序</p><pre><code>$ 127.0.0.1:6379&gt; zadd zset-name 100 member1 # 添加键值对(integer) 1$ 127.0.0.1:6379&gt; zadd zset-name 202 member2(integer) 1$ 127.0.0.1:6379&gt; zadd zset-name 803 member3(integer) 1$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 # 获取多个元素1) &quot;member1&quot;2) &quot;member2&quot;3) &quot;member3&quot;$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 withscores # 获取多个元素1) &quot;member1&quot;2) &quot;100&quot;3) &quot;member2&quot;4) &quot;202&quot;5) &quot;member3&quot;6) &quot;803&quot;$ 127.0.0.1:6379&gt; ZRANGEBYSCORE zset-name 0 300 withscores # 按score获取多个元素1) &quot;member1&quot;2) &quot;100&quot;3) &quot;member2&quot;4) &quot;202&quot;$ 127.0.0.1:6379&gt; ZREM zset-name member1 # 移除一个元素(integer) 1</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python爬虫scrapy框架入门基础</title>
      <link href="/2018/01/10/python%E7%88%AC%E8%99%ABscrapy%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2018/01/10/python%E7%88%AC%E8%99%ABscrapy%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p><h3 id="Scrapy主要包括了以下组件："><a href="#Scrapy主要包括了以下组件：" class="headerlink" title="Scrapy主要包括了以下组件："></a>Scrapy主要包括了以下组件：</h3><ol><li>引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)</li><li>调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址</li><li>下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)</li><li>爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</li><li>项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</li><li>下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。</li><li>爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。</li><li>调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。</li></ol><h3 id="Scrapy运行流程大概如下："><a href="#Scrapy运行流程大概如下：" class="headerlink" title="Scrapy运行流程大概如下："></a>Scrapy运行流程大概如下：</h3><p>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取 引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response) 然后，爬虫解析Response 若是解析出实体（Item）,则交给实体管道进行进一步的处理。 若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</p><h3 id="备忘"><a href="#备忘" class="headerlink" title="备忘"></a>备忘</h3><h4 id="使用Selector提取数据"><a href="#使用Selector提取数据" class="headerlink" title="使用Selector提取数据"></a>使用Selector提取数据</h4><h4 id="xpath语法和基本函数"><a href="#xpath语法和基本函数" class="headerlink" title="xpath语法和基本函数"></a>xpath语法和基本函数</h4><pre><code>/...ELEMENT//ELEMENT*text@ALTER@*position()last()string()</code></pre><h4 id="css选择器"><a href="#css选择器" class="headerlink" title="css选择器"></a>css选择器</h4><pre><code>*EE1&gt;E2E1+E2.CLASS#ID[ATTR][ATTR=VALUE]E:nth-child(n)E:first-child</code></pre><h4 id="使用Item和Field封装数据"><a href="#使用Item和Field封装数据" class="headerlink" title="使用Item和Field封装数据"></a>使用Item和Field封装数据</h4><p>Field(serializer=lambda)设置存储数据</p><h4 id="使用Item-Pipeline处理数据"><a href="#使用Item-Pipeline处理数据" class="headerlink" title="使用Item Pipeline处理数据"></a>使用Item Pipeline处理数据</h4><p>修改数据,过滤重复数据,将数据写入到数据库等</p><h4 id="LinkExtractor提取链接"><a href="#LinkExtractor提取链接" class="headerlink" title="LinkExtractor提取链接"></a>LinkExtractor提取链接</h4><pre><code>LinkExtractor参数allow 允许链接deny 拒绝链接allow_domains 允许域名deny_domains 拒绝域名restrict_xpaths 允许xpath链接restrict_css 允许css选择器链接</code></pre><h4 id="Exporter导出数据"><a href="#Exporter导出数据" class="headerlink" title="Exporter导出数据"></a>Exporter导出数据</h4><p>默认包含以下</p><pre><code>JSON, JSON LINES, CSV, XML, PICKLE, MARSHAL</code></pre><p>可配置导出格式和存放文件地址, 可自定义导出格式,例如xls</p><h4 id="下载文件和图片"><a href="#下载文件和图片" class="headerlink" title="下载文件和图片"></a>下载文件和图片</h4><p>FIlesPipeline</p><pre><code>setting.pyITEM_PIPELINES = {&apos;scrapy.pipelines.files.FilesPipeline&apos;: 1}FILES_STORE = &apos;/home/hanchang/download&apos;</code></pre><p>ImagesPipeline</p><h4 id="模拟登录"><a href="#模拟登录" class="headerlink" title="模拟登录"></a>模拟登录</h4><p>使用FromRequest ORC识别验证码:pillow, pytesseract 付费网络平台识别 人工识别:爬取登录页面的验证码图片,调用Image.show方法,肉眼识别并输入到内置的input函数中 Cookie登录: 获取浏览器的cookie值(browsercookie包), 利用BrowserCookiesMiddleware将获取的cookie值添加到CookieJar中</p><h4 id="动态页面抓取"><a href="#动态页面抓取" class="headerlink" title="动态页面抓取"></a>动态页面抓取</h4><p>Splash是Scrapy官方推荐的javascript渲染引擎, Webkit无界面浏览器</p><pre><code># 安装sudo apt-get install dockersudo docker pull scrapinghub/splashsudo docker run -p 8050:8050 -p 8051:8051 scrapinghub/splash</code></pre><p>splash常见服务端点 <a href="http://localhost:8050/render.html" target="_blank" rel="noopener">http://localhost:8050/render.html</a> GET/POST 返回html 参数: url, timeout, proxy, wait, images, js_source <a href="http://localhost:8050/excute" target="_blank" rel="noopener">http://localhost:8050/excute</a> 传递模拟的动作给splash,例如等待页面渲染，执行代码，等等</p><h5 id="scrapy使用splash"><a href="#scrapy使用splash" class="headerlink" title="scrapy使用splash"></a>scrapy使用splash</h5><pre><code>安装pip install scrapy-splashsetting.py# splash服务器地址SPLASH_URL = &apos;http://localhost:8050&apos;# 开启splash的两个下载中间件并调整HttpCompressionMiddleware的次序DOWNLOADER_MIDDLEWARES = {    &apos;scrapy_splash.SplashCookiesMiddleware&apos;: 723,        &apos;scrapy_splash.SplashMiddleware&apos;: 725,        &apos;scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware&apos;: 810,}# 过滤去重函数DUPEFILTER_CLASS = &apos;scrapy_splash.SplashAwareDupeFilter&apos;,# 用户支持cahce_argsSPIDER_MIDDLEWARES = {  &apos;scrapy_splash.SplashDeduplicateArgsMiddleware&apos;: 100,}</code></pre><h4 id="分布式爬取"><a href="#分布式爬取" class="headerlink" title="分布式爬取"></a>分布式爬取</h4><p>使用scrapy-redis</p><pre><code># 安装pip install scrapypip install scrapy-redis# 在配置文件setting.py中添加scrapy-redis相关信息# redis服务器REDIS_URL = &apos;redis://127.0.0.1:6379&apos;# 使用scrapy_redis调度器替代原生调度器SCHEDULER = &apos;scrapy_redis.scheduler.Scheduler&apos;# 使用scrapy_redis的RFPDupeFilter作为去重过滤器DUPEFILTER_CLASS = &apos;scrapy_redis.dupefilter.RFPDupeFilter&apos;# 将爬取的数据存储到redis中ITEM_PIPELINES = {    &apos;scrapy_redis.pipelines.RedisPipeline&apos;: 300,}# 爬虫停止后,保留/清除Reids中的请求队列以及去重集合SCHEDULER_PERSIST = False# 修改爬虫spider.pyfrom scrapy_redis.spiders import RedisSpiderclass BookSpider(RedisSpider):    # 注释start_urls    # start_urls = []# 手动添加start_urlsredis-cli -h 127.0.0.1lpush books:start_urls &apos;http://www.books.com/&apos;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>最新在linux/ubuntu中安装qq的办法</title>
      <link href="/2017/11/22/%E6%9C%80%E6%96%B0%E5%9C%A8linux-ubuntu%E4%B8%AD%E5%AE%89%E8%A3%85qq%E7%9A%84%E5%8A%9E%E6%B3%95/"/>
      <url>/2017/11/22/%E6%9C%80%E6%96%B0%E5%9C%A8linux-ubuntu%E4%B8%AD%E5%AE%89%E8%A3%85qq%E7%9A%84%E5%8A%9E%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>通过docker镜像文件的方式安装qq 1, 首先需要在主机上安装docker 2, 下载镜像文件 <a href="https://hub.docker.com/r/bestwu/qq/" target="_blank" rel="noopener">https://hub.docker.com/r/bestwu/qq/</a></p><pre><code>sudo docker pull bestwu/qq # 速度慢可以换镜像源</code></pre><p>3, 编辑启动脚本</p><pre><code>vim qq.shsudo docker run -d --name qq --device /dev/snd --net=host \-v /tmp/.X11-unix:/tmp/.X11-unix \-v /home/YOURUSERNAME/TencentFiles:/TencentFiles \ # 此处数据卷的目录填写自己的目录-e DISPLAY=unix$DISPLAY \-e XMODIFIERS=@im=fcitx \-e QT_IM_MODULE=fcitx \-e GTK_IM_MODULE=fcitx \-e AUDIO_GID=63 \-e GID=1000 \-e UID=1000 \bestwu/qq:latest # 此处版本自行选择，作者提供了im (QQ) light,latest (QQLight) office (TIM)三个版本</code></pre><p>4, 启动脚本</p><pre><code>./qq.sh</code></pre><p>5, 感谢作者提供的镜像，本镜像基于深度操作系统.</p>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu16.04安装及使用docker(一)</title>
      <link href="/2017/11/20/ubuntu16.04%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8docker(%E4%B8%80)/"/>
      <url>/2017/11/20/ubuntu16.04%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8docker(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="删除旧版本"><a href="#删除旧版本" class="headerlink" title="删除旧版本"></a>删除旧版本</h3><pre><code>sudo apt-get remove docker docker-engine docker.io</code></pre><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>$ sudo apt-get update# 安装依赖$ sudo apt-get install  apt-transport-https ca-certificates curl software-properties-common# 添加官方key$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -# 查找key$ sudo apt-key fingerprint 0EBFCD88pub   4096R/0EBFCD88 2017-02-22      Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88uid                  Docker Release (CE deb) &lt;docker@docker.com&gt;sub   4096R/F273FCD8 2017-02-22# 获取资源sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;# 查找合适的版本$ apt-cache madison docker-cedocker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages# 安装$ sudo apt-get install docker-ce=&lt;VERSION&gt;# 打印安装结果$ sudo docker versionClient: Version:      17.09.0-ce API version:  1.32 Go version:   go1.8.3 Git commit:   afdb6d4 Built:        Tue Sep 26 22:42:18 2017 OS/Arch:      linux/amd64Server: Version:      17.09.0-ce API version:  1.32 (minimum version 1.12) Go version:   go1.8.3 Git commit:   afdb6d4 Built:        Tue Sep 26 22:40:56 2017 OS/Arch:      linux/amd64 Experimental: false</code></pre><h3 id="将用户加入docker用户组，这样不需要输入sudo"><a href="#将用户加入docker用户组，这样不需要输入sudo" class="headerlink" title="将用户加入docker用户组，这样不需要输入sudo"></a>将用户加入docker用户组，这样不需要输入sudo</h3><pre><code>1. sudo cat /etc/group | grep docker 2. 如果不存在docker组，可以添加sudo groupadd docker 3. 添加当前用户到docker组，sudo usermod -aG  docker $USER 4. 重启docker服务,sudo systemctl restart docker 5. 如果权限不够，sudo chmod a+rw /var/run/docker.sock　6. sudo chown -R $USER ~/.docker</code></pre><h3 id="启动测试"><a href="#启动测试" class="headerlink" title="启动测试"></a>启动测试</h3><pre><code>$ sudo  docker run hello-worldUnable to find image &apos;hello-world:latest&apos; locallylatest: Pulling from library/hello-world9a0669468bf7: Pull completeDigest: sha256:0e06ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fcStatus: Downloaded newer image for hello-world:latestHello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub. 3. The Docker daemon created a new container from that image which runs the    executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it    to your terminal.To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bashShare images, automate workflows, and more with a free Docker ID: https://cloud.docker.com/For more examples and ideas, visit: https://docs.docker.com/engine/userguide/</code></pre><h3 id="更换镜像源"><a href="#更换镜像源" class="headerlink" title="更换镜像源"></a>更换镜像源</h3><pre><code># 可以修改 /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值,没有就创建一个{  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]}</code></pre><h3 id="安装ctop查看容器状态"><a href="#安装ctop查看容器状态" class="headerlink" title="安装ctop查看容器状态"></a>安装ctop查看容器状态</h3><pre><code># https://github.com/bcicen/ctop$ sudo wget https://github.com/bcicen/ctop/releases/download/v0.6.1/ctop-0.6.1-linux-amd64 -O /usr/local/bin/ctop$ sudo chmod +x /usr/local/bin/ctop</code></pre><h3 id="第一个实例"><a href="#第一个实例" class="headerlink" title="第一个实例"></a>第一个实例</h3><pre><code># 第一次使用会下载debian的镜像文件$ sudo docker run debian echo &apos;hello world&apos;&gt; Unable to find image &apos;debian&apos; locally&gt; ......# -i -t 表示进行交互会话$ sudo docker run -i -t debian /user/bashroot@622ac5689680:/#  echo &apos;hello world&apos;&gt; hello worldroot@622ac5689680:/# exit&gt; exit# 基本命令$ sudo docker run -h container -i -t debian /bin/bash #-h表示主机名称$ sudo docker ps  # 查看当前运行的主机$ sudo docker ps -a # 查看全部的主机$sudo docker events  # 查看守护进程$ sudo docker inspect HOST_NAME 　# 查看HOST_NAME的信息$ sudo docker port HOST_NAME # 查看端口映射信息$ sudo docker diff HOST_NAME　# 查看更改的信息$ sudo docker logs HOST_NAME   # 打印log信息$ sudo docker rm HOST_NAME  # 删除$ sudo docker pull redis  # 拉取镜像$ sudo docker create redis # 创建容器$ sudo docker start zen_brown # 开启容器（kitematic是绿色波浪线）$ sudo docker stop zen_brown # 停止容器（kitematic是灰色直线）$ sudo docker pause zen_brown  # 暂停容器kitematic是灰色波浪线）$ sudo docker commit zen_brown # 将容器变成镜像$ sudo docker run redis /bin/bash$ sudo docker attach zen_brown # 查看容器内进程$ sudo docker cp # 在容器和主机之间复制内容$ sudo docker exec # 在容器中运行命令$ sudo docker kill # 容器立即退出</code></pre><h3 id="创建dockerfile镜像"><a href="#创建dockerfile镜像" class="headerlink" title="创建dockerfile镜像"></a>创建dockerfile镜像</h3><pre><code># 创建项目$ mkdir cowsay$ cd cowsay$ vim Dockerfile~ FROM debian:wheezy~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune~ :wq# 创建$ sudo docker build -t test/cowsay-dockerfile . &gt; Sending build content to Docker .....&gt; ....# 运行$ sudo docker run test/cowsay-dockerfile /usr/games/cowsay &apos;Moo&apos;# 使用entrypoint指令$ vim Dockerfile~ FROM debian:wheezy~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune~ ENTRYPOINTER [&quot;/usr/games/cowsay&quot;]~ :wq # 创建$ sudo docker build -t test/cowsay-dockerfile . &gt; Sending build content to Docker .....&gt; ....# 运行$ sudo docker run test/cowsay-dockerfile  &apos;Moo&apos;# 使用脚本解决entrypoint$ vim entrypoint.sh~ #! /bin/bash~ if [ $# -eq 0 ]; then~      /usr/games/fortune | /usr/games/cowsay~  else~     /usr/games/cowsay &quot;$@&quot;~   fi~ :wq$ chmod +x entrypoint.sh$ vim Dockerfile~ FROM debian:wheezy~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune~ COPY entrypoint.sh /~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]~ :wq # 创建$ sudo docker build -t test/cowsay-dockerfile . &gt; Sending build content to Docker .....&gt; ....# 运行$ sudo docker run test/cowsay-dockerfile &apos;Moo&apos;</code></pre><h3 id="使用在线仓库"><a href="#使用在线仓库" class="headerlink" title="使用在线仓库"></a>使用在线仓库</h3><p>在线注册地址：　<a href="https://cloud.docker.com" target="_blank" rel="noopener">https://cloud.docker.com</a></p><pre><code># 登陆$ sudo docker login$ username:$ password:# 填写作者信息$ vim Dockerfile~ FROM debian:wheezy~ MAINTAINER username &lt;username@mail.com&gt;~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune~ COPY entrypoint.sh /~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]~ :wq # 创建$ sudo docker build -t username/cowsay-dockerfile . &gt; Sending build content to Docker .....&gt; ....# 运行$ sudo docker run username/cowsay-dockerfile  &apos;Moo&apos;# 上传$ sudo docker push </code></pre><h3 id="容器连接"><a href="#容器连接" class="headerlink" title="容器连接"></a>容器连接</h3><pre><code>$ sudo docker run --name myredis -d redis # -d表示后台运行~ a1696406326aaaa6c28931e886b8dd664d191b083de4aed464d584b4720d57b1$ docker run --rm -it --link myredis:redis redis /bin/bash&gt; root@9c914447f5e1:/data# redis-cli -h redis -p 6379&gt; redis:6379&gt; ping&gt; PONG&gt; redis:6379&gt; set &quot;abc&quot; 123&gt; OK&gt; redis:6379&gt; get &quot;abc&quot;&gt; &quot;123&quot;&gt; redis:6379&gt; exit&gt; root@9c914447f5e1:/data# exit&gt; exit</code></pre><h3 id="容器的备份"><a href="#容器的备份" class="headerlink" title="容器的备份"></a>容器的备份</h3><pre><code># 查看所有的容器$ docker ps -aCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMESa1696406326a        redis               &quot;docker-entrypoint...&quot;   13 minutes ago      Up 13 minutes       6379/tcp            myredis# 备份指定的id$ docker commit -p a1696406326a redis-backup# 查看镜像$ docker imagesREPOSITORY                   TAG                 IMAGE ID            CREATED             SIZEredis-backup                 latest              fb9d896b3a39        11 seconds ago      107MB# 上传镜像(docker login &amp;&amp; docker push)# 或者打包$ docker save -o ./redis-backup.tar redis-backup# 恢复容器$ docker pull ****# 或者使用包$ docker load -i ./redis-backup.tar</code></pre><h3 id="让docker容器连接互联网"><a href="#让docker容器连接互联网" class="headerlink" title="让docker容器连接互联网"></a>让docker容器连接互联网</h3><pre><code># -p 8000:80 表示将主机的8000端口转发至容器的80端口$ docker run -d -p 8000:80 nginx # 容器互联$ docker run -d --name myredis redis$ docker run --link myredis:redis debian env  # --link 目标容器:目标容器在主容器内的简称~ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin~ HOSTNAME=69df45e6f92d~ REDIS_PORT=tcp://172.17.0.2:6379~ REDIS_PORT_6379_TCP=tcp://172.17.0.2:6379~ REDIS_PORT_6379_TCP_ADDR=172.17.0.2~ REDIS_PORT_6379_TCP_PORT=6379~ REDIS_PORT_6379_TCP_PROTO=tcp~ REDIS_NAME=/stupefied_chandrasekhar/redis~ REDIS_ENV_GOSU_VERSION=1.10~ REDIS_ENV_REDIS_VERSION=4.0.2~ REDIS_ENV_REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-4.0.2.tar.gz~ REDIS_ENV_REDIS_DOWNLOAD_SHA=b1a0915dbc91b979d06df1977fe594c3fa9b189f1f3d38743a2948c9f7634813~ HOME=/root</code></pre><h3 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h3><pre><code>#  -v指定数据卷$ docker run -it --name container-test -h container -v /ddata debian /bin/bash# 查看数据卷在本机的位置$ docker inspect -f { {.Mounts}} container-test  [{volume 4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9 /var/lib/docker/volumes/4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9/_data /ddata local  true }]# 可以在本机中添加文件并在容器中查看修改结果### 在dockerfile中设置数据卷FROM debian:wheezyRUN useradd foo# VOLUME /ddata # 此处添加无效果，因为touch chown是在一个临时容器内的数据卷中执行的RUN touch /data/xRUN CHOWN -R foo:foo /data# VOLUME /ddata # 此处添加可以# docker run -v 指定到特定数据卷$ docker run -v /home/adrian/data:./data debian ls /data# 数据容器$ docker run --name dbdata postgres echo &apos;data-only container for postage&apos; # 创建一个postgreSQL的容器# 使用--volumes-from参数，使其他容器也可以使用这个数据卷$ docker run -d --volumes-from dbdata --name db1 postgres</code></pre><h3 id="如何在开发中使用docker-以python-flask为例"><a href="#如何在开发中使用docker-以python-flask为例" class="headerlink" title="如何在开发中使用docker,以python flask为例"></a>如何在开发中使用docker,以python flask为例</h3><pre><code># 创建项目$ tree identidock.├── app│   └── identidock.py└── Dockerfile# 编辑flask文件$ vim app/identidock.pyfrom flask import Flaskapp = Flask(__name__)@app.route(&apos;/&apos;)def hello_world():    return &apos;hello world&apos;if __name__ == &apos;__main__&apos;:    app.run(debug=True, host=&apos;0.0.0.0&apos;)# 编辑dockerfile文件$ vim DockerfileFROM python:3.4RUN pip install Flask==0.10.1WORKDIR /appCOPY app /appCMD [&quot;python&quot;, &quot;identidock.py&quot;]# 创建镜像并使用容器$ docker build -t identidock ....$ docker run -d -p 5000:5000 identidock # 后台运行并将主机的5000端口转发到docker$ curl localhost:5000~ hello world# 将开发的代码目录挂载到docker上，这样就不必每次更改代码都需要重新bulid一次．$ docker run -d -p 5000:5000 -v &quot;$PWD&quot;/app:/app identidock  # -v &quot;$PWD&quot;/app:/app把位于主机的./app目录挂载到容器内，覆盖容器/app目录下的内容# 可以修改app目录下的文件查看改动情况# 以wsgi服务器运行flask并且修改设置用户$ vim DockerfileFROM python:3.4RUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgi # 创建用户组和用户RUN pip install Flask==0.10.1 uWSGI==2.0.8WORKDIR /appCOPY app /appEXPOSE 9090 9191  # 声明主机和其他容器可以访问的端口号USER uwsgi #使用用户运行以下代码，默认docker是以root用户运行的，不安全CMD [&quot;uwsgi&quot;, &quot;--http&quot;, &quot;0.0.0.0:9090&quot;, &quot;--wsgi-file&quot;, &quot;/app/identidock.py&quot;, &quot;--callable&quot;, &quot;app&quot;, &quot;--stats&quot;, &quot;0.0.0.0:9191&quot;]</code></pre><h3 id="使用配置文件配置开发环境和生产环境"><a href="#使用配置文件配置开发环境和生产环境" class="headerlink" title="使用配置文件配置开发环境和生产环境"></a>使用配置文件配置开发环境和生产环境</h3><pre><code># 创建脚本文件cmd.sh$ tree.├── app│   └── identidock.py├── cmd.sh└── Dockerfile$ vim cmd.sh#! /bin/bashset -eif [ &quot;$ENV&quot; = &apos;DEV&apos; ]; then  echo &quot;Running Development Server&quot;  exec python &quot;identidock.py&quot;else  echo &quot;Running Production Server&quot;  exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/identidock.py --callable app --stats 0.0.0.0:9191fi$ chmod +x cmd.sh$ vim DockerfileFROM python:3.4RUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgiRUN pip install Flask==0.10.1 uWSGI==2.0.8WORKDIR /appCOPY app /appCOPY cmd.sh /EXPOSE 9090 9191USER uwsgiCMD [&quot;/cmd.sh&quot;]$ docker build -t identidock .$ docker run -e &quot;ENV=DEV&quot; -p 5000:5000 identidock # 开发环境$ docker run -d -P identidock</code></pre><h3 id="使用compose自动化安装创建运行docker环境"><a href="#使用compose自动化安装创建运行docker环境" class="headerlink" title="使用compose自动化安装创建运行docker环境"></a>使用compose自动化安装创建运行docker环境</h3><pre><code># 安装环境# https://docs.docker.com/compose/install/$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose$ sudo chmod +x /usr/local/bin/docker-compose$ docker-compose --version# 配置文件tree.├── app│   └── identidock.py├── cmd.sh├── docker-compose.yml└── Dockerfile# 编辑docker-compose文件$ vim docker-compose.ymlidentidock:  build: .  ports:    - &quot;5000:5000&quot;  environment:    ENV: DEV  volumes:    - ./app:/app~                    # 使用方法$ docker-compose up # 如果有镜像则直接运行，如果没有镜像则先build$ docker-compose build # 重新构建镜像$ docker-compose ps 获取由compose管理的容器状态$ docker-compose logs 输出日志$ docker-stop 停止容器，但不会删除他们</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>linux命令记录</title>
      <link href="/2017/11/08/linux%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/"/>
      <url>/2017/11/08/linux%E5%91%BD%E4%BB%A4%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h3 id="查看文件夹大小"><a href="#查看文件夹大小" class="headerlink" title="查看文件夹大小"></a>查看文件夹大小</h3><pre><code>du -h your_path --max-depth=1</code></pre><h4 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h4><blockquote><p>-a或-all 为每个指定文件显示磁盘使用情况，或者为目录中每个文件显示各自磁盘使用情况。 -b或-bytes 显示目录或文件大小时，以byte为单位。 -c或–total 除了显示目录或文件的大小外，同时也显示所有目录或文件的总和。 -D或–dereference-args 显示指定符号连接的源文件大小。 -h或–human-readable 以K，M，G为单位，提高信息的可读性。 -H或–si 与-h参数相同，但是K，M，G是以1000为换算单位,而不是以1024为换算单位。 -k或–kilobytes 以1024 bytes为单位。 -l或–count-links 重复计算硬件连接的文件。 -L&lt;符号连接&gt;或–dereference&lt;符号连接&gt; 显示选项中所指定符号连接的源文件大小。 -m或–megabytes 以1MB为单位。 -s或–summarize 仅显示总计，即当前目录的大小。 -S或–separate-dirs 显示每个目录的大小时，并不含其子目录的大小。 -x或–one-file-xystem 以一开始处理时的文件系统为准，若遇上其它不同的文件系统目录则略过。 -X&lt;文件&gt;或–exclude-from=&lt;文件&gt; 在&lt;文件&gt;指定目录或文件。 –exclude=&lt;目录或文件&gt; 略过指定的目录或文件。 –max-depth=&lt;目录层数&gt; 超过指定层数的目录后，予以忽略。 –help 显示帮助。 –version 显示版本信息</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu本地配置SSL</title>
      <link href="/2017/11/07/ubuntu%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AESSL/"/>
      <url>/2017/11/07/ubuntu%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AESSL/</url>
      
        <content type="html"><![CDATA[<pre><code># 安装相关模块sudo a2enmod ssl   //启用ssl模块sudo apt-get install openssl  //安装openssl# 创建证书openssl genrsa -des3 -out server.key 1024  //创建CA签名(不使用密码去除-des3选项)openssl req -new -key server.key -out server.csr  //创建CSR(Certificate Signing Request)openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt  //自己签发证书sudo cp server.crt /etc/ssl/certssudo cp server.key /etc/ssl/private# 修改虚拟主机信息在&lt;VirtualHost *:80&gt;段中，DocumentRoot一行的下方加入内容：SSLEngine OnSSLOptions +StrictRequireSSLCertificateFile /etc/ssl/certs/server.crtSSLCertificateKeyFile /etc/ssl/private/server.key端口修改为：443，即&lt;VirtualHost *:443&gt;(ssl的端口)# 重启apache2sudo /etc/init.d/apache2 force-reloadsudo /etc/init.d/apache2 restart</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu配置Gitlab服务</title>
      <link href="/2017/06/19/ubuntu%E9%85%8D%E7%BD%AEGitlab%E6%9C%8D%E5%8A%A1/"/>
      <url>/2017/06/19/ubuntu%E9%85%8D%E7%BD%AEGitlab%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装相关服务 postfix为邮件服务</span></span><br><span class="line">sudo apt-get install curl openssh-server ca-certificates postfix</span><br><span class="line"><span class="comment"># 安装gitlab服务包</span></span><br><span class="line">curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash</span><br><span class="line">sudo apt-get install gitlab-ce</span><br></pre></td></tr></table></figure><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置服务</span></span><br><span class="line">sudo vim /etc/gitlab/gitlab.rb</span><br><span class="line"></span><br><span class="line"><span class="comment">## GitLab URL</span></span><br><span class="line"><span class="comment">##! URL on which GitLab will be reachable.</span></span><br><span class="line"><span class="comment">##! For more details on configuring external_url see:</span></span><br><span class="line"><span class="comment">##! https://docs.gitlab.com/omnibus/settings/configuration.html#configuring-the-external-url-for-gitlab</span></span><br><span class="line">external_url <span class="string">'http:/192.168.0.19:1500'</span>    <span class="comment"># 地址</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"><span class="comment"># 邮件基本设置</span></span><br><span class="line"><span class="comment">### Email Settings</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_enabled'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">'admin@uscnk.com'</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_display_name'</span>] = <span class="string">'Gitlab'</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_reply_to'</span>] = <span class="string">'admin@uscnk.com'</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_subject_suffix'</span>] = <span class="string">'Gitlab'</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"><span class="comment">### GitLab email server settings</span></span><br><span class="line"><span class="comment">###! Docs: https://docs.gitlab.com/omnibus/settings/smtp.html</span></span><br><span class="line"><span class="comment">###! **Use smtp instead of sendmail/postfix.**</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_enable'] = true</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_address'] = "smtp.server"</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_port'] = 465</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_user_name'] = "smtp user"</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_password'] = "smtp password"</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_domain'] = "example.com"</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_authentication'] = "login"</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_enable_starttls_auto'] = true</span></span><br><span class="line"><span class="comment"># gitlab_rails['smtp_tls'] = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 邮件服务地址</span></span><br><span class="line"><span class="comment"># QQ exmail (腾讯企业邮箱)</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_enable'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_address'</span>] = <span class="string">"smtp.exmail.qq.com"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_port'</span>] = 465</span><br><span class="line">gitlab_rails[<span class="string">'smtp_user_name'</span>] = <span class="string">"admin@uscnk.com"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_password'</span>] = <span class="string">"xxxxxxxxx"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_authentication'</span>] = <span class="string">"login"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_enable_starttls_auto'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_tls'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">'admin@uscnk.com'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># nginx基本设置</span></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"><span class="comment">## GitLab Nginx</span></span><br><span class="line"><span class="comment">##! Docs: https://docs.gitlab.com/omnibus/settings/nginx.html</span></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line">nginx[<span class="string">'listen_addresses'</span>] = [<span class="string">'192.168.0.19'</span>]</span><br><span class="line">nginx[<span class="string">'losten_port'</span>] = 1500</span><br></pre></td></tr></table></figure><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line"><span class="comment"># 重启邮件服务</span></span><br><span class="line">sudo /etc/init.d/postfix restart</span><br><span class="line"><span class="comment"># 访问</span></span><br><span class="line">http://192.168.0.19:1500</span><br><span class="line">Username: root</span><br><span class="line">Password: 5iveL!fe</span><br></pre></td></tr></table></figure><h4 id="github与gitlab共存"><a href="#github与gitlab共存" class="headerlink" title="github与gitlab共存"></a>github与gitlab共存</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># github账户邮箱， 将id_rsa改名成id_rsa_github</span></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">"xxxxx@gmail.com"</span></span><br><span class="line"><span class="comment"># gitlab公司邮箱， 将id_rsa改名成id_rsa_gitlab</span></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">"xxxxxx@work.com"</span></span><br><span class="line"><span class="comment"># 添加私钥</span></span><br><span class="line">ssh-add ~/.ssh/id_rsa_github</span><br><span class="line">ssh-add ~/.ssh/id_rsa_gitlab</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#在 ~/.ssh 目录下新建一个config文件</span></span><br><span class="line">touch config</span><br><span class="line">chmod 755 conifg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 并添加以下内容</span></span><br><span class="line"><span class="comment"># gitlab</span></span><br><span class="line">Host github.com</span><br><span class="line">    HostName github.com</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_github</span><br><span class="line"><span class="comment"># github</span></span><br><span class="line">Host gitlib.com</span><br><span class="line">    HostName gitlib.com</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_gitlab</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将id_rsa_github.pab内容添加到github中</span></span><br><span class="line"><span class="comment"># 测试结果</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="comment"># 将id_rsa_gitlab.pab内容添加到gitlab中</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ~/mytest</span><br><span class="line"><span class="comment"># 在github中测试</span></span><br><span class="line">git remote add github https://github.com/zhcshine/mytest.git</span><br><span class="line">git push -u github master</span><br><span class="line"><span class="comment"># 在gitlab中测试</span></span><br><span class="line">git remote add gitlab http://192.168.0.19:1500/zhcshine/mytest.git</span><br><span class="line">git push -u gitlab master</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7创建nagios监控集群服务</title>
      <link href="/2017/04/20/centos7%E5%88%9B%E5%BB%BAnagios%E7%9B%91%E6%8E%A7%E9%9B%86%E7%BE%A4%E6%9C%8D%E5%8A%A1/"/>
      <url>/2017/04/20/centos7%E5%88%9B%E5%BB%BAnagios%E7%9B%91%E6%8E%A7%E9%9B%86%E7%BE%A4%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="安装服务器端192-168-0-206"><a href="#安装服务器端192-168-0-206" class="headerlink" title="安装服务器端192.168.0.206"></a>安装服务器端192.168.0.206</h3><p>1,安装lamp环境 <a href="http://www.zhuohc.com/articles/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/">参考</a> 2, 配置nagios服务</p><pre><code># 创建nagiso用户$ sudo useradd nagios# 创建apache用户，yum安装httpd服务会自动创建$ sudo useradd apache -M -s /sbin/nologinuseradd：用户“apache”已存在# 创建nagcmd用户组$ sudo groupadd nagcmd# 将usermod加入nagcmd用户组sudo usermod -a -G nagcmd nagios# 将apache用户加入nagcmd用户组$ sudo usermod -a -G nagcmd apache# 查看nagios用户所属的组$ id -n -G nagiosnagios nagcmd# 查看apace用户所属的组$ id -n -G apacheapache nagcmd# 安装nagiso服务$sudo yum install nagios$sudo yum install nagios-plugins-all# 安装nrpe（服务器端和客户端都需要安装）$sudo yum install nrpe# 启动和开机启动$sudo systemctl start nagios$sudo systemctl enable nagios$sudo systemctl start nrpe$sudo systemctl enable nrpe</code></pre><p>3,配置web</p><pre><code># 取消认证$ sudo vim /etc/nagios/cgi.cfguse_authentication=0 # 此处将1改为0# 查看配置文件$ls /etc/httpd/conf.dautoindex.conf  nagios.conf  php.conf  README  userdir.conf  welcome.conf  xcache.conf# 其中nagiso.conf就是nagios的web配置文件# 访问http://192.168.0.206/nagios，其中登陆密码在/etc/nagios/passwd文件中，具体文件位置可以在/etc/httpd/conf.d/nagios.conf中查看</code></pre><h3 id="安装客户端192-168-0-208"><a href="#安装客户端192-168-0-208" class="headerlink" title="安装客户端192.168.0.208"></a>安装客户端192.168.0.208</h3><pre><code># 安装mysql，参考上方链接，配合生成check_mysql插件# 安装nrpe（服务器端和客户端都需要安装）$ sudo yum -y install epel-release$ sudo yum install nrpe$ sudo yum install nagios-plugins-all# 配置nagios客户端$ sudo vim /etc/nagios/nrpe.cfgallowed_hosts=127.0.0.1,192.168.0.206 # 监控当前客户端的nagios服务器地址# 启动服务$ sudo systemctl restart nrpe$ sudo systemctl enable nrpe# 检查启动结果$ sudo netstat -lntup | grep nrpetcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      2540/nrpe           tcp6       0      0 :::5666                 :::*                    LISTEN      2540/nrpe$ sudo ps -ef | grep nrpe | grep -v grepnrpe      2540     1  0 11:59 ?        00:00:00 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -d</code></pre><h3 id="配置服务器端192-168-0-206"><a href="#配置服务器端192-168-0-206" class="headerlink" title="配置服务器端192.168.0.206"></a>配置服务器端192.168.0.206</h3><pre><code>$ tree /etc/nagios.├── cgi.cfg  ├── conf.d  # 添加新的监视客户端信息│   └── web_one.cfg├── nagios.cfg  # 配置服务器端nagios├── nrpe.cfg # 配置服务器端nrpe├── objects│   ├── commands.cfg│   ├── contacts.cfg│   ├── localhost.cfg│   ├── printer.cfg│   ├── switch.cfg│   ├── templates.cfg│   ├── timeperiods.cfg│   └── windows.cfg├── passwd└── private    └── resource.cfg$ cp /etc/nagios/objects/localhost.cfg  /etc/nagios/conf.d/web_one.cfg$ vim /etc/nagios/conf.d/web_one.cfg # 将localhost 改成web_onedefine host{        use                     linux-server          host_name         web_one        alias                   web_one        address              192.168.0.208}define service{        use                             local-service         host_name                 web_one        service_description    PING        check_command        check_ping!100.0,20%!500.0,60%}</code></pre><h3 id="查看结果"><a href="#查看结果" class="headerlink" title="查看结果"></a>查看结果</h3><p><img src="http://www.zhuohc.com/wp-content/uploads/2017/04/nagios.png" alt="nagios"></p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>centos7配置keepalived实现高可用集群</title>
      <link href="/2017/04/19/centos7%E9%85%8D%E7%BD%AEkeepalived%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/"/>
      <url>/2017/04/19/centos7%E9%85%8D%E7%BD%AEkeepalived%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<h3 id="CENTOS6-8-192-168-0-106-MASTER"><a href="#CENTOS6-8-192-168-0-106-MASTER" class="headerlink" title="CENTOS6.8 192.168.0.106 MASTER"></a>CENTOS6.8 192.168.0.106 MASTER</h3><pre><code># 安装sudo yum install keepalived# 配置sudo vim /etc/keepalived/keepalived.conf! Configuration File for keepalivedglobal_defs {    # 这些信息是配置报警发邮件信息   notification_email {     acassen@firewall.loc     failover@firewall.loc     sysadmin@firewall.loc   }   notification_email_from Alexandre.Cassen@firewall.loc   smtp_server 192.168.200.1   smtp_connect_timeout 30     # 路由标识，同一局域网应该唯一   router_id lb01}vrrp_instance VI_1 {    # 当前角色是master    state MASTER        # 对外提供网络的接口    interface eth0        # 虚拟路由id标识，数字，必须和backup里相同实例一致    virtual_router_id 55        # 优先级，数字必须比backup大    priority 150    advert_int 1        # 权限认证，和backup一致    authentication {        auth_type PASS        auth_pass 1111    }    virtual_ipaddress {       192.168.0.200    }}# 重启sudo /etc/init.d/keepalived restart# 查看结果ip addr | grep 192.168.0.200</code></pre><h3 id="CENTOS7-2-192-168-0-209-BACKUP"><a href="#CENTOS7-2-192-168-0-209-BACKUP" class="headerlink" title="CENTOS7.2 192.168.0.209 BACKUP"></a>CENTOS7.2 192.168.0.209 BACKUP</h3><pre><code># 安装sudo yum install keepalived# 配置sudo vim /etc/keepalived/keepalived.conf! Configuration File for keepalivedglobal_defs {   notification_email {     acassen@firewall.loc     failover@firewall.loc     sysadmin@firewall.loc   }   notification_email_from Alexandre.Cassen@firewall.loc   smtp_server 192.168.200.1   smtp_connect_timeout 30   router_id lb02  # 和master不一致}vrrp_instance VI_1 {    state BACKUP      # 和MASTER不一致    interface enp0s3    virtual_router_id 55    priority 100      # 和master不一致    advert_int 1    authentication {        auth_type PASS        auth_pass 1111    }    virtual_ipaddress {        192.168.0.200    }}# 重启sudo systemctl restart keepalived# 查看结果ip addr | grep 192.168.0.200</code></pre><h3 id="CENTOS6-8-192-168-0-106-nginx配置"><a href="#CENTOS6-8-192-168-0-106-nginx配置" class="headerlink" title="CENTOS6.8 192.168.0.106 nginx配置"></a>CENTOS6.8 192.168.0.106 nginx配置</h3><pre><code># nginx配置文件    server {        listen       192.168.0.200:80; # 这里需要指定虚拟vip监听        server_name  localhost;        location / {                  # 只访问web站点           proxy_pass http://www_server_pools;        }        error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }    }</code></pre><h3 id="CENTOS7-2-192-168-0-209-配置nginx"><a href="#CENTOS7-2-192-168-0-209-配置nginx" class="headerlink" title="CENTOS7.2 192.168.0.209 配置nginx"></a>CENTOS7.2 192.168.0.209 配置nginx</h3><pre><code># nginx配置文件   server {        listen       192.168.0.200:80;        server_name  localhost;        location / {                     # 只访问phone站点           proxy_pass http://www_phone_pools;        }        error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }    }</code></pre><h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><pre><code># 开启192.168.0.106，192.168.0.209的keepalive服务# 查看192.168.0.106$ ip addr | grep 192.168.0.200inet 192.168.0.200/32 scope global eth0 # 应该有这行结果# 查看192.168.0.209$ ip addr | grep 192.168.0.200 # 结果应该为空，如果有结果，表示脑裂，检查相关配置和防火墙# 访问http://192.168.200 curl 192.168.0.200 # 结果应该只访问web网站# 关停192.168.0.106的keepalive服务# 访问http://192.168.200 curl 192.168.0.200 # 结果应该只访问phone网站# 查看192.168.0.106$ ip addr | grep 192.168.0.200inet 192.168.0.200/32 scope global eth0 # 结果应该为空# 查看192.168.0.209$ ip addr | grep 192.168.0.200 inet 192.168.0.200/32 scope global enp0s3 # 此时有这行结果# 重启192.168.0.106的keepalive服务，应该恢复之前的测试结果</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>unittest单元测试</title>
      <link href="/2016/11/30/unittest%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
      <url>/2016/11/30/unittest%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h4 id="unittest基础使用方法"><a href="#unittest基础使用方法" class="headerlink" title="unittest基础使用方法"></a>unittest基础使用方法</h4><pre><code># -*- coding:utf-8 -*-# calculator.py# 需要测试的类class Count:    def __init__(self, a, b):        self.a = int(a)        self.b = int(b)    def add(self):        return self.a + self.b# -*- coding: utf-8 -*-# test.py 测试类from calculator import Countimport unittestclass TestCount(unittest.TestCase):    def setUp(self):        print &apos;test start&apos;    def test_add(self):        j = Count(2,3)        self.assertEqual(j.add(), 5)    def test_add2(self):        j = Count(41, 76)        self.assertEqual(j.add(), 115, &apos;not equal&apos;)    def tearDown(self):        print &apos;test end&apos;if __name__ == &apos;__main__&apos;:    # 测试全部方法    # unittest.main()    # 构造测试集    suite = unittest.TestSuite()    # 指定测试方法    suite.addTest(TestCount(&apos;test_add2&apos;))    # 执行测试    runner = unittest.TextTestRunner()    runner.run(suite)</code></pre><h4 id="自动识别测试用例"><a href="#自动识别测试用例" class="headerlink" title="自动识别测试用例"></a>自动识别测试用例</h4><pre><code># -*- coding:utf-8 -*-# calculator.py# 需要测试的类class Count:    def __init__(self, a, b):        self.a = int(a)        self.b = int(b)    def add(self):        return self.a + self.b    def sub(self):        return self.a - self.b# -*- coding: utf-8 -*-# testadd.py 测试类from calculator import Countimport unittestclass TestAdd(unittest.TestCase):    def setUp(self):        print &apos;test add start&apos;    def test_add(self):        j = Count(2,3)        self.assertEqual(j.add(), 5)    def test_add2(self):        j = Count(41, 76)        self.assertEqual(j.add(), 115, &apos;not equal&apos;)    def tearDown(self):        print &apos;test add end&apos;if __name__ == &apos;__main__&apos;:    # 测试全部方法    unittest.main()# -*- coding: utf-8 -*-# testsub.py 测试类from calculator import Countimport unittestclass TestSub(unittest.TestCase):    def setUp(self):        print &apos;test sub start&apos;    def test_sub(self):        j = Count(2,3)        self.assertEqual(j.sub(), 5)    def test_sub2(self):        j = Count(41, 76)        self.assertEqual(j.sub(), 115, &apos;not equal&apos;)    def tearDown(self):        print &apos;test sub end&apos;if __name__ == &apos;__main__&apos;:    # 测试全部方法    unittest.main()# -*- coding: utf-8 -*-# runtest.pyimport unittesttest_dir = &apos;./&apos;discover = unittest.defaultTestLoader.discover(test_dir, pattern=&apos;test*.py&apos;)if __name__ == &apos;__main__&apos;:    runner = unittest.TextTestRunner()    runner.run(discover)</code></pre><h4 id="断言方法啊"><a href="#断言方法啊" class="headerlink" title="断言方法啊"></a>断言方法啊</h4><pre><code># unittest.TestCase.assertEqual(a, b, msg=None)   a == b# unittest.TestCase.assertNotEqual(a, b) a !=b  # unittest.TestCase.assertTrue(x)   x is True# unittest.TestCase.assertFalse(x)  x is False# unittest.TestCase.assertIs(a, b)  x is b# unittest.TestCase.assertIsNot(a, b)  a is not b# unittest.TestCase.assertIsNotNone(x)  x is not None# unittest.TestCase.assertIn(a, b)  a in b# unittest.TestCase.assertNotIn(a, b) a not in b# unittest.TestCase.assertNotIsInstance(a, b) isinstance(a,b)# unittest.TestCase.assertNotIsInstance(a, b) not isinstance(a,b)</code></pre><h4 id="跳过测试与预期失败"><a href="#跳过测试与预期失败" class="headerlink" title="跳过测试与预期失败"></a>跳过测试与预期失败</h4><pre><code># -*- coding: utf-8 -*-# test.pyimport unittestclass MyTest(unittest.TestCase):    def setUp(self):        pass    def tearDown(self):        pass    @unittest.skip(u&apos;直接跳过测试&apos;)    def test_skip(self):        print &apos;test aaa&apos;    @unittest.skipIf(3 &gt; 2, u&apos;条件满足时跳过测试&apos;)    def test_skip_if(self):        print &apos;test bbb&apos;    @unittest.skipUnless(3 &gt; 2, u&apos;条件满足时执行测试&apos;)    def test_skip_unless(self):        print &apos;test ccc&apos;    # 不管测试成功与否，都标记为失败    @unittest.expectedFailure    def test_expected_failure(self):        print &apos;test ddd&apos;        self.assertEqual(2, 3)if __name__ == &apos;__main__&apos;:    unittest.main()</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>selenium入门基础</title>
      <link href="/2016/11/30/selenium%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/30/selenium%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="安装及基本操作"><a href="#安装及基本操作" class="headerlink" title="安装及基本操作"></a>安装及基本操作</h4><pre><code># -*- coding:utf-8 -*-# 环境: ubuntu14.04# pip install seleninum# firefox# https://github.com/mozilla/geckodriver/releases 下载对应版本放在$PATH目录下# google# https://sites.google.com/a/chromium.org/chromedriver/downloads 下载对应版本放在$PATH目录下# http://www.seleniumhq.org/download/    其他浏览器参考# sudo apt-get install phantomjs  安装无界面webkit浏览器引擎from selenium import webdriverfrom selenium.webdriver.common.by import Bydriver = webdriver.Firefox()# driver = webdriver.Chrome()# driver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)driver.get(&apos;http://www.baidu.com&apos;)# 定位元素# 根据id定位find_id = driver.find_element_by_id(&apos;wrapper&apos;)find_id = driver.find_element(By.ID, &apos;wrapper&apos;)# 根据name属性定位find_name = driver.find_element_by_name(&apos;wd&apos;)find_name = driver.find_element(By.NAME, &apos;wd&apos;)# 根据class定位find_class = driver.find_element_by_class_name(&apos;head_wrapper&apos;)find_class = driver.find_element(By.CLASS_NAME, &apos;head_wrapper&apos;)# 根据标签名称定位find_tag = driver.find_element_by_tag_name(&apos;div&apos;)find_tag = driver.find_element(By.TAG_NAME, &apos;div&apos;)# 根据链接文本定位find_a_text = driver.find_element_by_link_text(&apos;hao123&apos;)find_a_text = driver.find_element(By.LINK_TEXT, &apos;hao123&apos;)# 根据部分链接文本定位find_a_text = driver.find_element_by_partial_link_text(&apos;hao&apos;)find_a_text = driver.find_element(By.PARTIAL_LINK_TEXT, &apos;hao&apos;)# 根据绝对位置定位find_x_path = driver.find_elements_by_xpath(&apos;/html/body/div&apos;)find_x_path = driver.find_element(By.XPATH, &apos;/html/body/div&apos;)# 支持层级，属性，逻辑运算符结合使用find_x_path = driver.find_element_by_xpath(&quot;//input[@id=&apos;kw&apos;]&quot;)  # // 当前目录下的某个目录下# Css定位find_css = driver.find_elements_by_css_selector(&apos;.s_ipt&apos;)find_css = driver.find_element(By.CSS_SELECTOR, &apos;.s_ipt&apos;)# 设置浏览器宽高driver.set_window_size(480, 800)driver.get(&apos;http://www.126.com&apos;)# 控制浏览器前进倒退driver.back()driver.forward()# 刷新浏览器(F5)driver.refresh()# 当前页面print driver.current_url()# 元素操作# dom = driver.find_element(By.ID, &apos;kw&apos;)# dom.clear()  # 清除文本# dom.send_keys()  # 模拟键盘输入# dom.click()  # 点击元素# dom.submit()  # 模拟表单提交# dom.size()  # 返回元素的尺寸# dom.text()  # 返回元素的文本# dom.get_attribute(name)  # 返回元素的属性值# dom.is_displayed()  # 设置该元素是否可见# 鼠标操作from selenium.webdriver.common.action_chains import ActionChainsdriver.get(&apos;http://www.baidu.com&apos;)# context_click 鼠标右键点击right_click = driver.find_element_by_id(&apos;xx&apos;)# perform 执行所有ActionChains中存储的动作ActionChains(driver).context_click(right_click).perform()# above 鼠标悬停above = driver.find_element_by_id(&apos;xxx&apos;)ActionChains(driver).move_to_element(above).perform()# double_click 鼠标双击# drag_and_drop(source, target) 鼠标拖放# 键盘事件from selenium.webdriver.common.keys import Keysfind_id.send_keys(Keys.BACK_SPACE) # 删除键find_id.send_keys(Keys.SPACE)  # 空格键find_id.send_keys(Keys.TAB)  # tab键find_id.send_keys(Keys.ESCAPE)  # ESCfind_id.send_keys(Keys.ENTER)  # 回车键find_id.send_keys(Keys.CONTROL, &apos;c&apos;)  # 复制find_id.send_keys(Keys.CONTROL, &apos;v&apos;)  # 剪贴find_id.send_keys(Keys.F1) # F1# driver.quit()</code></pre><h4 id="webdriver原理"><a href="#webdriver原理" class="headerlink" title="webdriver原理"></a>webdriver原理</h4><pre><code># -*- coding:utf-8 -*-from selenium import webdriverimport logginglogging.basicConfig(level=logging.DEBUG)driver = webdriver.Firefox()driver.get(&apos;http://www.baidu.com&apos;)driver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)driver.find_element_by_id(&apos;su&apos;).click()driver.quit()</code></pre><h4 id="显示等待"><a href="#显示等待" class="headerlink" title="显示等待"></a>显示等待</h4><pre><code># -*- coding:utf-8 -*-# 显示等待from selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import WebDriverWaitfrom selenium.webdriver.support import expected_conditions as ECdriver = webdriver.Firefox()driver.get(&apos;http://www.baidu.com&apos;)# 显示等待# 参数driver： 浏览器驱动# 参数timeout： 最大超时时间，单位秒# 参数poll_frequency： 检测的间隔时间，默认为0.5秒# 参数ignored_exceptions: 超时异常信息，默认为NoSuchElementException# WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)# until(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回True# until_not(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回False# EC.title_is 判断当前页面的标题是否是否等于预期# EC.title_contains 判断当前页面的标题是否包含预期的字符串# EC.presence_of_element_located 判断元素是否被加载在DOM树中，并不代表当前元素可见# EC.visibility_of_element_located 判断元素是否可见（可见并非代表元素非隐藏，并且元素的宽和高均不等于0）# EC.visibility_of 与visibility_of_element_located相同，该方法接受的参数为定位后的元素# EC.presence_of_all_elements_located 判断是否至少有一个元素存在与DOM树中# EC.text_to_be_present_in_element 判断某个元素的text是否包含预期的字符串# EC.text_to_be_present_in_element_value 判断某个元素的vaule属性是否包含了预期的字符串# EC.frame_to_be_available_and_switch_to_it 判断该表单是否可以切换进去，如果可以，返回True并switch进去，否则返回false# EC.invisibility_of_element_located 判断某个元素是否不存在于DOM树中或者不可见# EC.element_to_be_clickable 判断某个元素是否可以点击# EC.staleness_of 等到一个元素从DOM树中移除# EC.element_to_be_selected 判断某个元素是否被选中，一般用于下拉菜单# EC.element_selection_state_to_be 判断某个元素的选中状态是否符合预期, 参数为定位后的元素# EC.element_located_selection_state_to_be 判断某个元素的选中状态是否符合预期,该方法接受的参数为定位# EC.alert_is_present 判断页面上是否有alert# driver.find_element_by_id().is_displayed() 判断元素是否可见element = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, &apos;kw&apos;)))element.send_keys(&apos;selenium&apos;)# driver.quit()</code></pre><h4 id="隐式等待"><a href="#隐式等待" class="headerlink" title="隐式等待"></a>隐式等待</h4><pre><code># -*- coding:utf-8 -*-# 隐式等待from selenium import webdriverfrom selenium.common.exceptions import NoSuchElementExceptionfrom time import ctimefrom time import sleepdriver = webdriver.Firefox()# sleep(10)driver.implicitly_wait(10)driver.get(&apos;http://www.baidu.com&apos;)print ctime()try:    driver.find_element_by_id(&apos;kw22&apos;).send_keys(&apos;selenium&apos;)except NoSuchElementException as e:    print efinally:    print ctime()</code></pre><h4 id="执行js代码"><a href="#执行js代码" class="headerlink" title="执行js代码"></a>执行js代码</h4><pre><code># -*- coding:utf-8 -*-# 执行js代码from selenium import webdriverfrom time import sleep# 访问百度driver = webdriver.Firefox()driver.get(&apos;http://www.baidu.com&apos;)driver.set_window_size(600, 600)driver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)driver.find_element_by_id(&apos;su&apos;).click()sleep(2)js = &apos;window.scrollTo(100, 450);&apos;driver.execute_script(js)sleep(3)# driver.quit()</code></pre><h4 id="处理cookie"><a href="#处理cookie" class="headerlink" title="处理cookie"></a>处理cookie</h4><pre><code># -*- coding:utf-8 -*-# cookie处理from selenium import webdriverdriver = webdriver.Firefox()driver.get(&apos;http://www.youdao.com&apos;)driver.add_cookie({&apos;name&apos;: &apos;name-a&apos;, &apos;value&apos;: &apos;value-b&apos;})# 获取cookie信息cookies = driver.get_cookies()print cookiesfor cookie in cookies:    print cookie    print &apos;{} -&gt; {}&apos;.format(cookie[&apos;name&apos;], cookie[&apos;value&apos;])driver.quit()</code></pre><h4 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h4><pre><code># -*- coding:utf-8 -*-# 窗口截图from selenium import webdriverfrom time import sleep# driver = webdriver.Firefox()driver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)driver.get(&apos;http://www.baidu.com&apos;)driver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)driver.find_element_by_id(&apos;su&apos;).click()sleep(2)driver.get_screenshot_as_file(&apos;./screen.png&apos;)driver.quit()</code></pre><h4 id="播放视频"><a href="#播放视频" class="headerlink" title="播放视频"></a>播放视频</h4><pre><code># -*- coding:utf-8 -*-from selenium import webdriverfrom time import sleepdriver = webdriver.Firefox()driver.get(&apos;http://videojs.com&apos;)video = driver.find_element_by_xpath(&apos;body/Setion[1]/div/video&apos;)# 返回播放文件地址url = driver.execute_script(&apos;return arguments[0].currentSrc;&apos;, video)print url# 播放视频print &apos;start&apos;driver.execute_script(&apos;return arguments[0].play()&apos;, video)# 播放15秒sleep(15)# 暂停播放print &apos;stop&apos;driver.execute_script(&apos;arguments[0].pause()&apos;, video)# driver.quit()</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpress插件开发基础入门</title>
      <link href="/2016/11/10/wordpress%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"/>
      <url>/2016/11/10/wordpress%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="创建插件"><a href="#创建插件" class="headerlink" title="创建插件"></a>创建插件</h4><pre><code>├── hanchang-copyright│   └── hanchang-copyright.php# hanchang-copyright.php&lt;?php/*Plugin Name: hanchang-copyrightPlugin URI: http://www.zhuohc.comDescription: 在页脚显示一段版权信息Version: 1.0Author: hanchangAuthor URI: http://www.zhuohc.comLicense: GPLv2*/</code></pre><h4 id="插件启用和停用初始化"><a href="#插件启用和停用初始化" class="headerlink" title="插件启用和停用初始化"></a>插件启用和停用初始化</h4><pre><code># hanchang-copyright.php&lt;?php/*Plugin Name: hanchang-copyrightPlugin URI: http://www.zhuohc.comDescription: 在页脚显示一段版权信息Version: 1.0Author: hanchangAuthor URI: http://www.zhuohc.comLicense: GPLv2*///定义插件启动时候调用的方法register_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);function hanchang_copyright_install() {    //插件启动，添加一个默认的版权信息    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );}//定义插件停用时候调用的方法register_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);function hanchang_copyright_deactivation() {    //插件停用，设置停用标识为1    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );}</code></pre><h4 id="删除插件"><a href="#删除插件" class="headerlink" title="删除插件"></a>删除插件</h4><pre><code>.├── hanchang-copyright.php└── uninstall.php # 删除插件执行的文件# uninstall.php&lt;?// 如果 uninstall 不是从 WordPress 调用，则退出if( !defined( &apos;WP_UNINSTALL_PLUGIN&apos; ) )exit();//删除插件创建的项目，以确保不占用数据库资源delete_option( &apos;hanchang_copyright_deactivation&apos; );delete_option( &apos;hanchang_copyright_text&apos; );</code></pre><h4 id="add-action"><a href="#add-action" class="headerlink" title="add_action"></a>add_action</h4><pre><code>add_action(&quot;$tag钩子名称&quot;, &quot;$function_to_do执行函数&quot;, $priorrity执行优先级, $accepted_arga带参数函数的参数个数)# hanchang-copyright.php//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insertadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );function hc_copyright_insert(){    //输出一段字符串    echo get_option( &quot;hc_copyright_text&quot; );}add_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );function hanchang_copyright_insert_new() {    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;}add_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );function save_post_meta( $post_id, $post ) {    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );}</code></pre><h4 id="常见钩子"><a href="#常见钩子" class="headerlink" title="常见钩子"></a>常见钩子</h4><pre><code>init 加载初始化wp_head 加载添加到head标签中的内容wp_enqueue_scripts 加载css或者js文件wp_foot 加载添加到底部内容save_post 添加保存文章wp_trash_post 将文章添加到回收站delete_post 将文章删除wp_insert_comment 插入评论user_register 用户注册# hanchang-copyright.php&lt;?php/*Plugin Name: hanchang-copyrightPlugin URI: http://www.zhuohc.comDescription: 在页脚显示一段版权信息Version: 1.0Author: hanchangAuthor URI: http://www.zhuohc.comLicense: GPLv2*///定义插件启动时候调用的方法register_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);function hanchang_copyright_install() {    //插件启动，添加一个默认的版权信息    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );}//定义插件停用时候调用的方法register_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);function hanchang_copyright_deactivation() {    //插件停用，设置停用标识为1    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );}//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insertadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );function hc_copyright_insert(){    //输出一段字符串    echo get_option( &quot;hc_copyright_text&quot; );}add_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );function hanchang_copyright_insert_new() {    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;}add_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );function save_post_meta( $post_id, $post ) {    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );}//在输出内容之前，给页面管理添加摘要功能add_action( &apos;init&apos;, &apos;hc_add_excerpts_to_pages&apos; );function hc_add_excerpts_to_pages() {    //给页面管理添加摘要的功能    add_post_type_support( &apos;page&apos;, array( &apos;excerpt&apos; ) );}//wp_head钩子add_action(&apos;wp_head&apos;,&apos;hc_wp_head&apos;);function hc_wp_head() {    //只有首页输出描述    if( is_home() ){ ?&gt;        &lt;meta name=&quot;description&quot; content=&quot;&lt;? bloginfo(&apos;description&apos;); ?&gt;&quot; /&gt;    &lt;? }}//自定义引用样式表function hc_enqueue_style() {    wp_enqueue_style( &apos;core&apos;, plugins_url(&apos;css/hc_copyrighy.css&apos;, __FILE__) , false );}//自定义引用脚本文件function hc_enqueue_script() {    wp_enqueue_script( &apos;my-js&apos;, plugins_url(&apos;js/hc_copyrighy.js&apos;, __FILE__), false );}//引用文件的钩子add_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_style&apos;, 5 );add_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_script&apos;, 7 );//删除所有挂载在 wp_enqueue_scripts 钩子上的方法remove_all_actions( &apos;wp_enqueue_scripts&apos;, 5 );//评论被添加的时候触发add_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10, 2 );//移除 wp_insert_comment 钩子上的 comment_inserted 方法remove_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10 );function comment_inserted($comment_id, $comment_object ) {    //获取该评论所在文章的评论总数    $comments_count = wp_count_comments( $comment_object-&gt;comment_post_ID );    $commentarr = array();    $commentarr[&apos;comment_ID&apos;] = $comment_id;    //修改评论的内容，在评论内容前加上 “第{$comments_count-&gt;total_comments}个评论：” 这么一段字符串    $commentarr[&apos;comment_content&apos;] = &quot;第{$comments_count-&gt;total_comments}个评论：&quot; . $comment_object-&gt;comment_content;    wp_update_comment( $commentarr );}add_action( &apos;user_register&apos;, &apos;myplugin_registration_save&apos;, 10, 1 );function myplugin_registration_save( $user_id ) {    //将新用户的个人说明，设置为注册时间    wp_update_user( array( &apos;ID&apos; =&gt; $user_id, &apos;description&apos; =&gt; &quot;注册时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) ) );}?&gt;</code></pre><h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><pre><code>add_filter($tag过滤器名称, $function_to_add需要添加的函数, $priority优先级, $acceptedargs添加的参数数量)# hanchang-copyright.php//一开始，我们设置一个变量$value = &quot;hello&quot;;//给名为 hc_filter 的过滤器，挂载一个 hc_filter_fun 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun 方法进行过滤//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun&quot; );//给名为 hc_filter 的过滤器，再挂载一个 hc_filter_fun_add_time 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun、hc_filter_fun_add_time 两个方法进行过滤//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun_add_time&quot; );//对 $value 值使用名为 hc_filter 的过滤器进行过滤，这个时候，由于 hc_filter 过滤器只挂载了 hc_filter_fun 方法，因此，只使用 hc_filter_fun 方法 过滤了一次，并且返回给 $myvar 变量//$myvar = apply_filters( &quot;hc_filter&quot;, $value );add_filter( &quot;the_content&quot;, &quot;hc_filter_fun&quot; );add_filter( &quot;the_content&quot;, &quot;hc_filter_fun_add_time&quot; );</code></pre><h4 id="带参数的过滤器"><a href="#带参数的过滤器" class="headerlink" title="带参数的过滤器"></a>带参数的过滤器</h4><pre><code># hanchang-copyright.phpfunction suppress_if_blurb( $title, $id = null ) {    if ( in_category(&apos;wpcj&apos;, $id ) ) {        return &apos;不显示标题&apos;;    }    return $title . &quot;...&quot;;}//对 the_title 过滤器挂载一个 suppress_if_blurb 方法，优先级为10，传递的参数有2个add_filter( &apos;the_title&apos;, &apos;suppress_if_blurb&apos;, 10, 2 );</code></pre><h4 id="常见过滤器"><a href="#常见过滤器" class="headerlink" title="常见过滤器"></a>常见过滤器</h4><pre><code>the_content 文章内容 content_save_pre 文章保存前the_title 文章标题wp_handle_upload_prefilter 上传文件之前</code></pre><h4 id="创建菜单"><a href="#创建菜单" class="headerlink" title="创建菜单"></a>创建菜单</h4><pre><code>add_menu_page  # 添加菜单add_submenu_page  # 添加子菜单# hanchang-copyright.php// admin_menu钩子挂载创建菜单方法add_action( &apos;admin_menu&apos;, &apos;hc_create_menu&apos; );function hc_create_menu() {    // 创建顶级菜单    add_menu_page(        &apos;Hanchang的插件首页&apos;, // 菜单title标题        &apos;hanchang-copyright&apos;,  // 菜单名称，显示在后台管理页面侧边栏        &apos;manage_options&apos;, // 浏览插件所需要的权限=管理员权限        &apos;hanchang_copyright&apos; ,  // 菜单别名，不能与其他插件冲突        &apos;hanchang_settings_page&apos;,  // 菜单需要显示的页面，调用的哪个方法        plugins_url( &apos;/images/icon.png&apos;, __FILE__ )  // 调用图标    );    // 创建子菜单    add_submenu_page(        &apos;hanchang_copyright&apos;,  // 父级菜单别名        &apos;关于HC的插件&apos;,  // 菜单title标题        &apos;关于&apos;,  //  菜单名称，显示在后台管理页面侧边栏        &apos;manage_options&apos;,  // 浏览插件所需要的权限=管理员权限        &apos;hc_copyright_about&apos;,  // 菜单别名，不能与其他插件冲突        &apos;hc_create_submenu_menu&apos;  // 调用方法    );}function hanchang_settings_page() {    ?&gt;    &lt;h2&gt;插件顶级菜单&lt;/h2&gt;    &lt;?}function hc_create_submenu_menu() {    ?&gt;    &lt;h2&gt;子菜单&lt;/h2&gt;    &lt;?}</code></pre><p>#开发 小工具</p><pre><code>#hanchang-copyright.php// 使用 widgets_init 动作钩子来执行自定义的函数add_action( &apos;widgets_init&apos;, &apos;hc_register_widgets&apos; );// 注册小工具function hc_register_widgets() {    register_widget( &apos;hc_widget_info&apos; );}//使用 WP_Widget 类来创建小工具class hc_widget_info extends WP_Widget {    //构造函数    public function __construct() {        $widget_ops = array(            &apos;classname&apos; =&gt; &apos;hc_widget_info&apos;,            &apos;description&apos; =&gt; &apos;显示作者的个人信息&apos;        );        $this-&gt;WP_Widget( &apos;显示作者个人信息&apos;, &apos;作者的小工具&apos;, $widget_ops );    }    //小工具管理界面    public function form( $instance ) {        $defaults = array( &apos;title&apos; =&gt; &apos;作者的个人信息&apos;, &apos;xingming&apos; =&gt; &apos;作者&apos;, &apos;book&apos; =&gt; &apos;《作者》&apos; );        $instance = wp_parse_args( (array) $instance, $defaults );        $title = $instance[&apos;title&apos;];        $xingming = $instance[&apos;xingming&apos;];        $book = $instance[&apos;book&apos;];        ?&gt;        &lt;p&gt;标题: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;title&apos; ); ?&gt;&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $title ); ?&gt;&quot; /&gt;&lt;/p&gt;        &lt;p&gt;姓名: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;xingming&apos; ); ?&gt; &quot;type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $xingming ); ?&gt; &quot; /&gt;&lt;/p&gt;        &lt;p&gt;著作: &lt;textarea class=&quot;widefat&quot; name=&quot; &lt;?php echo $this-&gt;get_field_name( &apos;book&apos; ); ?&gt; &quot; /&gt;&lt;?php echo esc_attr( $book ); ?&gt;&lt;/textarea&gt; &lt;/p&gt;        &lt;?php    }    //保存小工具设置    public function update( $new_instance, $old_instance ) {        $instance = $old_instance;        $instance[&apos;title&apos;] = strip_tags( trim( $new_instance[&apos;title&apos;] ) );        $instance[&apos;xingming&apos;] = strip_tags( trim(  $new_instance[&apos;xingming&apos;] ) );        $instance[&apos;book&apos;] = strip_tags( trim( $new_instance[&apos;book&apos;] ) );        return $instance;    }    //显示小工具    public function widget( $args, $instance ) {        extract( $args );        $title = apply_filters( &apos;widget_title&apos;, $instance[&apos;title&apos;] );        $xingming = empty( $instance[&apos;xingming&apos;] ) ? &apos; &apos; : $instance[&apos;xingming&apos;];        $book = empty( $instance[&apos;book&apos;] ) ? &apos; &apos; : $instance[&apos;book&apos;];        echo &apos;&lt;p&gt; 标题: &apos; . $title . &apos;&lt;/p&gt;&apos;;        echo &apos;&lt;p&gt; 姓名: &apos; . $xingming . &apos;&lt;/p&gt;&apos;;        echo &apos;&lt;p&gt; 著作: &apos; . $book . &apos;&lt;/p&gt;&apos;;    }}</code></pre><h4 id="添加元数据框"><a href="#添加元数据框" class="headerlink" title="添加元数据框"></a>添加元数据框</h4><pre><code># hanchang-copyright.php/** * 添加一个元数据框到 post 和 page 的管理界面中 */function myplugin_add_meta_box() {    $screens = array( &apos;post&apos;, &apos;page&apos; );    add_meta_box(        &apos;myplugin_sectionid&apos;,  // 元数据框的html代码中的id值        &apos;转载自&apos;,  // 元数据框标题        &apos;myplugin_meta_box_callback&apos;,  // 回调函数名称，输出元数据框中的内容        $screens  // 元数据框需要添加在哪个分类内的（文章或者页面）    );}//需要给 add_meta_boxes 钩子，挂载一个自定义的方法add_action( &apos;add_meta_boxes&apos;, &apos;myplugin_add_meta_box&apos; );/** * 元数据框展示代码 */function myplugin_meta_box_callback( $post ) {    // 添加一个验证信息，这个在保存元数据的时候用到    wp_nonce_field( &apos;myplugin_save_meta_box_data&apos;, &apos;myplugin_meta_box_nonce&apos; );    /*     * 输出元数据信息     */    $value = get_post_meta( $post-&gt;ID, &apos;_zzurl&apos;, true );    echo &apos;&lt;label for=&quot;myplugin_new_field&quot;&gt;&apos;;    _e( &apos;本文章转载自：&apos; );    echo &apos;&lt;/label&gt; &apos;;    echo &apos;&lt;input type=&quot;text&quot; id=&quot;_zzurl&quot; name=&quot;_zzurl&quot; value=&quot;&apos; . esc_attr( $value ) . &apos;&quot; size=&quot;25&quot; /&gt;&apos;;}function myplugin_save_meta_box_data( $post_id ) {    //验证是否为有效信息    if ( ! isset( $_POST[&apos;myplugin_meta_box_nonce&apos;] ) ) {        return;    }    if ( ! wp_verify_nonce( $_POST[&apos;myplugin_meta_box_nonce&apos;], &apos;myplugin_save_meta_box_data&apos; ) ) {        return;    }    if ( defined( &apos;DOING_AUTOSAVE&apos; ) &amp;&amp; DOING_AUTOSAVE ) {        return;    }    // Check the user&apos;s permissions.    if ( isset( $_POST[&apos;post_type&apos;] ) &amp;&amp; &apos;page&apos; == $_POST[&apos;post_type&apos;] ) {        if ( ! current_user_can( &apos;edit_page&apos;, $post_id ) ) {            return;        }    } else {        if ( ! current_user_can( &apos;edit_post&apos;, $post_id ) ) {            return;        }    }    if ( ! isset( $_POST[&apos;_zzurl&apos;] ) ) {        return;    }    $my_data = sanitize_text_field( $_POST[&apos;_zzurl&apos;] );    update_post_meta( $post_id, &apos;_zzurl&apos;, $my_data );}//文章保存的时候，会调用 save_post 钩子，因此我们要借助这个钩子来保存元数据框内的数据add_action( &apos;save_post&apos;, &apos;myplugin_save_meta_box_data&apos; );</code></pre><h4 id="后台常见css样式表"><a href="#后台常见css样式表" class="headerlink" title="后台常见css样式表"></a>后台常见css样式表</h4><pre><code># copyright.phpfunction hanchang_settings_page() {    ?&gt;    &lt;div class=&quot;wrap&quot;&gt;        &lt;h2&gt;插件顶级菜单&lt;/h2&gt;        &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;设置保存成功&lt;/div&gt;        &lt;div id=&quot;message&quot; class=&quot;error&quot;&gt;保存出现错误&lt;/div&gt;        &lt;p&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-primary&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-secondary&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-large&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-small&quot; /&gt;            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-hero&quot; /&gt;        &lt;/p&gt;        &lt;p&gt;            &lt;a href=&quot;#&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button button-primary&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button button-secondary&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button button-large&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button button-small&quot;&gt;搜索&lt;/a&gt;            &lt;a href=&quot;#&quot; class=&quot;button button-hero&quot;&gt;搜索&lt;/a&gt;        &lt;/p&gt;        &lt;form method=&quot;POST&quot; action=&quot;&quot;&gt;            &lt;table class=&quot;form-table&quot;&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;th&gt;&lt;label for=&quot;xingming&quot;&gt;姓名：&lt;/label&gt;&lt;/th&gt;                    &lt;td&gt;&lt;input id=&quot;xingming&quot; name=&quot;xingming&quot; /&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;th&gt;&lt;label for=&quot;shenfen&quot;&gt;身份：&lt;/label&gt;&lt;/th&gt;                    &lt;td&gt;                        &lt;select name=&quot;shenfen&quot;&gt;                            &lt;option value=&quot;在校&quot;&gt;在校&lt;/option&gt;                            &lt;option value=&quot;毕业&quot;&gt;毕业&lt;/option&gt;                        &lt;/select&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;th&gt;&lt;label for=&quot;tongyi&quot;&gt;同意注册&lt;/label&gt;&lt;/th&gt;                    &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;tongyi&quot; /&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;th&gt;&lt;label for=&quot;xingbie&quot;&gt;性别&lt;/label&gt;&lt;/th&gt;                    &lt;td&gt;                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;男&quot; /&gt; 男                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;女&quot; /&gt; 女                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;th&gt;&lt;label for=&quot;beizhu&quot;&gt;备注&lt;/label&gt;&lt;/th&gt;                    &lt;td&gt;&lt;textarea name=&quot;beizhu&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr valign=&quot;top&quot;&gt;                    &lt;td&gt;                        &lt;input type=&quot;submit&quot; name=&quot;save&quot; value=&quot;保存&quot; class=&quot;button-primary&quot; /&gt;                        &lt;input type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;重置&quot; class=&quot;button-secondary&quot; /&gt;                    &lt;/td&gt;                &lt;/tr&gt;            &lt;/table&gt;        &lt;/form&gt;        &lt;table class=&quot;widefat striped&quot;&gt;            &lt;thead&gt;            &lt;tr&gt;                &lt;th&gt;序号&lt;/th&gt;                &lt;th&gt;姓名&lt;/th&gt;            &lt;/tr&gt;            &lt;/thead&gt;            &lt;tbody&gt;            &lt;tr&gt;                &lt;td&gt;1&lt;/td&gt;                &lt;td&gt;黄聪&lt;/td&gt;            &lt;/tr&gt;            &lt;tr&gt;                &lt;td&gt;2&lt;/td&gt;                &lt;td&gt;黄聪&lt;/td&gt;            &lt;/tr&gt;            &lt;tr&gt;                &lt;td&gt;3&lt;/td&gt;                &lt;td&gt;黄聪&lt;/td&gt;            &lt;/tr&gt;            &lt;/tbody&gt;            &lt;tfoot&gt;            &lt;tr&gt;                &lt;th&gt;序号&lt;/th&gt;                &lt;th&gt;姓名&lt;/th&gt;            &lt;/tr&gt;            &lt;/tfoot&gt;        &lt;/table&gt;        &lt;div class=&quot;tablenav&quot;&gt;            &lt;div class=&quot;tablenav-pages&quot;&gt;                &lt;span class=&quot;displaying-num&quot;&gt;第1页，共458页&lt;/span&gt;                &lt;span class=&quot;page-numbers current&quot;&gt;1&lt;/span&gt;                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;2&lt;/a&gt;                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;3&lt;/a&gt;                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;4&lt;/a&gt;                &lt;a href=&quot;#&quot; class=&quot;next page-numbers&quot;&gt;»&lt;/a&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;?}</code></pre><h4 id="保存插件设置到数据库中"><a href="#保存插件设置到数据库中" class="headerlink" title="保存插件设置到数据库中"></a>保存插件设置到数据库中</h4><pre><code>├── hc-test│   ├── css│   ├── hc-test.php│   ├── images│   └── jshc-test.php&lt;?php/*Plugin Name: hc-testPlugin URI: http://zhuohc.comDescription: 测试插件Version: 1.0Author: hcAuthor URI: http://zhuohc.comLicense: GPLv2*///设置时区为 亚洲/上海date_default_timezone_set(&apos;Asia/Shanghai&apos;);//定义插件启动时候调用的方法register_activation_hook( __FILE__, &apos;hc_test_install&apos;);function hc_test_install() {   global $wpdb;   if( $wpdb-&gt;get_var( &quot;SHOW TABLES LIKE &apos;{$wpdb-&gt;prefix}test&apos;&quot; ) != &quot;{$wpdb-&gt;prefix}test&quot; )    {      $sql = &quot;CREATE TABLE IF NOT EXISTS `{$wpdb-&gt;prefix}test` (           `id` int(11) NOT NULL auto_increment COMMENT &apos;编号&apos;,           `color` varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体颜色&apos;,           `size`  varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体大小&apos;,           PRIMARY KEY  (`id`)         ) DEFAULT CHARSET=utf8 AUTO_INCREMENT=0;&quot;;      $wpdb-&gt;query( $sql );      $sql = &quot;REPLACE INTO `{$wpdb-&gt;prefix}test` VALUES (1, &apos;#FF0000&apos;,&apos;20&apos;);&quot;;      $wpdb-&gt;query( $sql );   }}add_action( &apos;admin_menu&apos;, &apos;hc_test_create_menu&apos; );function hc_test_create_menu() {   //创建顶级菜单   add_menu_page(       &apos;HC-TEST&apos;,       &apos;HC的插件&apos;,      &apos;manage_options&apos;,       &apos;hc_test&apos; ,      &apos;hc_settings_page&apos;,      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )   );}function hc_settings_page() {   global $wpdb;   //当提交了，并且验证信息正确   if( !empty( $_POST ) &amp;&amp; check_admin_referer( &apos;hc_test_nonce&apos; ) ) {      //更新设置      update_option( &apos;hc_test_bold&apos;, $_POST[&apos;hc_test_bold&apos;] );      $wpdb-&gt;update( &quot;{$wpdb-&gt;prefix}test&quot;, array( &apos;color&apos; =&gt; $_POST[&apos;color&apos;], &apos;size&apos; =&gt; $_POST[&apos;size&apos;] ), array( &apos;id&apos; =&gt; 1 ) );      ?&gt;      &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;         &lt;p&gt;&lt;strong&gt;保存成功！&lt;/strong&gt;&lt;/p&gt;      &lt;/div&gt;      &lt;?   }   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );   $color = $row[&apos;color&apos;];   $size = $row[&apos;size&apos;];   ?&gt;   &lt;div class=&quot;wrap&quot;&gt;      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;      &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;         &lt;p&gt;&lt;label for=&quot;color&quot;&gt;字体颜色：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;color&quot; value=&quot;&lt;?php echo $color; ?&gt;&quot; /&gt;&lt;/p&gt;         &lt;p&gt;&lt;label for=&quot;size&quot;&gt;字体大小：&lt;/label&gt;         &lt;select name=&quot;size&quot;&gt;            &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;            &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;            &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;            &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;            &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;         &lt;/select&gt;&lt;/p&gt;         &lt;p&gt;&lt;label for=&quot;hc_test_obold&quot;&gt;字体加粗：&lt;/label&gt;&lt;input name=&quot;hc_test_bold&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, get_option( &apos;hc_test_bold&apos; ) ); ?&gt; /&gt; 加粗&lt;/p&gt;         &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;保存设置&quot; /&gt;&lt;/p&gt;         &lt;?            //输出一个验证信息            wp_nonce_field(&apos;hc_test_nonce&apos;);         ?&gt;      &lt;/form&gt;   &lt;/div&gt;   &lt;?}add_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );function hc_test_head_fun() {   global $wpdb;   //获取自定义数据库中的设置   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );   //获取options表中的设置选项   $bold = get_option( &quot;hc_test_bold&quot; ) == 1 ? &quot;bold&quot; : &quot;normal&quot;;   ?&gt;&lt;style&gt;body{color:&lt;? echo $row[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $row[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?}</code></pre><h4 id="使用wordpress内置api设置插件属性"><a href="#使用wordpress内置api设置插件属性" class="headerlink" title="使用wordpress内置api设置插件属性"></a>使用wordpress内置api设置插件属性</h4><pre><code># hc-test.php&lt;?php/*Plugin Name: hc-testPlugin URI: http://zhuohc.comDescription: 测试插件Version: 1.0Author: hcAuthor URI: http://zhuohc.comLicense: GPLv2*///设置时区为 亚洲/上海date_default_timezone_set(&apos;Asia/Shanghai&apos;);add_action( &apos;admin_menu&apos;, &apos;test_create_menu&apos; );function test_create_menu() {   //创建顶级菜单   add_menu_page(      &apos;HC的插件首页&apos;,      &apos;HC的插件&apos;,      &apos;manage_options&apos;,      &apos;hc_test&apos; ,      &apos;hc_settings_page&apos;,      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )   );}add_action( &apos;admin_init&apos;, &apos;register_hc_test_setting&apos; );//使用register_setting()注册要存储的字段function register_hc_test_setting() {   //注册一个选项，用于装载所有插件设置项   $option_group = &quot;hc_test_group&quot;;   register_setting( $option_group, &apos;hc_test_option&apos; );   //添加选项设置区域   $setting_section = &quot;hc_test_setting_section&quot;;   add_settings_section(      $setting_section,      &apos;设置&apos;,  // 标题      &apos;hc_test_setting_section_function&apos;,  // 调用方法，自定义输出      $option_group   );   //设置字体颜色   add_settings_field(      &apos;hc_test_color&apos;,  // 字段id      &apos;字体颜色&apos;,  // 字段标题      &apos;hc_test_color_function&apos;, // 字段对应函数方法      $option_group,  // 字段对应分组      $setting_section  // 字段对应设置选项   );   //设置字体大小   add_settings_field(      &apos;hc_test_size&apos;,      &apos;字体大小&apos;,      &apos;hc_test_size_function&apos;,      $option_group,      $setting_section   );   //设置字体加粗   add_settings_field(      &apos;hc_test_bold&apos;,      &apos;字体加粗&apos;,      &apos;hc_test_bold_function&apos;,      $option_group,      $setting_section   );}function hc_test_bold_function() {   $hc_test_option = get_option( &quot;hc_test_option&quot; );   ?&gt;   &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗   &lt;?}function hc_test_size_function() {   $hc_test_option = get_option( &quot;hc_test_option&quot; );   $size = $hc_test_option[&quot;size&quot;];   ?&gt;   &lt;select name=&quot;hc_test_option[size]&quot;&gt;      &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;      &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;      &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;      &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;      &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;   &lt;/select&gt;   &lt;?}function hc_test_color_function() {   $hc_test_option = get_option( &quot;hc_test_option&quot; );   ?&gt;   &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;   &lt;?}function hc_settings_page() {   ?&gt;   &lt;div class=&quot;wrap&quot;&gt;      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;      &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;         &lt;?         $option_group = &quot;hc_test_group&quot;;         //输出一些必要的字段，包括验证信息等         settings_fields( $option_group );         //输出选项设置区域         do_settings_sections( $option_group );         //输出按钮         submit_button();         ?&gt;      &lt;/form&gt;   &lt;/div&gt;   &lt;?}add_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );function hc_test_head_fun() {   $hc_test_option = get_option( &quot;hc_test_option&quot; );   $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;   ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?}</code></pre><h4 id="将插件改写成类的形式"><a href="#将插件改写成类的形式" class="headerlink" title="将插件改写成类的形式"></a>将插件改写成类的形式</h4><pre><code>#hc-test.php&lt;?php/*Plugin Name: hc-testPlugin URI: http://zhuohc.comDescription: 测试插件Version: 1.0Author: hcAuthor URI: http://zhuohc.comLicense: GPLv2*///设置时区为 亚洲/上海date_default_timezone_set(&apos;Asia/Shanghai&apos;);class hcsem_change_font_style {   //声明类里面的属性，用 var 开头   var $icon_url = &quot;/images/icon.png&quot;;   var $option_group = &quot;hc_test_group&quot;;   //构造方法，创建类的时候调用   function hcsem_change_font_style() {      //创建菜单      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );   }   //使用register_setting()注册要存储的字段   function register_hc_test_setting() {      //注册一个选项，用于装载所有插件设置项      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );      //添加选项设置区域      $setting_section = &quot;hc_test_setting_section&quot;;      add_settings_section(         $setting_section,         &apos;&apos;,         &apos;&apos;,         $this-&gt;option_group      );      //设置字体颜色      add_settings_field(         &apos;hc_test_color&apos;,         &apos;字体颜色&apos;,         array( $this, &apos;hc_test_color_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体大小      add_settings_field(         &apos;hc_test_size&apos;,         &apos;字体大小&apos;,         array( $this, &apos;hc_test_size_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体加粗      add_settings_field(         &apos;hc_test_bold&apos;,         &apos;字体加粗&apos;,         array( $this, &apos;hc_test_bold_function&apos; ),         $this-&gt;option_group,         $setting_section      );   }   function hc_test_bold_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗      &lt;?   }   function hc_test_size_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $size = $hc_test_option[&quot;size&quot;];      ?&gt;      &lt;select name=&quot;hc_test_option[size]&quot;&gt;         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;      &lt;/select&gt;      &lt;?   }   function hc_test_color_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;      &lt;?   }   function hc_create_menu() {      //创建顶级菜单      add_menu_page(         &apos;HC的插件首页&apos;,         &apos;HC的插件&apos;,         &apos;manage_options&apos;,         &apos;hc_test&apos; ,         array( $this, &apos;hc_settings_page&apos; ),         plugins_url( $this-&gt;icon_url, __FILE__ )      );   }   function hc_settings_page() {      ?&gt;      &lt;div class=&quot;wrap&quot;&gt;         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;            &lt;?            //输出一些必要的字段，包括验证信息等            settings_fields( $this-&gt;option_group );            //输出选项设置区域            do_settings_sections( $this-&gt;option_group );            //输出按钮            submit_button();            ?&gt;         &lt;/form&gt;      &lt;/div&gt;      &lt;?   }   function hc_test_head_fun() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?   }}new hcsem_change_font_style();</code></pre><h4 id="将插件设置内容转移到wordpress设置里"><a href="#将插件设置内容转移到wordpress设置里" class="headerlink" title="将插件设置内容转移到wordpress设置里"></a>将插件设置内容转移到wordpress设置里</h4><pre><code># hc-test.phpclass hcsem_change_font_style {   var $option_group = &quot;general&quot;;  // general常规 writing撰写 reading阅读 discussion讨论 media多媒体 permalink固定链接   //构造方法，创建类的时候调用   function hcsem_change_font_style() {      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );   }   //使用register_setting()注册要存储的字段   function register_hc_test_setting() {      //注册一个选项，用于装载所有插件设置项      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );      //设置字体颜色      add_settings_field(         &apos;hc_test_color&apos;,         &apos;字体颜色&apos;,         array( $this, &apos;hc_test_color_function&apos; ),         $this-&gt;option_group      );      //设置字体大小      add_settings_field(         &apos;hc_test_size&apos;,         &apos;字体大小&apos;,         array( $this, &apos;hc_test_size_function&apos; ),         $this-&gt;option_group      );      //设置字体加粗      add_settings_field(         &apos;hc_test_bold&apos;,         &apos;字体加粗&apos;,         array( $this, &apos;hc_test_bold_function&apos; ),         $this-&gt;option_group      );   }   function hc_test_bold_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗      &lt;?   }   function hc_test_size_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $size = $hc_test_option[&quot;size&quot;];      ?&gt;      &lt;select name=&quot;hc_test_option[size]&quot;&gt;         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;      &lt;/select&gt;      &lt;?   }   function hc_test_color_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;      &lt;?   }   function hc_test_head_fun() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?   }}new hcsem_change_font_style();</code></pre><h4 id="调用ajax"><a href="#调用ajax" class="headerlink" title="调用ajax"></a>调用ajax</h4><pre><code># hc-test.php&lt;?php/*Plugin Name: hc-testPlugin URI: http://zhuohc.comDescription: 测试插件Version: 1.0Author: hcAuthor URI: http://zhuohc.comLicense: GPLv2*///设置时区为 亚洲/上海date_default_timezone_set(&apos;Asia/Shanghai&apos;);class hcsem_change_font_style {   //声明类里面的属性，用 var 开头   var $icon_url = &quot;/images/icon.png&quot;;   var $option_group = &quot;hc_test_group&quot;;   //构造方法，创建类的时候调用   function hcsem_change_font_style() {      //创建菜单      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );      //使用ajax校验信息      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );   }   function color_check_action_fun(){      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }      wp_die();   }   function hcsem_description_fun() {      echo &quot;hc的笔记本：&quot; . $_POST[&apos;description&apos;];      wp_die();   }   //使用register_setting()注册要存储的字段   function register_hc_test_setting() {      //注册一个选项，用于装载所有插件设置项      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );      //添加选项设置区域      $setting_section = &quot;hc_test_setting_section&quot;;      add_settings_section(         $setting_section,         &apos;&apos;,         &apos;&apos;,         $this-&gt;option_group      );      //设置字体颜色      add_settings_field(         &apos;hc_test_color&apos;,         &apos;字体颜色&apos;,         array( $this, &apos;hc_test_color_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体大小      add_settings_field(         &apos;hc_test_size&apos;,         &apos;字体大小&apos;,         array( $this, &apos;hc_test_size_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体加粗      add_settings_field(         &apos;hc_test_bold&apos;,         &apos;字体加粗&apos;,         array( $this, &apos;hc_test_bold_function&apos; ),         $this-&gt;option_group,         $setting_section      );   }   function hc_test_bold_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗      &lt;?   }   function hc_test_size_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $size = $hc_test_option[&quot;size&quot;];      ?&gt;      &lt;select name=&quot;hc_test_option[size]&quot;&gt;         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;      &lt;/select&gt;      &lt;?   }   function hc_test_color_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;      &lt;?   }   function hc_create_menu() {      //创建顶级菜单      add_menu_page(         &apos;HC的插件首页&apos;,         &apos;HC的插件&apos;,         &apos;manage_options&apos;,         &apos;hc_test&apos; ,         array( $this, &apos;hc_settings_page&apos; ),         plugins_url( $this-&gt;icon_url, __FILE__ )      );   }   function hc_settings_page() {      ?&gt;      &lt;div class=&quot;wrap&quot;&gt;         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;            &lt;?            //输出一些必要的字段，包括验证信息等            settings_fields( $this-&gt;option_group );            //输出选项设置区域            do_settings_sections( $this-&gt;option_group );            //输出按钮            submit_button();            ?&gt;         &lt;/form&gt;      &lt;/div&gt;      &lt;?   }   function hc_test_head_fun() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?   }}new hcsem_change_font_style();# js/hc_test.jsjQuery(document).ready( function($) {   $(&quot;input[name=&apos;hc_test_option[color]&apos;]&quot;).blur( function() {      $.ajax({         type: &quot;POST&quot;,         data: &quot;color=&quot; + $(this).val() + &quot;&amp;action=hc_color_check&quot;,         url: ajax_object.ajax_url,         beforeSend: function() {            $(&apos;#error_color&apos;).html(&apos;校验中...&apos;);          },         success: function( $data ) {            if( $data == &apos;ok&apos;){                $(&apos;#error_color&apos;).html(&apos;输入正确&apos;);              } else {                $(&apos;#error_color&apos;).html(&apos;颜色不能为空！&apos;);             }         }      });   });});jQuery(document).ready( function($) {   $(&quot;.description&quot;).click( function() {      $.ajax({         type: &quot;POST&quot;,         data: &quot;description=&quot; + $(this).text() + &quot;&amp;action=hcsem_description&quot;,         url: ajax_object.ajax_url,         success : function( $data ) {            if( $data != &quot;0&quot; ) {               $(&quot;.description&quot;).text( $data );            }         }      });   });});</code></pre><h4 id="实现插件翻译功能"><a href="#实现插件翻译功能" class="headerlink" title="实现插件翻译功能"></a>实现插件翻译功能</h4><pre><code>.├── css│   └── hc_copyrighy.css├── hc-test.php├── images│   └── icon.png├── js│   └── hc_test.js└── languages    ├── zh_CN.mo    └── zh_CN.po# hc-test.php&lt;?php/*Plugin Name: hc-testPlugin URI: http://zhuohc.comDescription: 测试插件Version: 1.0Author: hcAuthor URI: http://zhuohc.comLicense: GPLv2*///设置时区为 亚洲/上海date_default_timezone_set(&apos;Asia/Shanghai&apos;);class hcsem_change_font_style {   //声明类里面的属性，用 var 开头   var $icon_url = &quot;/images/icon.png&quot;;   var $option_group = &quot;hc_test_group&quot;;   //构造方法，创建类的时候调用   function hcsem_change_font_style() {      //创建菜单      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );      //使用ajax校验信息      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );      add_action( &apos;init&apos;, array( $this, &apos;hcsem_load_textdomain&apos; ) );   }   function hcsem_load_textdomain() {      //加载 languages 目录下的翻译文件 zh_CN      $currentLocale = get_locale();      if( !empty( $currentLocale ) ) {         $moFile = dirname(__FILE__) . &quot;/languages/{$currentLocale}.mo&quot;;         if( @file_exists( $moFile ) &amp;&amp; is_readable( $moFile ) ) load_textdomain( &apos;hc-test&apos;, $moFile );      }   }   function color_check_action_fun(){      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }      wp_die();   }   function hcsem_description_fun() {      echo &quot;HC的笔记本：&quot; . $_POST[&apos;description&apos;];      wp_die();   }   //使用register_setting()注册要存储的字段   function register_hc_test_setting() {      //注册一个选项，用于装载所有插件设置项      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );      //添加选项设置区域      $setting_section = &quot;hc_test_setting_section&quot;;      add_settings_section(         $setting_section,         &apos;&apos;,         &apos;&apos;,         $this-&gt;option_group      );      //设置字体颜色      add_settings_field(         &apos;hc_test_color&apos;,         __( &apos;color&apos;, &apos;hc-test&apos; ),         array( $this, &apos;hc_test_color_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体大小      add_settings_field(         &apos;hc_test_size&apos;,         __( &apos;size&apos;, &apos;hc-test&apos; ),         array( $this, &apos;hc_test_size_function&apos; ),         $this-&gt;option_group,         $setting_section      );      //设置字体加粗      add_settings_field(         &apos;hc_test_bold&apos;,         __( &apos;bold&apos;, &apos;hc-test&apos; ),         array( $this, &apos;hc_test_bold_function&apos; ),         $this-&gt;option_group,         $setting_section      );   }   function hc_test_bold_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; &lt;? _e( &apos;set bold&apos;, &apos;hc-test&apos; ); ?&gt;      &lt;?   }   function hc_test_size_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $size = $hc_test_option[&quot;size&quot;];      ?&gt;      &lt;select name=&quot;hc_test_option[size]&quot;&gt;         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;      &lt;/select&gt;      &lt;?   }   function hc_test_color_function() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      ?&gt;      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;      &lt;?   }   function hc_create_menu() {      //创建顶级菜单      add_menu_page(         &apos;hc的插件首页&apos;,         &apos;hc的插件&apos;,         &apos;manage_options&apos;,         &apos;hc_test&apos; ,         array( $this, &apos;hc_settings_page&apos; ),         plugins_url( $this-&gt;icon_url, __FILE__ )      );   }   function hc_settings_page() {      ?&gt;      &lt;div class=&quot;wrap&quot;&gt;         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;            &lt;?            //输出一些必要的字段，包括验证信息等            settings_fields( $this-&gt;option_group );            //输出选项设置区域            do_settings_sections( $this-&gt;option_group );            //输出按钮            submit_button();            ?&gt;         &lt;/form&gt;      &lt;/div&gt;      &lt;?   }   function hc_test_head_fun() {      $hc_test_option = get_option( &quot;hc_test_option&quot; );      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?   }}new hcsem_change_font_style();</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythontkinter入门基础</title>
      <link href="/2016/11/10/pythontkinter%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/10/pythontkinter%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>python基础环境</p><pre><code>sudo apt-get install pythonsudo apt-get install python-pip</code></pre><p>Tkinter安装</p><pre><code>sudo apt-get install python-tk</code></pre><p>配置组件外观</p><pre><code>#!/usr/bin/python# -*- coding: UTF-8 -*-from Tkinter import *root = Tk()# 定义图标if sys.platform == &apos;win32&apos;:    root.iconbitmap(&apos;favicon.ico&apos;)else:    icon = PhotoImage(file=&apos;phone.gif&apos;)    root.tk.call(&apos;wm&apos;, &apos;iconphoto&apos;, root._w, icon)# 定义字体，字号，类型label_font = (&apos;Ubuntu&apos;, 20, &apos;bold underline italic&apos;)# 创建组件widget = Label(root, text=&apos;Hello,云克隆&apos;, padx=100, pady=20)# 配置组件字体widget.config(font=label_font)# 组件宽，高widget.config(height=3, width=20)# 组件背景颜色widget.config(bg=&apos;#FF0&apos;)# 组件字体颜色widget.config(fg=&apos;#F0F&apos;)# 组件边框宽度widget.config(bd=3)# 组件边框外形, FLAT扁平, SUNKEN凹陷, RAISED凸起, GROOVE凹槽, SOLID加粗, RIDGE脊状,widget.config(relief=SUNKEN)# 组件鼠标手势, &apos;gumby&apos;, &apos;watch&apos;, &apos;pencil&apos;, &apos;crdss&apos;, hand2widget.config(cursor=&apos;gumby&apos;)# 组件状态, DISABLE禁用, NORMAL正常, READONLY只读widget.config(state=DISABLED)# 布置组件# expand设置是否可以扩展，fill表示随父组件扩展方向，可以设置BOTH, X, Y# 设置组件padding值# side表示按钮布置窗口的位置widget.pack(expand=True, fill=X, padx=10, pady=50, side=LEFT)root.mainloop()</code></pre><h4 id="标准弹出框"><a href="#标准弹出框" class="headerlink" title="标准弹出框"></a>标准弹出框</h4><pre><code># -*- coding: UTF-8 -*-from Tkinter import *from tkMessageBox import *# python3# from Tkinter.messagebox import *def callback():    if askyesno(&apos;Verify&apos;, &apos;Do you ready want to quit?&apos;):        showwarning(&apos;Yes&apos;, &apos;Quit not yet&apos;)    else:        showinfo(&apos;No&apos;, &apos;Quit has been cancelled&apos;)errmsg = &apos;Sorry, no spam allowed&apos;Button(None, text=&apos;Quit&apos;, command=callback).pack(fill=X)Button(None, text=&apos;spam&apos;, command=(lambda: showerror(&apos;spam&apos;, errmsg))).pack(fill=X)mainloop()</code></pre><h4 id="常见弹框"><a href="#常见弹框" class="headerlink" title="常见弹框"></a>常见弹框</h4><pre><code># gui6.py# -*- coding: UTF-8 -*-from Tkinter import *from tkMessageBox import *from tkFileDialog import *from tkColorChooser import *from tkSimpleDialog import *demos = {    &apos;Open&apos;: askopenfilename,    &apos;Color&apos;: askcolor,    &apos;Query&apos;: lambda: askquestion(&apos;Warning&apos;, &apos;You typed &quot;rm *&quot;\nconfirm?&apos;),    &apos;Error&apos;: lambda: showerror(&apos;Error!&apos;, &apos;He is dead&apos;),    &apos;Input&apos;: lambda: askfloat(&apos;Entry&apos;, &apos;Enter credit card number&apos;)}class Demo(Frame):    def __init__(self, parent=None, **options):        Frame.__init__(self, parent, **options)        self.pack()        Label(self, text=&apos;Basic demos&apos;).pack()        for (key, value) in demos.items():            Button(self, text=key, command=value).pack(side=TOP, fill=BOTH)if __name__ == &apos;__main__&apos;:    Demo().mainloop()自定义弹框# -*- coding: UTF-8 -*-import sysfrom Tkinter import *makemodal = (len(sys.argv) &gt; 1)def dialog():    win = Toplevel()    Label(win, text=&apos;Hard drive reformatted!&apos;).pack()    Button(win, text=&apos;OK&apos;, command=win.destroy).pack()    if makemodal:        # 获取输入的焦点        win.focus_set()        # 打开的时候，禁用其他窗口        win.grab_set()        # 在win销毁之前，继续等待        win.wait_window()    print &apos;dialog exit&apos;root = Tk()Button(root, text=&apos;popup&apos;, command=dialog).pack()root.mainloop()</code></pre><h4 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h4><pre><code># -*- coding: UTF-8 -*-from Tkinter import *def showPosEvent(event):    print(&apos;Widget=%s, X=%s, Y=%s&apos; % (event.widget, event.x, event.y))def showAllEvent(event):    print(event)    for attr in dir(event):        if not attr.startswith(&apos;__&apos;):            print(attr, &apos;=&gt;&apos;, getattr(event, attr))def onKeyPress(event):    print(&apos;Got key press: &apos;, event.char)def onArrowKey(event):    print(&apos;Got up arrow key press&apos;)def onReturnKey(event):    print(&apos;Got return key press&apos;)def onLeftClick(event):    print(&apos;Got left mouse button click: &apos;)    showPosEvent(event)def onRightClick(event):    print(&apos;Got right mouse button click: &apos;)    showPosEvent(event)def onMiddleClick(event):    print(&apos;Got middle mouse button click: &apos;)    showPosEvent(event)    showAllEvent(event)def onLeftDrag(event):    print(&apos;Got left mouse drag click: &apos;)    showPosEvent(event)def onDoubleLeftClick(event):    print(&apos;Got double left mouse click: &apos;)    showPosEvent(event)    tkroot.quit()tkroot = Tk()labelfont = (&apos;courier&apos;, 20, &apos;bold&apos;)widget = Label(tkroot, text=&apos;Hello bind world&apos;)widget.config(bg=&apos;red&apos;, font=labelfont)widget.config(height=5, width=20)widget.pack(expand=YES, fill=BOTH)# 绑定单击左键widget.bind(&apos;&lt;Button-1&gt;&apos;, onLeftClick)# 绑定单击右键widget.bind(&apos;&lt;Button-3&gt;&apos;, onRightClick)# 绑定单击中键widget.bind(&apos;&lt;Button-2&gt;&apos;, onMiddleClick)# 绑定双击左键widget.bind(&apos;&lt;Double-1&gt;&apos;, onDoubleLeftClick)# 绑定拖拽 B1表示点击左键，Motion表示拖拽widget.bind(&apos;&lt;B1-Motion&gt;&apos;, onLeftDrag)# 绑定键盘按键widget.bind(&apos;&lt;KeyPress&gt;&apos;, onKeyPress)# 绑定按下箭头键widget.bind(&apos;&lt;Up&gt;&apos;, onArrowKey)# 绑定回车，返回键widget.bind(&apos;&lt;Return&gt;&apos;, onReturnKey)widget.focus()tkroot.title(&apos;CLICK ME&apos;)tkroot.mainloop()# &lt;ButtonPress&gt; 按下按钮# &lt;ButtonRelease&gt; 松开按钮# &lt;Motion&gt; 鼠标指针移动# &lt;Configure&gt; 窗口大小，位置改变时候# &lt;Destroy&gt; 销毁窗口# &lt;FocusIn&gt; 获取焦点# &lt;FocusOut&gt; 失去焦点# &lt;Map&gt; 窗口打开# &lt;Unmap&gt; 窗口最小化# &lt;Escape&gt;, &lt;BackSpace&gt;, &lt;Tab&gt; 捕获特点ESC键，回车键，tab键# &lt;Down&gt;, &lt;Up&gt;, &lt;Left&gt;, &lt;Right&gt; 捕获方向键# &lt;B1-Motion&gt; 按下左键并拖拽# &lt;KeyPress-a&gt; 按下按键“a”，大小写敏感</code></pre><h4 id="输入框"><a href="#输入框" class="headerlink" title="输入框"></a>输入框</h4><pre><code># -*- coding: UTF-8 -*-from Tkinter import *from quitGui import Quitterfields = &apos;Name&apos;, &apos;Job&apos;, &apos;Pay&apos;def fetch(entries):    for entry in entries:        print(&apos;Input =&gt; %s&apos; % entry.get())  # 获取文本信息def makeform(root, fields):    entries = []    for field in fields:        row = Frame(root)        lab = Label(row, width=5, text=field)        ent = Entry(row)        row.pack(side=TOP, fill=X)        lab.pack(side=LEFT)        ent.pack(side=RIGHT, expand=YES, fill=X)        entries.append(ent)    return entriesdef show(entries, popup):    fetch(entries)  # 必须在销毁前取出    popup.destroy()  # 如果修改了stmt， order， msgs会随之失败def ask():    popup = Toplevel()  # 在模拟对话框窗口中显示表单    ents = makeform(popup, fields)    Button(popup, text=&apos;OK&apos;, command=(lambda: show(ents, popup))).pack()    popup.grab_set()  # 打开的时候，禁用其他窗口    popup.focus_set()  # 获取输入的焦点    popup.wait_window()  # 在这里等待销毁if __name__ == &apos;__main__&apos;:    root = Tk()    Button(root, text=&apos;Dialog&apos;, command=ask).pack()    root.mainloop()</code></pre><h4 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h4><pre><code># gui13.py# -*- coding: UTF-8 -*-from Tkinter import *from gui6 import demosfrom quitGui import Quitterclass Demo(Frame):    def __init__(self, parent=None, **options):        Frame.__init__(self, parent, **options)        self.pack()        self.tools()        Label(self, text=&apos;Ckech demos&apos;).pack()        self.vars = []        for key in demos:            var = IntVar()            Checkbutton(self, text=key, variable=var, command=demos[key]).pack(side=LEFT)            self.vars.append(var)    def report(self):        for var in self.vars:            print(var.get())  # 当前开关设置1或者0        print()    def tools(self):        frm = Frame(self)        frm.pack(side=RIGHT)        Button(frm, text=&apos;State&apos;, command=self.report).pack(fill=X)        Quitter(frm).pack(fill=X)if __name__ == &apos;__main__&apos;:    Demo().mainloop()</code></pre><h4 id="单选按钮"><a href="#单选按钮" class="headerlink" title="单选按钮"></a>单选按钮</h4><pre><code>#gui14.py# -*- coding: UTF-8 -*-from Tkinter import *from gui6 import demosfrom quitGui import Quitterclass Demo(Frame):    def __init__(self, parent=None, **options):        Frame.__init__(self, parent, **options)        self.pack()        Label(self, text=&apos;Radio demos&apos;).pack(side=TOP)        self.var = StringVar()        # variable表示单选按钮的变量，相当与html的name标签        # value表示单选按钮的变量值，相当与html的value标签        for key in demos:            Radiobutton(self, text=key, command=self.onPress, variable=self.var, value=key).pack(anchor=NW)        self.var.set(key)  # 选中最后一个开始        Button(self, text=&apos;State&apos;, command=self.report).pack(fill=X)        Quitter(self).pack(fill=X)    def onPress(self):        pick = self.var.get()        print(&apos;you pressed&apos;, pick)        print(&apos;result: &apos;, demos[pick]())  # 按钮使用返回的值    def report(self):        print(self.var.get())if __name__ == &apos;__main__&apos;:    Demo().mainloop()</code></pre><h4 id="标尺滚动条"><a href="#标尺滚动条" class="headerlink" title="标尺滚动条"></a>标尺滚动条</h4><pre><code># gui16.py# -*- coding: UTF-8 -*-from Tkinter import *from gui6 import demosfrom quitGui import Quitterclass Demo(Frame):    def __init__(self, parent=None, **options):        Frame.__init__(self, parent, **options)        self.pack()        Label(self, text=&apos;Scale demos&apos;).pack()        self.var = IntVar()        Scale(self, label=&apos;Pick demo number&apos;,              command=self.onMove, variable=self.var,              from_=0, to=len(demos)-1).pack()        Scale(self, label=&apos;Pick demo number&apos;,  # 标尺的文本              command=self.onMove,  # 绑定回调              variable=self.var,  # 变量              from_=0,   # 标尺最小值              to=len(demos) - 1,   # 标尺最大值              length = 200,  # 长度              tickinterval = 2,   # 每隔几个单位显示标记单位              showvalue = YES,  # 显示或隐藏标尺滑动条旁边的当前值              orient = &apos;horizontal&apos;  # 横向展示              ).pack()        Quitter(self).pack(side=RIGHT)        Button(self, text=&apos;Run demo&apos;, command=self.onRun).pack(side=LEFT)        Button(self, text=&apos;State&apos;, command=self.report).pack(side=RIGHT)    def onMove(self, value):        print(&apos;in onMove&apos;, value)    def onRun(self):        pos = self.var.get()        print(&apos;you picked&apos;, pos)        demo = list(demos.values())[pos]        print(demo())    def report(self):        print(self.var.get())if __name__ == &apos;__main__&apos;:    print(list(demos.keys()))    Demo().mainloop()</code></pre><h4 id="创建图片"><a href="#创建图片" class="headerlink" title="创建图片"></a>创建图片</h4><pre><code># gui17.py# -*- coding: UTF-8 -*-from Tkinter import *gifdir = &apos;./gif/&apos;win = Tk()igm = PhotoImage(file=gifdir + &apos;logo.png&apos;)# 按钮上绑定图片# Button(win, image=igm).pack()# win.mainloop()# 创建画布can = Canvas(win)can.pack(fill=BOTH)can.config(width=igm.width() + 4, height=igm.height() + 4)can.create_image(2,  # x坐标                 2,  # y坐标                 image=igm, anchor=NW)win.mainloop()</code></pre><h3 id="按钮随机读取图片"><a href="#按钮随机读取图片" class="headerlink" title="按钮随机读取图片"></a>按钮随机读取图片</h3><pre><code># gui18.py# -*- coding: UTF-8 -*-from glob import globfrom gui13 import *import randomgifdir = &apos;./gif/&apos;&quot; 按钮随机读取图片 &quot;class ButtonPicsDemo(Frame):    def __init__(self, gifdir=gifdir, parent=None):        Frame.__init__(self, parent)        self.pack()        self.lbl = Label(self, text=&apos;none&apos;, bg=&apos;blue&apos;, fg=&apos;red&apos;)        self.pix = Button(self, text=&apos;press me&apos;, command=self.draw, bg=&apos;white&apos;)        self.lbl.pack(fill=BOTH)        self.pix.pack(pady=10)        Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)        # glob模块， glob方法，返回所有匹配的文件列表        files = glob(gifdir + &apos;*.png&apos;)        self.images = [(x, PhotoImage(file=x)) for x in files]        print(files)    def draw(self):        name, photo = random.choice(self.images)        self.lbl.config(text=name)        self.pix.config(image=photo)if __name__ == &apos;__main__&apos;:    if __name__ == &apos;__main__&apos;:        ButtonPicsDemo().mainloop()</code></pre><h4 id="缩略图"><a href="#缩略图" class="headerlink" title="缩略图"></a>缩略图</h4><pre><code># gui19.py# -*- coding: UTF-8 -*-import osimport mathimport PILfrom PIL import Imagefrom Tkinter import *def make_thumbs(img_dir, size=(100, 100), subdir=&apos;thumbs&apos;):    thumb_dir = os.path.join(img_dir, subdir)    if not os.path.exists(thumb_dir):        os.mkdir(thumb_dir)    thumbs = []    for img_file in os.listdir(img_dir):        thumb_path = os.path.join(thumb_dir, img_file)        if os.path.exists(thumb_path):            thumb_obj = PIL.Image.open(thumb_path)            thumbs.append((img_file, thumb_obj))        else:            print(&apos;making&apos;, thumb_path)            img_path = os.path.join(img_dir, img_file)            try:                img_obj = PIL.Image.open(img_path)                img_obj.thumbnail(size, PIL.Image.ANTIALIAS)                img_obj.save(thumb_path)                thumbs.append((img_file, img_obj))            except Exception, e:                print(&apos;skipping: &apos;, img_path)                print e    return thumbsclass ViewOne(Toplevel):    def __init__(self, img_dir, img_file):        Toplevel.__init__(self)        self.title(img_file)        img_path = os.path.join(img_dir, img_file)        img_obj = PhotoImage(file=img_path)        Label(self, image=img_obj).pack()        print(img_path, img_obj.width(), img_obj.height())        self.savephoto = img_objdef viewer(img_dir, kind=Toplevel, cols=None):    win = kind()    win.title(&apos;VIEWER: &apos; + img_dir)    thumbs = make_thumbs(img_dir)    if not cols:        # 固定大小 或者N×N        cols = int(math.ceil(math.sqrt(len(thumbs))))    savephotos = []    while thumbs:        thumbs_row, thumbs = thumbs[:cols], thumbs[cols:]        row = Frame(win)        row.pack(fill=BOTH)        for(img_file, img_obj) in thumbs_row:            size = max(img_obj.size)            photo = PhotoImage(file=os.path.join(img_dir, &apos;thumbs&apos;, img_file))            link = Button(row, image=photo)        handler = lambda savefile=img_file: ViewOne(img_dir, savefile)        link.config(command=handler, width=size, height=size)        link.pack(side=LEFT, expand=YES)        savephotos.append(photo)    Button(win, text=&apos;Quit&apos;, command=win.quit, bg=&apos;beige&apos;).pack(fill=X)    return win, savephotosif __name__ == &apos;__main__&apos;:    img_dir = len(sys.argv) &gt; 1 and sys.argv[1] or &apos;gif&apos;    main, save = viewer(img_dir, kind=Tk)    main.mainloop()</code></pre><h3 id="创建基础顶级菜单"><a href="#创建基础顶级菜单" class="headerlink" title="创建基础顶级菜单"></a>创建基础顶级菜单</h3><pre><code># gui20.py# -*- coding: UTF-8 -*-from Tkinter import *from tkMessageBox import *def not_done():    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)def make_menu(win):    top = Menu(win)  # 定义顶级菜单    win.config(menu=top)    file = Menu(top, tearoff=True)  # 一级菜单 tearoff:设置菜单下的虚线是否显示    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)    file.add_command(label=&apos;Quit...&apos;, command=win.quit,  underline=0)    top.add_cascade(label=&apos;File&apos;, menu=file, underline=0)  # 在顶级菜单中添加一级菜单    edit = Menu(top, tearoff=False)  # 一级菜单    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)    edit.add_separator()  # 添加下划线    top.add_cascade(label=&apos;Edit&apos;, menu=edit, underline=0)    submenu = Menu(edit, tearoff=True)  # 二级菜单    submenu.add_command(label=&apos;Spam&apos;, command=win.quit, underline=0)    submenu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)    edit.add_cascade(label=&apos;Stuff&apos;, menu=submenu, underline=0)  # 在一级菜单中添加二级菜单if __name__ == &apos;__main__&apos;:    root = Tk()    root.title(&apos;menu_win&apos;)    make_menu(root)    msg = Label(root, text=&apos;Window menu basic&apos;)    msg.pack(expand=YES, fill=BOTH)    msg.config(relief=SUNKEN, width=40, height=7, bg=&apos;beige&apos;)    root.mainloop()</code></pre><h4 id="创建框架级别菜单"><a href="#创建框架级别菜单" class="headerlink" title="创建框架级别菜单"></a>创建框架级别菜单</h4><pre><code># gui21.py# -*- coding: UTF-8 -*-from Tkinter import *from tkMessageBox import *def not_done():    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)def make_menu(parent):    menu_bar = Frame(parent)    menu_bar.pack(side=TOP, fill=X)    f_button = Menubutton(menu_bar, text=&apos;File&apos;, underline=0)    f_button.pack(side=LEFT)    file = Menu(f_button)    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)    file.add_command(label=&apos;Quit...&apos;, command=parent.quit,  underline=0)    f_button.config(menu=file)    e_button = Menubutton(menu_bar, text=&apos;Edit&apos;, underline=0)    e_button.pack(side=LEFT)    edit = Menu(e_button)    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)    edit.add_separator()    e_button.config(menu=edit)    sub_menu = Menu(edit, tearoff=True)    sub_menu.add_command(label=&apos;Spam&apos;, command=parent.quit, underline=0)    sub_menu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)    edit.add_cascade(label=&apos;Stuff&apos;, menu=sub_menu, underline=0)    return menu_barif __name__ == &apos;__main__&apos;:    root = Tk()    root.title(&apos;menu_fra&apos;)    for i in range(2):        mnu = make_menu(root)        mnu.config(bd=2, relief=RAISED)        Label(root, bg=&apos;black&apos;, height=5, width=25).pack(expand=YES, fill=BOTH)    Button(root, text=&apos;Bye&apos;, command=root.quit).pack()    root.mainloop()</code></pre><h4 id="图片菜单"><a href="#图片菜单" class="headerlink" title="图片菜单"></a>图片菜单</h4><pre><code># gui22.py# -*- coding:UTF-8 -*-from Tkinter import *from tkMessageBox import *class NewMenuDemo(Frame):    def __init__(self, parent=None):        Frame.__init__(self, parent)        self.pack(expand=YES, fill=BOTH)        self.create_widgets()    def create_widgets(self):        self.make_menubar()        self.make_toolbar()        l = Label(self, text=&apos;Menu and Toolbar Demo&apos;)        l.config(relief=SUNKEN, width=40, height=10, bg=&apos;white&apos;)        l.pack(expand=YES, fill=BOTH)    def make_toolbar(self, size=(30, 30)):        toolbar = Frame(self, cursor=&apos;hand2&apos;, relief=SUNKEN, bd=2)        toolbar.pack(side=BOTTOM, fill=X)        Button(toolbar, text=&apos;Quit&apos;, command=self.quit).pack(side=RIGHT)        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)        self.tool_photo_objs = []        for file in photo_files:            img = PhotoImage(file=&apos;./gif/thumbs/&apos; + file)            btn = Button(toolbar, image=img, command=self.greeting)            btn.config(bd=5, relief=RIDGE)            btn.config(width=size[0], height=size[0])            btn.pack(side=LEFT)            self.tool_photo_objs.append(img)        Button(toolbar, text=&apos;Hello&apos;, command=self.greeting).pack(side=LEFT)    def make_menubar(self):        self.menubar = Menu(self.master)        self.master.config(menu=self.menubar)        self.file_menu()        self.edit_menu()        self.image_menu()    def file_menu(self):        pulldown = Menu(self.menubar)        pulldown.add_command(label=&apos;OPEN...&apos;, command=self.notdone)        pulldown.add_command(label=&apos;QUIT&apos;, command=self.quit)        self.menubar.add_cascade(label=&apos;FILE&apos;, underline=0, menu=pulldown)    def edit_menu(self):        pulldown = Menu(self.menubar)        pulldown.add_command(label=&apos;PASTE&apos;, command=self.notdone)        pulldown.add_command(label=&apos;SPAM&apos;, command=self.greeting)        pulldown.add_separator()        pulldown.add_command(label=&apos;DELETE&apos;, command=self.greeting)        pulldown.entryconfig(4, state=DISABLED)        self.menubar.add_cascade(label=&apos;EDIT&apos;, underline=0, menu=pulldown)    def image_menu(self):        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)        pulldown = Menu(self.menubar)        self.photo_objs = []        for file in photo_files:            img = PhotoImage(file=&apos;./gif/&apos; + file)            pulldown.add_command(image=img, command=self.notdone)            self.photo_objs.append(img)        self.menubar.add_cascade(label=&apos;IMAGE&apos;, underline=0, menu=pulldown)    def greeting(self):        showinfo(&apos;greeting&apos;, &apos;GREETING&apos;)    def notdone(self):        showerror(&apos;NOT DONE&apos;, &apos;NOT DONE&apos;)    def quit(self):        if askyesno(&apos;Verify quit&apos;, &apos;Sure?&apos;):            Frame.quit(self)if __name__ == &apos;__main__&apos;:    NewMenuDemo().mainloop()</code></pre><h4 id="滚动条与列表"><a href="#滚动条与列表" class="headerlink" title="滚动条与列表"></a>滚动条与列表</h4><pre><code># gui23.py# -*- coding: UTF-8 -*-from Tkinter import *class ScrolledList(Frame):    def __init__(self, options, parent=None):        Frame.__init__(self, parent)        self.pack(expand=YES, fill=BOTH)        self.makeWidgets(options)    def handle_list(self, event):        index = self.listbox.curselection()  # 鼠标选中的行        label = self.listbox.get(index)  # 获取鼠标选中的值        self.runCommand(label)  # 打印出值    def makeWidgets(self, options):        # sbar = Scrollbar(self, orient=&apos;horizontal&apos;)  # 横向滚动        sbar = Scrollbar(self)        list = Listbox(self, relief=SUNKEN)        sbar.config(command=list.yview)  # 移动滚动条启用回调： 按比例调节列表框的显示，        list.config(yscrollcommand=sbar.set)  # 移动列表框启用回调：按比例调节滚动条        sbar.pack(side=RIGHT, fill=Y)        list.pack(side=LEFT, expand=YES, fill=BOTH)        pos = 0        for label in options:            list.insert(pos, label)            pos += 1        # selectmode 选择模式SINGLE(单选), BROWSE(默认单选), MULTIPLE(多选), EXTENDED(多选)        # 启用多选时， curselection返回列表        # 启用单选时， curselection返回字符串        list.config(selectmode=EXTENDED, setgrid=1)        list.bind(&apos;&lt;Double-1&gt;&apos;, self.handle_list)        self.listbox = list    def runCommand(self, selection):        print(&apos;YOU SELECTED:&apos;, selection)if __name__ == &apos;__main__&apos;:    options = ((&apos;Lumberjack-%s&apos; % x) for x in range(20))    ScrolledList(options).mainloop()</code></pre><h4 id="TEXT组件"><a href="#TEXT组件" class="headerlink" title="TEXT组件"></a>TEXT组件</h4><pre><code>gui24.py# -*- coding: UTF-8 -*-from Tkinter import *class ScrollText(Frame):    def __init__(self, parent=None, text=&apos;&apos;, file=None):        Frame.__init__(self, parent)        self.pack(expand=YES, fill=BOTH)        self.make_widgets()        self.set_text(text, file)    def make_widgets(self):        sbar = Scrollbar(self)        text = Text(self, relief=SUNKEN)        sbar.config(command=text.yview)        text.config(yscrollcommand=sbar.set)        sbar.pack(side=RIGHT, fill=Y)        text.pack(side=LEFT, expand=YES, fill=BOTH)        self.text = text    def set_text(self, text=&apos;&apos;, file=None):        if file:            text = open(file, &apos;r&apos;).read()        # 1.0表示第一行，第0列（行从1开始，列从0开始）        # END表示最末一个字符后面第一个位置        self.text.delete(&apos;1.0&apos;, END)  # 删除从第一行第0列开始到最后的字符串，即删除全部        self.text.insert(&apos;1.0&apos;, text)  # 从第一行第0列开始填充数据        # mark_set 设置text标志        self.text.mark_set(INSERT, &apos;1.0&apos;)  # 设置将光标设置在文本开始位置        # self.text.mark_set(&apos;line_two&apos;, &apos;2.2&apos;)  # 自定义标志位置 可以用mark_unset取消        self.text.focus()        # TEXT的tag标签        # SEL是内置的标签，表示当前选中的文本        # text = self.text.get(SEL_FIRST, SEL_LAST)        # text = self.text.get(&apos;sel.first&apos;, &apos;sel.last&apos;)        # self.text.tag_add(&apos;alltext&apos;, &apos;1.0&apos;, END)  # 选中所有文本        # self.text.tag_add(SEL, index1, index2)  # 将一定范围内的文本添加到内建的SEL标签        # self.text.tag_remove(SEL, &apos;1.0&apos;, END)  # 将字符串所有字符从SEL标签中删除        # self.text.tag_delete(SEL)  # 删除SEL标签        # self.text.tag_add(&apos;demo&apos;, &apos;1.5&apos;, &apos;1.7&apos;)        # self.text.tag_add(&apos;demo&apos;, &apos;3.0&apos;, &apos;5.7&apos;)        # self.text.tag_config(&apos;demo&apos;, background=&apos;purple&apos;)        # self.text.tag_config(&apos;demo&apos;, fontground=&apos;white&apos;)        # self.text.tag_config(&apos;demo&apos;, font=(&apos;times&apos;, 16, &apos;underline&apos;))        # self.text.tag_bind(&apos;demo&apos;, &apos;&lt;Double-1&gt;&apos;, func)        # see方法        # self.text.see(&apos;1.0&apos;)  # 滚动到第一行第0列        # self.text.see(INSERT)  # 滚动到光标插入处        # self.text.see(SEL_FIRST)  # 滚动到选中文本第一个字符串    def get_text(self):        # -1c 表示往回数一个字符串        # +1l 表示往前数一行        return self.text.get(&apos;1.0&apos;, END + &apos;-1c&apos;)if __name__ == &apos;__main__&apos;:    root = Tk()    if len(sys.argv) &gt; 1:        st = ScrollText(file=sys.argv[1])    else:        st = ScrollText(text=&apos;Words\ngo here&apos;)    def show(event):        print(repr(st.get_text()))    root.bind(&apos;&lt;Key-Escape&gt;&apos;, show)    root.mainloop()</code></pre><h4 id="简单的文本编辑器"><a href="#简单的文本编辑器" class="headerlink" title="简单的文本编辑器"></a>简单的文本编辑器</h4><pre><code># gui25.py# -*- coding: UTF-8 -*-from Tkinter import *from tkSimpleDialog import askstringfrom tkFileDialog import asksaveasfilenamefrom quitGui import Quitterfrom gui24 import ScrollTextclass SimpleEditor(ScrollText):    def __init__(self, parent=None, file=None):        frm = Frame(parent)        frm.pack(fill=X)        Button(frm, text=&apos;Save&apos;, command=self.on_save).pack(side=LEFT)        Button(frm, text=&apos;Cut&apos;, command=self.on_cut).pack(side=LEFT)        Button(frm, text=&apos;Paste&apos;, command=self.on_paste).pack(side=LEFT)        Button(frm, text=&apos;Find&apos;, command=self.on_find).pack(side=LEFT)        Quitter(frm).pack(side=LEFT)        ScrollText.__init__(self, parent, file=file)        self.text.config(font=(&apos;courier&apos;, 9, &apos;normal&apos;))    def on_save(self):        filename = asksaveasfilename()        if filename:            alltext = self.get_text()            open(filename, &apos;w&apos;).write(alltext)    def on_cut(self):        text = self.text.get(SEL_FIRST, SEL_LAST)        self.text.delete(SEL_FIRST, SEL_LAST)        self.clipboard_clear()        self.clipboard_append(text)    def on_paste(self):        try:            text = self.selection_get(selection=&apos;CLIPBOARD&apos;)            self.text.insert(INSERT, text)        except TclError:            pass    def on_find(self):        target = askstring(&apos;SimpleEdit&apos;, &apos;Search string?&apos;)        if target:            where = self.text.search(target, INSERT, END)            if where:                print(where)                pastit = where + (&apos;+%dc&apos; % len(target))                self.text.tag_remove(SEL, &apos;1.0&apos;, END)                self.text.tag_add(SEL, where, pastit)                self.text.mark_set(INSERT, pastit)                self.text.see(INSERT)                self.text.focus()if __name__ == &apos;__main__&apos;:    if len(sys.argv) &gt; 1:        SimpleEditor(file=sys.argv[1]).mainloop()    else:        SimpleEditor().mainloop()</code></pre><h4 id="创建基础画布"><a href="#创建基础画布" class="headerlink" title="创建基础画布"></a>创建基础画布</h4><pre><code># gui26.py# -*- coding: UTF-8 -*-from Tkinter import *canvas = Canvas(width=525, height=300, bg=&apos;white&apos;)canvas.pack(expand=YES, fill=BOTH)canvas.create_line(100, 100, 200, 200)canvas.create_line(100, 200, 200, 300)for i in range(1, 20, 2):    canvas.create_line(0, i, 50, i)canvas.create_oval(20, 20, 300, 100, width=10, fill=&apos;yellow&apos;)d = {1:PIESLICE,2:CHORD,3:ARC}for i in d:    canvas.create_arc(        (10,10 + 60*i,110,110 + 60*i),        style=d[i],   #指定样式        start=30,     #指定起始角度        extent=30     #指定角度偏移量        )canvas.create_arc(0, 0, 100, 200, fill=&apos;black&apos;)canvas.create_rectangle(200, 200, 300, 300, width=5, fill=&apos;red&apos;)canvas.create_line(0, 300, 150, 150, width=10, fill=&apos;green&apos;)photo = PhotoImage(file=&apos;./gif/lightmachine.png&apos;)canvas.create_image(325,25, image=photo, anchor=NW)widget = Label(canvas, text=&apos;Spam&apos;, fg=&apos;white&apos;, bg=&apos;black&apos;)widget.pack()canvas.create_window(100, 100, window=widget)canvas.create_text(100, 280, text=&apos;CLOUD CLONE CORP.&apos;)# id = canvas.create_line(fromX, fromY, toX, toY)  # 创建直线# id = canvas.create_oval(fromX, fromY, toX, toY) # 创建椭圆# id = canvas.create_arc(fromX, fromY, toX, toY)  # 创建扇形# id =canvas.create_rectangle(fromX, fromY, toX, toY)  # 创建矩形# canvas.move(id, offsetX, offsetY)  # 移动对象# canvas.delete(id)  # 删除对象# canvas.tkraise(id)  # 将对象移动到前端# canvas.lower(id)  # 将对象移动到底部# canvas.itemconfig(id, fill=&apos;red&apos;)  # 修改对象属性# 画布标签# canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) # canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) # id = canvas.create_line(fromX, fromY, toX, toY)# canvas.addtag_withtag(&apos;bubbles&apos;, id)# canvas.move(&apos;bubbles&apos;, diffX, diffY)mainloop()</code></pre><h4 id="canvas与滚动条"><a href="#canvas与滚动条" class="headerlink" title="canvas与滚动条"></a>canvas与滚动条</h4><pre><code># gui27.py# -*- coding: UTF-8 -*-from Tkinter import *class ScrolledCanvas(Frame):    def __init__(self, parent=None, color=&apos;brown&apos;):        Frame.__init__(self, parent)        self.pack(expand=YES, fill=BOTH)        canv = Canvas(self, bg=color, relief=SUNKEN)        canv.config(width=300, height=200)        canv.config(scrollregion=(0, 0, 300, 1000))        canv.config(highlightthickness=0)        sbar = Scrollbar(self)        sbar.config(command=canv.yview)        canv.config(yscrollcommand=sbar.set)        sbar.pack(side=RIGHT, fill=Y)        canv.pack(side=LEFT, expand=YES, fill=BOTH)        self.fillContent(canv)        canv.bind(&apos;&lt;Double-1&gt;&apos;, self.onDoubleClick)        self.canvas = canv    def fillContent(self, canv):        for i in range(10):            canv.create_text(150, 50+(i*100), text=&apos;spam&apos;+str(i), fill=&apos;beige&apos;)    def onDoubleClick(self, event):        print(event.x, event.y)        print(self.canvas.canvasx(event.x), self.canvas.canvasy(event.y))if __name__ == &apos;__main__&apos;:    ScrolledCanvas().mainloop()</code></pre><h4 id="canvas绑定事件"><a href="#canvas绑定事件" class="headerlink" title="canvas绑定事件"></a>canvas绑定事件</h4><pre><code># gui28.py# -*- coding: UTF-8 -*-from Tkinter import *trace = Falseclass CanvasEventDemo:    def __init__(self, parent=None):        canvas = Canvas(width=300, height=300, bg=&apos;beige&apos;)        canvas.pack()        canvas.bind(&apos;&lt;ButtonPress-1&gt;&apos;, self.on_start)        canvas.bind(&apos;&lt;B1-Motion&gt;&apos;, self.on_grow)        canvas.bind(&apos;&lt;Double-1&gt;&apos;, self.on_clear)        canvas.bind(&apos;&lt;ButtonPress-3&gt;&apos;, self.on_move)        self.canvas = canvas        self.drawn = None        self.kinds = [canvas.create_oval, canvas.create_rectangle]    def on_start(self, event):        self.shape =self.kinds[0]        self.kinds = self.kinds[1:] + self.kinds[:1]        self.start = event        self.drawn = None    def on_grow(self, event):        canvas = event.widget        if self.drawn:            canvas.delete(self.drawn)        object_id = self.shape(self.start.x, self.start.y, event.x, event.y)        if trace:            print(object_id)        self.drawn = object_id    def on_clear(self, event):        event.widget.delete(&apos;all&apos;)    def on_move(self, event):        if self.drawn:            if trace:                print(self.drawn)            canvas = event.widget            diffx, diffy = (event.x - self.start.x), (event.y - self.start.y)            canvas.move(self.drawn, diffx, diffy)            self.start = eventif __name__ == &apos;__main__&apos;:    CanvasEventDemo()    mainloop()</code></pre><h4 id="grid布局和pack布局实现自动扩展"><a href="#grid布局和pack布局实现自动扩展" class="headerlink" title="grid布局和pack布局实现自动扩展"></a>grid布局和pack布局实现自动扩展</h4><pre><code># gui29.py# -*- coding: UTF-8 -*-from Tkinter import *colors = [&apos;red&apos;, &apos;green&apos;, &apos;orange&apos;, &apos;white&apos;, &apos;yellow&apos;, &apos;blue&apos;]def gridbox(root):    Label(root, text=&apos;GRID&apos;).grid(columnspan=2)  # 跨两列    row = 1    for color in colors:        lab = Label(root, text=color, relief=RIDGE, width=25)        ent = Entry(root, bg=color, relief=SUNKEN, width=50)        lab.grid(row=row, column=0, sticky=NSEW)  # 向4个方向扩展        ent.grid(row=row, column=1, sticky=NSEW)        root.rowconfigure(row, weight=1)  # 循环行自动扩展        row += 1    root.columnconfigure(0, weight=1)  # 第一列自动扩展    root.columnconfigure(1, weight=1)  # 第二列自动扩展def packbox(root):    Label(root, text=&apos;PACK&apos;).pack()    for color in colors:        row = Frame(root)        lab = Label(row, text=color, relief=RIDGE, width=25)        ent = Entry(row, bg=color, relief=SUNKEN, width=50)        row.pack(side=TOP, expand=YES, fill=BOTH)        lab.pack(side=LEFT, expand=YES, fill=BOTH)        ent.pack(side=RIGHT, expand=YES, fill=BOTH)if __name__ == &apos;__main__&apos;:    root = Tk()    gridbox(Toplevel(root))    packbox(Toplevel(root))    Button(root, text=&apos;Quit&apos;, command=root.quit).pack()    mainloop()</code></pre><h3 id="PIL：Python-Imaging-Library"><a href="#PIL：Python-Imaging-Library" class="headerlink" title="PIL：Python Imaging Library"></a>PIL：Python Imaging Library</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre><code>sudo apt-get install python-imaging或者sudo easy_install PIL</code></pre><p>window系统选择</p><pre><code>pip install Pillow</code></pre><p>图像操作</p><pre><code>import Image# 打开一个jpg图像文件，注意路径要改成你自己的:im = Image.open(&apos;/Users/michael/test.jpg&apos;)# 获得图像尺寸:w, h = im.size# 缩放到50%:im.thumbnail((w//2, h//2))# 把缩放后的图像用jpeg格式保存:im.save(&apos;/Users/michael/thumbnail.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>模糊效果</p><pre><code>import Image, ImageFilterim = Image.open(&apos;/Users/hanchang/test.jpg&apos;)im2 = im.filter(ImageFilter.BLUR)im2.save(&apos;/Users/hanchang/blur.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>自定义图像验证码</p><pre><code>import Image, ImageDraw, ImageFont, ImageFilterimport random# 随机字母:def rndChar():    return chr(random.randint(65, 90))# 随机颜色1:def rndColor():    return (random.randint(64, 255), random.randint(64, 255), random.randint(64, 255))# 随机颜色2:def rndColor2():    return (random.randint(32, 127), random.randint(32, 127), random.randint(32, 127))# 240 x 60:width = 60 * 4height = 60image = Image.new(&apos;RGB&apos;, (width, height), (255, 255, 255))# 创建Font对象:font = ImageFont.truetype(&apos;Arial.ttf&apos;, 36)# 创建Draw对象:draw = ImageDraw.Draw(image)# 填充每个像素:for x in range(width):    for y in range(height):        draw.point((x, y), fill=rndColor())# 输出文字:for t in range(4):    draw.text((60 * t + 10, 10), rndChar(), font=font, fill=rndColor2())# 模糊:image = image.filter(ImageFilter.BLUR)image.save(&apos;code.jpg&apos;, &apos;jpeg&apos;);自定义字符串生成图片</code></pre><p><code>from PIL import Image,ImageDraw,ImageFont,ImageOps &lt;h1&gt;生成图片&lt;/h1&gt; def create\_image(str, line, name, dir): img\_size = (400, (line*20) + 10) img\_mode = &#39;RGB&#39; img\_font = ImageFont.truetype(&#39;UbuntuMono-R.ttf&#39;, 14) img\_bg = &#39;#FFF&#39; img\_fg = &#39;#000&#39; img = Image.new(mode=img\_mode, size=img\_size, color=img\_bg) draw = ImageDraw.Draw(img) draw.text((10, 10), str, fill=img\_fg, font=img_font) img.save( dir + name + &#39;.png&#39;, &#39;png&#39;)</code></p>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu14.04服务器基础配置</title>
      <link href="/2016/11/10/ubuntu14.04%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/"/>
      <url>/2016/11/10/ubuntu14.04%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="登陆ssh"><a href="#登陆ssh" class="headerlink" title="登陆ssh"></a>登陆ssh</h4><pre><code>ssh root@ipaddress password:</code></pre><h4 id="首次登陆出现的错误"><a href="#首次登陆出现的错误" class="headerlink" title="首次登陆出现的错误"></a>首次登陆出现的错误</h4><pre><code>perl: warning: Setting locale failed.perl: warning: Please check that your locale settings:# 安装 localepurge 管理语言文件sudo apt-get install localepurge# 或者之后自行配置sudo dpkg-reconfigure localepurge# 生成自己需要的语言sudo locale-gen zh_CN.UTF-8 en_US.UTF-8# 打印结果locale# ssh连接时候指定语言LC_ALL=en_US.UTF-8 ssh &lt;host&gt;</code></pre><h4 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h4><pre><code>adduser hanchangpassword:retry password:</code></pre><h4 id="将用户添加到sudo用户组"><a href="#将用户添加到sudo用户组" class="headerlink" title="将用户添加到sudo用户组"></a>将用户添加到sudo用户组</h4><p>错误提示</p><pre><code>username is not in the sudoers file.su -password：chmod u+w /etc/sudoers   # 添加文件写权限root ALL=(ALL) ALL 下面添加以下代码hanchang ALL=(ALL) NOPASSWD: ALL:wq 退出chmod u-w /etc/sudoers  # 取消文件写权限</code></pre><p>修改root密码</p><pre><code>sudo passwdpassword:retry password:</code></pre><h4 id="禁止root用户远程登陆ssh"><a href="#禁止root用户远程登陆ssh" class="headerlink" title="禁止root用户远程登陆ssh"></a>禁止root用户远程登陆ssh</h4><pre><code>cd /e   tc/ssh/sudo vim sshd_configPermitRootLogin yes改成PermitRootLogin noservice sshd restart    或者 /etc/init.d/sshd restart（ssh服务器重启）</code></pre><h4 id="指定IP地址登陆"><a href="#指定IP地址登陆" class="headerlink" title="指定IP地址登陆"></a>指定IP地址登陆</h4><pre><code>vim  /etc/hosts.allowsshd:192.168.220.164:allow  # 最后添加vim /etc/hosts.denysshd:ALL #最后添加</code></pre><h4 id="避免sshd连接超时"><a href="#避免sshd连接超时" class="headerlink" title="避免sshd连接超时"></a>避免sshd连接超时</h4><p>修改客户端</p><pre><code>sudo vim /etc/ssh/ssh_config# 添加ServerAliveInterval 30   # 每30秒向服务器发起心跳ServerAliveCountMax 6 # 允许6次无响应</code></pre><p>或者修改服务器端</p><pre><code># 打开sudo vim /etc/ssh/sshd_config# 添加ClientAliveInterval 30ClientAliveCountMax 6</code></pre><h4 id="流量监控"><a href="#流量监控" class="headerlink" title="流量监控"></a>流量监控</h4><pre><code># 安装监控软件sudo apt-get install vnstat# 安装好后运行以下命令初始化数据库# eth0可以通过ifconfig查看sudo vnstat -u -i eth1# 修改配置文件sudo vim /etc/vnstat.confInterface &quot;eth1&quot; #此处修改需要监控的网卡# 启动守护进程sudo /etc/init.d/vnstat start# 默认开机启动sudo update-rc.d vnstat enable</code></pre><h4 id="查看是否安装iptables"><a href="#查看是否安装iptables" class="headerlink" title="查看是否安装iptables"></a>查看是否安装iptables</h4><pre><code>iptables: /sbin/iptables /usr/share/iptables /usr/share/man/man8/iptables.8.gz #表示已经安装iptablesapt-get install iptables #如果默认没有安装，请运行此命令安装防火墙</code></pre><p>编辑iptables配置文件</p><pre><code>sudo vi /etc/iptables.rules*filter:INPUT DROP [0:0]:FORWARD ACCEPT [0:0]:OUTPUT ACCEPT [0:0]:syn-flood - [0:0]-A INPUT -i lo -j ACCEPT-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT-A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT-A INPUT -p icmp -m limit --limit 1/s --limit-burst 10 -j ACCEPT-A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood-A INPUT -j REJECT --reject-with icmp-host-prohibited-A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN-A syn-flood -j REJECT --reject-with icmp-port-unreachableCOMMIT# sudo iptables-restore &lt; /etc/iptables.rules #使防火墙规则生效，重启主机执行此命令# 重启主机会使以上配置失效，以下内容为如何配置开机自动启动防火墙# vi /etc/network/if-pre-up.d/iptables #创建文件，添加以下内容，使防火墙开机启动#!/bin/bashiptables-restore &lt; /etc/iptables.rules# chmod +x /etc/network/if-pre-up.d/iptables #添加执行权限# sudo iptables -L -n查看规则是否生效.</code></pre><h4 id="挂载新的硬盘"><a href="#挂载新的硬盘" class="headerlink" title="挂载新的硬盘"></a>挂载新的硬盘</h4><pre><code>fdisk -l如果出现Disk /dev/sdb doesn&apos;t contain a valid partition table说明没有分区,需要处理fdisk /dev/sdbCommand (m for help):  m为查看选项，这里我们输入n表示创建一个新的分区选中默认，在分区大小中填写分区大小 +500G</code></pre><p>第二步：使新创建的分区在系统中立即生效 root#partprobe 第三步：格式化新创建的分区</p><pre><code>mkfs.ext3 /dev/hdb1</code></pre><p>第四步：使新创建的分区挂载/mnt/ssd_one 目录下</p><pre><code>mount /dev/hda1 /mnt/rhce01</code></pre><p>查看已经挂载的信息</p><pre><code>sudo vim /etc/mtab</code></pre><p>第五步：开机自动挂载</p><pre><code>sudo vim /etc/fstab# 底部添加/dev/sdb1              /mnt/hdd_one              ext3    defaults        0 0</code></pre><p>查看现在的硬盘信息</p><pre><code>root@m1095:~# df -hlFilesystem      Size  Used Avail Use% Mounted onudev             12G  4.0K   12G   1% /devtmpfs           2.4G  632K  2.4G   1% /run/dev/sda2        71G  1.2G   66G   2% /none            4.0K     0  4.0K   0% /sys/fs/cgroupnone            5.0M     0  5.0M   0% /run/locknone             12G     0   12G   0% /run/shmnone            100M     0  100M   0% /run/user/dev/sda1       226M   35M  175M  17% /boot/dev/sdb1       493G   70M  467G   1% /mnt/hdd_one</code></pre><h4 id="ftp服务器搭建"><a href="#ftp服务器搭建" class="headerlink" title="ftp服务器搭建"></a>ftp服务器搭建</h4><pre><code>sudo apt-get install vsftpd</code></pre><p>编辑配置文件</p><pre><code>sudo vim /etc/vsftpd.confanonymous_enable=NO   # 禁止匿名用户local_enable=YES   # 允许本地用户write_enable=YES # 允许写入chroot_local_user=YES  # 登陆用户被限制在自己的home目录下allow_writeable_chroot=YES # 配合chroot_local_user=YES使用# 当chroot_local_user=YES表示chroot_list为可以访问其他目录的用户# 当chroot_local_user=NO表示chroot_list为不可以访问其他目录的用户，# chroot_list_enable=YES  # chroot_list_file=/etc/vsftpd.chroot_list# 以下内容为添加内容# 设置为YES表示开启用户登陆过滤，设置为NO表示不开启用户过滤，所有用户都可以访问userlist_enable=YES# 在userlist_enable=YES的前提下，设置是否阻扯user_list文件中的用户登录FTP服务器# YES表示user_list为黑名单，在文件中的用户不能访问，不在文件中的用户可以访问# NO表示user_list 为白名单，在文件中的用户可以访问，不在文件中的用户不能访问userlist_deny=YESsudo vim /etc/vsftpd.user_list添加root到文件中</code></pre><p>出现500 OOPS: vsftpd: refusing to run with writable root inside chroot()错误的时候 原因：chroot设置为yes的时候，需要取消ftp根目录的写权限</p><pre><code>#### 在配置文件中添加此设置allow_writeable_chroot=YES </code></pre><h4 id="开启防火墙后vsftpd连接错误处理"><a href="#开启防火墙后vsftpd连接错误处理" class="headerlink" title="开启防火墙后vsftpd连接错误处理"></a>开启防火墙后vsftpd连接错误处理</h4><p>载入以下2个模块</p><pre><code>sudo modprobe ip_nat_ftpsudo modprobe ip_conntrack_ftpsudo vi /etc/modules# Add these lines:ip_nat_ftpip_conntrack_ftp</code></pre><p>重启vsftpd服务</p><h4 id="安装lamp服务"><a href="#安装lamp服务" class="headerlink" title="安装lamp服务"></a>安装lamp服务</h4><p>安装apache</p><pre><code>sudo apt-get install apache2# 将用户添加到apache用户组中sudo usermod -a -G www-data username # www-data 为apache用户组名，username为登陆用户名# apache2安装rewritesudo a2enmod rewritesudo service apache2 restart# 删除显示的版本信息ServerTokens ProdServerSignature Off </code></pre><p>配置虚拟主机</p><pre><code>sudo vim /etc/apache.2/apache2.conf# 添加以下内容&lt;Directory /home/zhc/www/&gt;        Options FollowSymLinks　#　不要加Index        AllowOverride All        Require all granted&lt;/Directory&gt;</code></pre><p>安装mysql</p><pre><code>sudo apt-get install mysql-server php5-mysql＃配置mysqlsudo mysql_secure_installation</code></pre><p>查看mysql是否开启慢查询日志</p><pre><code>mysql&gt; show variables like &apos;%slow%&apos;;+---------------------------+---------------------------------------+| Variable_name             | Value                                 |+---------------------------+---------------------------------------+| log_slow_admin_statements | OFF                                   || log_slow_slave_statements | OFF                                   || slow_launch_time          | 2                                     || slow_query_log            | OFF                                   || slow_query_log_file       | /var/lib/mysql/NC-PH-1551-49-slow.log |+---------------------------+---------------------------------------+5 rows in set (0.00 sec)#开启慢查询mysql&gt; set global log_slow_queries  = &apos;ON&apos;;mysql&gt; show variables like &apos;%slow%&apos;;#开启常规查询vim /etc/myql/mysql.conf.d/mysqld.confgeneral_log_file        = /var/log/mysql/mysql.loggeneral_log             = 1#开启错误查询log_error = /var/log/mysql/error.log#　防止innodb ibdata1文件过大innodb_file_per_table=1　</code></pre><p>安装php</p><pre><code>sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt#ubuntu16.04安装方法# Add the PPAapt-get install software-properties-common #如果提示没有 add-apt-repository，需要执行此命令安装sudo add-apt-repository ppa:ondrej/php# If you get add-apt-repository: command not found run the following command first :sudo apt-get install software-properties-commonsudo apt-get updatesudo apt-get install php5.6sudo apt-get install php5.6-*</code></pre><p>配置php</p><pre><code>vim /etc/php/5.6/apache/php.iniexpose_php = Off # 隐藏php版本信息</code></pre><h4 id="静态文件同步"><a href="#静态文件同步" class="headerlink" title="静态文件同步"></a>静态文件同步</h4><p>定时任务 crontab -e # 编辑当前用户的定时任务 crontab -u hanchang -e # 编辑指定用户的定时任务</p><pre><code># m h  dom mon dow   command# 分钟 小时 日期 月份 星期 命令0 0 * * * /bin/sh /home/hanchang/www/scripts/rsyncHK.sh</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7服务器基础配置</title>
      <link href="/2016/11/10/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/"/>
      <url>/2016/11/10/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="查看当前版本"><a href="#查看当前版本" class="headerlink" title="查看当前版本"></a>查看当前版本</h3><pre><code>cat /proc/version cat /etc/redhat-releaseCentos Linux release 7.2.1511 (Core)</code></pre><h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><pre><code>&gt; passwd root&gt; 输入密码</code></pre><h3 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h3><p>centos网络配置地址 /etc/sysconfig/network Centos设置主机名和网络配置<br>/etc/sysconfig/network-scripts/ifcfg-eth0针对特定的网卡进行设置<br>/etc/resolv.conf设置DNS<br>/etc/hosts设置指定的域名解析地址<br>当前使用的是虚拟机网桥模式</p><pre><code>cd /etc/sysconfig/network-scripts/vi ifcfg-enp0s23# 最后添加内容IPADDR=192.168.0.160  # ip地址NETMASK=255.255.255.0 # 掩码GATEWAY=192.168.0.1 # 网关地址DNS1=202.103.24.68 # DNS地址# 修改内容ONBOOT=yes # 启动时网络接口有效BOOTPROTO=none # dhcp改成none dhcp自动获取，static固定，none手动# 启动网卡sudo ifup eth0s23sudo systemctl restart network</code></pre><p>安装网络查看工具</p><pre><code>yum install net-tools</code></pre><p>centos默认的命令是</p><pre><code>ip addr</code></pre><h3 id="开机需要启动的5个服务"><a href="#开机需要启动的5个服务" class="headerlink" title="开机需要启动的5个服务"></a>开机需要启动的5个服务</h3><pre><code>sshd远程登陆, network网络,rsyslog日志相关,crond定时任务,sysstat检测系统性能</code></pre><h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><pre><code>su# 输入密码useradd testpasswd test# 输入密码# 确认密码su test # 切换成普通用户</code></pre><p>将test用户加入到sudoers用</p><pre><code>#visudo命令 # 相当于直接编辑 /etc/sudoers,但用命令方式更安全,推荐sucd /etcchmod 777 sudoersroot    ALL=(ALL)       ALLtest    ALL=(ALL)       ALL  # 新添加的chmod 440 sudoers   # 权限改成440，必须，否则会报错</code></pre><h3 id="配置ssh"><a href="#配置ssh" class="headerlink" title="配置ssh"></a>配置ssh</h3><p>安装ssh</p><pre><code>yum -y install  openssh*service sshd start    </code></pre><h3 id="ssh连接"><a href="#ssh连接" class="headerlink" title="ssh连接"></a>ssh连接</h3><pre><code>ssh test@192.168.0.160 # 默认22端口ssh -p 2222 test@192.168.0.160 # 修改端口后</code></pre><p>禁止root用户远程ssh连接</p><pre><code>vi /etc/ssh/sshd_congif # 最后添加# 禁止root远程登陆  PermitRootLogin no</code></pre><h3 id="关闭SELINUX"><a href="#关闭SELINUX" class="headerlink" title="关闭SELINUX"></a>关闭SELINUX</h3><p>修改/etc/selinux/config 文件<br>将SELINUX=enforcing改为SELINUX=disabled<br>setenforce 0 ##设置SELinux 成为permissive模式,临时关闭或者及时起效</p><h3 id="centos开启防火墙"><a href="#centos开启防火墙" class="headerlink" title="centos开启防火墙"></a>centos开启防火墙</h3><pre><code>systemctl mask firewalldsystemctl stop firewalldyum install iptables-services # 如果下面命令报错，则需要安装systemctl enable iptablessystemctl start iptablessystemctl enable ip6tablessystemctl start ip6tables</code></pre><p>防火墙开机启动</p><pre><code>systemctl enable iptablessystemctl disable iptables# 查看开机运行的服务systemctl list-unit-files --type=service</code></pre><p>防火墙是否放行ssh端口22</p><pre><code>cd /etc/sysconfig/vi iptables</code></pre><p>在commit前添加以下内容，并注释文件开头信息</p><pre><code># sample configuration for iptables service# you can edit this manually or use system-config-firewall# please do not ask us to add additional ports/services to this default configuration*filter# :INPUT ACCEPT [0:0]# :FORWARD ACCEPT [0:0]# :OUTPUT ACCEPT [0:0]# -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT# -A INPUT -p icmp -j ACCEPT# -A INPUT -i lo -j ACCEPT# -A INPUT -j REJECT --reject-with icmp-host-prohibited# -A FORWARD -j REJECT --reject-with icmp-host-prohibited# 安全设置-防止扫描包# NONE 包(所有标识bit都没有设置)主要是扫描类的数据包-A INPUT -p tcp --tcp-flags ALL NONE -j DROP# 防止sync-flood 攻击-A INPUT -p tcp ! --syn -m state --state NEW -j DROP# ALL包（所有的标注bit都被设置了）也是网络扫描的数据包-A INPUT -p tcp --tcp-flags ALL ALL -j DROP# 开放对应端口-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT# 缺省设置:INPUT DROP [0:0]:FORWARD ACCEPT [0:0]:OUTPUT ACCEPT [0:0]# 许所有从服务器端发起的连接，由此返回的响应数据应该是允许的,yum操作等-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT-A INPUT -p icmp -j ACCEPT# 接受主机localhost的任意请求-A INPUT -i lo -j ACCEPT-A INPUT -j REJECT --reject-with icmp-host-prohibited-A FORWARD -j REJECT --reject-with icmp-host-prohibitedCOMMIT</code></pre><h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><p>安装及启动</p><pre><code>yum install vsftpdsystemctl start vsftpdsystemctl enable vsftpd</code></pre><p>更新防火墙，放行20， 21端口，如果用了代理上传，需要添加被动模式的端口号<br>修改配置项目</p><pre><code>vi /etc/vsftpd/vsftpd.confanonymous_enable=No # YES改成No,禁止匿名用户listen=YES # No改成Yes 开启监听# listen_ipv6=YES  # 此行需要注释掉tcp_wrappers=YES   # 默认应该就是YES# 在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；# 未在/etc/vsftpd/chroot_list文件中列出的用户，不能切换到其他目录。# 需要创建/etc/vsftpd/chroot_list文件chroot_local_user=YESchroot_list_enable=YES  # (default follows) chroot_list_file=/etc/vsftpd/chroot_list# 防止500oops错误 allow_writeable_chroot=YES # 被动模式端口号pasv_min_port=30000  pasv_max_port=31000    </code></pre><p>只允许指定ip登陆</p><pre><code>vi /etc/hosts.allow最后添加vsftpd:192.168.0.19:allowvsftpd:all:deny</code></pre><p>添加虚拟用户</p><pre><code>useradd -g ftp -d /var/ftp/ftpuser -s /sbin/nologin ftpuser passwd ftpusercd /etc/vsftpd/touch chroot_listvi chroot_listftpuser # 将用户名称添加到chroot_list里</code></pre><h3 id="LAMP安装"><a href="#LAMP安装" class="headerlink" title="LAMP安装"></a>LAMP安装</h3><p>apache</p><pre><code>yum install httpd # 安装apache2systemctl enable httpd.servicesystemctl enable httpd.service</code></pre><p>mysql5.6</p><pre><code># 安装rpm包rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm# 查看可以安装的资源yum repolist enabled | grep &quot;mysql.*-community.*&quot;# 安装yum install mysql-community-serversystemctl start mysqldsystemctl enable mysqldmysql_secure_installation # 设置密码等</code></pre><p>php5.4</p><pre><code>yum install phpyum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-devel</code></pre><p>php5.6或者其他</p><pre><code>yum -y install epel-releasewget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpmwget https://centos7.iuscommunity.org/ius-release.rpmrpm -Uvh ius-release*.rpmyum -y updateyum -y install php56u php56u-opcache php56u-xml php56u-mcrypt php56u-gd php56u-devel php56u-mysql php56u-intl php56u-mbstring php56u-bcmath</code></pre><h3 id="LAMP配置"><a href="#LAMP配置" class="headerlink" title="LAMP配置"></a>LAMP配置</h3><p>apache允许php脚本</p><pre><code>vi /etc/httpd/conf/httpd.confAddType application/x-compress .ZAddType application/x-gzip .gz .tgzAddType application/x-httpd-php .php  # 新添加内容</code></pre><p>apache虚拟主机</p><pre><code>cd /etc/httpd/conf.dvi vhost.conf&lt;VirtualHost *:121&gt;ServerName phpmyadmin.comServerAlias www.phpmyadmin.comDocumentRoot /var/www/html/phpMyAdmin/ErrorLog /var/www/web_log/phpMyAdmin.www_error.log # 开启日志需要创建web_log文件夹，否则会报错CustomLog /var/www/web_log/phpMyAdmin.www_access.log common&lt;/VirtualHost&gt;&lt;Directory &quot;/var/www/html/phpMyAdmin/&quot;&gt;    Options FollowSymLinks    AllowOverride All    Require all granted&lt;/Directory&gt;&lt;VirtualHost *:108&gt;ServerName hkmain.comServerAlias www.kmain.comDocumentRoot /var/www/html/NEW/ErrorLog /var/www/web_log/NEW.www_error.logCustomLog /var/www/web_log/NEW.www_access.log common&lt;/VirtualHost&gt;&lt;Directory &quot;/var/www/html/NEW/&quot;&gt;    Options FollowSymLinks    AllowOverride All    Require all granted&lt;/Directory&gt;</code></pre><p>apache加载的模块查看</p><pre><code>apachectl -M | sort</code></pre><p>网站目录权限配置</p><pre><code>chown -R apache:apache WEB_FOLDchmod 750 WEB_FOLDcd WEB_FOLDfind -type d -exec chmod 750 {} \;find -not -type d -exec chmod 640 {} \;find . -name &quot;Runtime&quot; -type d -exec chmod -R 770 {} \;</code></pre><h3 id="LNMP安装与配置"><a href="#LNMP安装与配置" class="headerlink" title="LNMP安装与配置"></a>LNMP安装与配置</h3><p>参考链接 <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7" target="_blank" rel="noopener">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7</a> nginx安装(apache二选一)</p><pre><code># 安装pcre库，使nginx支持rewritesudo yum install pcre pcre-devel -ysudo yum install nginxsudo systemctl start nginx.service# 设置开机启动sudo systemctl enable nginx.service</code></pre><p>mysql5.6</p><pre><code># 安装rpm包rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm# 查看可以安装的资源yum repolist enabled | grep &quot;mysql.*-community.*&quot;# 安装yum install mysql-community-serversystemctl start mysqldsystemctl enable mysqldmysql_secure_installation # 设置密码等</code></pre><p>php安装</p><pre><code>yum -y install epel-releasesudo yum install php php-mysql php-fpmsudo yum install php-pecl-memcache</code></pre><p>配置</p><pre><code>vim /etc/php.ini#cgi.fix_poathinfo=1改成cgi.fix_pathinfo=0vim /etc/php-php.d/www.conf# 第一处修改listen = /var/run/php-fpm/php-fpm.sock# 第二处修改listen.owner = nobodylisten.group = nobody# 第三处修改user = nginxgroup = nginx# 重启sudo systemctl start php-fpmsudo systemctl enable php-fpm# 安装xcahesudo yum -y install php-xcache xcache-admin# 如果失败请用下面的方法# xcahewget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/x86_64/php-xcache-3.1.1-1.el7.x86_64.rpm# 图形化管理wget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/noarch/xcache-admin-3.1.1-1.el7.noarch.rpm</code></pre><p>#配置nginx sudo vi /etc/nginx/conf.d/default.conf server { listen 80; server_name server_domain_name_or_IP; # 注意位置，在括号外 root /usr/share/nginx/html; index index.php index.html index.htm;</p><pre><code>location / {    try_files $uri $uri/ =404;}error_page 404 /404.html;error_page 500 502 503 504 /50x.html;location = /50x.html {    root /usr/share/nginx/html;}    # 下面是配置fpmlocation ~ \.php$ {    try_files $uri =404;    fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; (这个值从php-fpm复制来)    fastcgi_index index.php;    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;    include fastcgi_params;}</code></pre><p>}</p><pre><code># 测试sudo vi /usr/share/nginx/html/info.php&lt;?php echo phpinfo();&gt;sudo systemctl restart php-fpmsudo systemctl restart nginx</code></pre><h3 id="安装imagemagick"><a href="#安装imagemagick" class="headerlink" title="安装imagemagick"></a>安装imagemagick</h3><pre><code>yum install php-pear gccyum install ImageMagick ImageMagick-devel ImageMagick-perlpecl install imagick # 直接回车echo extension=imagick.so &gt;&gt; /etc/php.ini # 添加php扩展systemctl restart httpd</code></pre><h3 id="mysql主从复制主服务器配置"><a href="#mysql主从复制主服务器配置" class="headerlink" title="mysql主从复制主服务器配置"></a>mysql主从复制主服务器配置</h3><pre><code>vi /etc/my.cnf[mysqld] server-id=1     # 配一个唯一的ID编号，1至32  log-bin=mysql-bin  # 二进制文件存放路径  binlog-do-db=test1  # 需要同步的数据库名  binlog-ignore-db=test2  # 不需要同步的数据库名 </code></pre><p>其他参考mysql主从复制</p><h3 id="rsycn数据同步"><a href="#rsycn数据同步" class="headerlink" title="rsycn数据同步"></a>rsycn数据同步</h3><pre><code>yum install rsync # 安装，默认端口873  systemctl start rsyncdsystemctl enable rsyncdvim rsync.conf# 日志文件位置，启动rsync后自动产生这个文件，无需提前创建log file = /var/log/rsyncd.log# pid文件的存放位置pidfile = /var/run/rsyncd.pid# 支持max connections参数的锁文件lock file = /var/run/rsync.lock# 用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件secrets file = /etc/rsync.pass# rsync启动时欢迎信息页面文件位置（文件内容自定义# motd file = /etc/rsyncd.Motd## 设置rsync运行权限为root# uid = root# 设置rsync运行权限为root# gid = root# 匿名用户uid = 0gid = 0# 默认端口port = 873# 默认为true，修改为no，增加对目录文件软连接的备份use chroot = no# 设置rsync服务端文件为读写权限read only = yes# 不显示rsync服务端资源列表list = no# 最大连接数max connections = 200# 设置超时时间timeout = 600# 不验证用户密码strict modes = false# 执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开# auth users = test# 允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开hosts allow = 192.168.0.206, 192.168.0.118# 禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开# hosts deny = 192.168.21.254# 自定义名称[web]# rsync服务端数据目录路径path = /var/www/html/HKMAIN_NEW/Upload/product/manual/cn/## 模块名称与自定义名称相同comment = web[webe]path = /var/www/html/HKMAIN_NEW/Upload/product/manual/en/comment = webe</code></pre><h3 id="centos7-2安装nfs服务器端"><a href="#centos7-2安装nfs服务器端" class="headerlink" title="centos7.2安装nfs服务器端"></a>centos7.2安装nfs服务器端</h3><pre><code># 服务器端安装及配置# 安装命令sudo yum install nfs-utils rpcbind# 查看是否安装成功$ rpm -aq nfs-utils rpcbindrpcbind-0.2.0-38.el7.x86_64nfs-utils-1.3.0-0.33.el7_3.x86_64# 启动rpcbindsudo systemctl restart rpcbind# 查看状态systemctl status rpcbind# 开机启动sudo systemctl enable rpcbind# 查看是否开机启动systemctl is-enabled rpcbind # enable表示开机启动，disable表示不开机启动# 启动及开机启动nfs服务sudo systemctl restart nfssudo systemctl enable nfs#配置nfs服务vim /etc/exports/readonly 192.168.0.160(insecure,ro,no_root_squash) # 指定ip地址，只读/rwsync 192.168.0.0/24(insecure,rw,sync,no_root_squash) # 指定ip地址段，读写# 加载配置文件sudo exportfs -rv# 查看nfs服务器本地挂载情况$ showmount -e localhostExport list for localhost:/rwsync   192.168.0.0/24/readonly 192.168.0.160# 重启服务sudo systemctl restart nfs# 客户端安装配置sudo yum install nfs-utils rpcbind# 只需启动rpc服务sudo systemctl restart rpcbindsudo systemctl enable rpcbind# 查看可以挂载服务器端的目录showmount -e 192.168.0.206Export list for 192.168.0.206:/rwsync   192.168.0.0/24/readonly 192.168.0.160# 挂载sudo mount -t nfs 192.168.0.206:/readonly /mnt/readonlysudo mount -t nfs 192.168.0.206:/rwsync /mnt/rwsync# 查看挂载结果df -h</code></pre><h3 id="centos7-2安装python3-5"><a href="#centos7-2安装python3-5" class="headerlink" title="centos7.2安装python3.5"></a>centos7.2安装python3.5</h3><pre><code># 安装编译环境yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel# 下载文件wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz# 解压tar -zxvf Python-3.6.6.tgz# 编译安装cd Python-3.5.1./configure --prefix=/usr/local/python3make &amp;&amp; make install# 创建软连接sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3python3 --versionsudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 pip3 --version# 添加pip源vim ~/.pip/pip.conf[global]trusted-host =  mirrors.aliyun.comindex-url = https://mirrors.aliyun.com/pypi/simple### 安装虚拟环境sudo pip3 uninstall virtualenvsudo ln -s /usr/local/python3/bin/virtualenv /usr/bin/virtualenv ### 创建虚拟环境virtualenv --no-site-packages -p python3 .envsource ./.env/bin/activate</code></pre><h3 id="centos7-2安装node8"><a href="#centos7-2安装node8" class="headerlink" title="centos7.2安装node8"></a>centos7.2安装node8</h3><pre><code># 参考文件 https://nodejs.org/en/download/package-manager/On RHEL, CentOS or Fedora, for Node.js v8 LTS:curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -Alternatively for Node.js 10:curl --silent --location https://rpm.nodesource.com/setup_10.x | sudo bash -Then install:sudo yum -y install nodejs# 安装cnpmnpm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre><h3 id="centos6-8安装nginx"><a href="#centos6-8安装nginx" class="headerlink" title="centos6.8安装nginx"></a>centos6.8安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewriteyum install pcre pcre-devel -y# 安装openssl，https服务需要使用yum install openssl openssl-devel -y# 安装 gzip 类库yum -y install zlib zlib-devel# 安装编译程序yum -y install make gcc gcc-c++ ncurses-devel# 创建用户useradd nginx -s /sbin/nologin -M# 下载源码wget -q https://nginx.org/download/nginx-1.6.3.tar.gz tar -zxvf nginx-1.6.3.tar.gzcd nginx-1.6.3./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-pcremakemake install# 启动nginx/usr/local/nginx/sbin/nginx# 停止nginx/usr/local/nginx/sbin/nginx -s quit# 重新加载配置文件/usr/local/nginx/sbin/nginx -s reload        # 测试你的配置文件是否有误/usr/local/nginx/sbin/nginx -t       # 查看nginx对应的端口 lsof -i :80</code></pre><h3 id="centos6-8安装mysql5-7"><a href="#centos6-8安装mysql5-7" class="headerlink" title="centos6.8安装mysql5.7"></a>centos6.8安装mysql5.7</h3><pre><code># yum源直接安装的是mysql5.1版本，抛弃# 先检查是否有旧版本rpm -qa | grep mysql# 删除旧版本sudo yum -y remove mysql-xx-xxwget https://dev.mysql.com/get/mysql57-community-release-el6-10.noarch.rpmsudo yum install mysql57-community-release-el6-10.noarch.rpmsudo yum install mysql-community-server</code></pre><h3 id="centos7-2-源码安装nginx"><a href="#centos7-2-源码安装nginx" class="headerlink" title="centos7.2 源码安装nginx"></a>centos7.2 源码安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewriteyum install pcre pcre-devel -y# 安装openssl，https服务需要使用yum install openssl openssl-devel -y# 安装 gzip 类库yum -y install zlib zlib-devel# 安装编译程序yum -y install make gcc gcc-c++ ncurses-devel# 创建用户useradd nginx -s /sbin/nologin -M# 下载源码wget -q https://nginx.org/download/nginx-1.12.1.tar.gz tar -zxvf nginx-1.12.1.tar.gzcd nginx-1.12.1./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_gunzip_module --with-http_gzip_static_module --with-threads --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt=&apos;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=native&apos;makemake install# 创建链接sudo ln -s /usr/local/nginx/bin/nginx /usr/bin/nginx# 启动nginx/usr/local/nginx/sbin/nginx# 停止nginx/usr/local/nginx/sbin/nginx -s quit# 重新加载配置文件/usr/local/nginx/sbin/nginx -s reload        # 测试你的配置文件是否有误/usr/local/nginx/sbin/nginx -t       # 查看nginx对应的端口 lsof -i :80</code></pre><h3 id="centos7-2安装php7"><a href="#centos7-2安装php7" class="headerlink" title="centos7.2安装php7"></a>centos7.2安装php7</h3><pre><code># 加源sudo yum install epel-release yum-utilssudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm# 选择remisudo yum-config-manager --enable remi-php70sudo yum-config-manager --enable remi-php71sudo yum-config-manager --enable remi-php72# 安装相关扩展sudo yum-config-manager --enable remi-php70sudo yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql# 安装 PHP FPM sudo yum install php-fpmsudo systemctl enable php-fpmsudo systemctl start php-fpm# 配置sudo vim /etc/php-fpm.d/www.confuser = nginxgroup = nginx# 配置nginx虚拟serverserver {    # . . . other code    location ~ \.php$ {        try_files $uri =404;        # fastcgi_pass unix:/run/php-fpm/www.sock;                fastcgi_pass 127.0.0.1:9000;        fastcgi_index index.php;        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;        include fastcgi_params;    }}</code></pre><h3 id="centos7-2安装redis"><a href="#centos7-2安装redis" class="headerlink" title="centos7.2安装redis"></a>centos7.2安装redis</h3><pre><code>$ sudo yum install redis$ sudo systemctl enable redis$ sudo systemctl start redis# 查看版本号$ redis-server --version# 使用方法 http://www.zhuohc.com/articles/redis%E5%9F%BA%E7%A1%80/</code></pre><p><a href="/articles/centos7-2安装及使用docker/">centos7.2安装使用docker</a> <a href="/articles/centos7-2安装使用sentry/">centos7.2安装使用sentry</a> <a href="/articles/centos7-2使用rabbitmq/">centos7.2安装使用rabbitMQ</a> <a href="/articles/postgresql常见命令/">centos7.2安装使用postgresql</a></p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript入门基础</title>
      <link href="/2016/11/10/javascript%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/10/javascript%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><blockquote><p>object(包含Function，Array，Date等)<br>number<br>string<br>boolean<br>null<br>undefined</p></blockquote><h3 id="类型检测"><a href="#类型检测" class="headerlink" title="类型检测"></a>类型检测</h3><p>typeof 基本类型，function， null可以用===判断</p><pre><code>typeof 100           // &quot;number&quot;   typeof true          // &quot;boolean&quot;    typeof function      // &quot;function&quot;    typeof undefined     // &quot;undefined&quot;  typeof new Object()  // &quot;object&quot;  typeof [1, 2]        // &quot;object&quot;  typeof NaN           // &quot;number&quot;  typeof null          // &quot;object&quot;  </code></pre><p>instanceof</p><pre><code>// 不同window或iframe下返回false[1, 2] instanceof Array === true  new Object instanceof Array === fasle</code></pre><p>Object.prototype.toString</p><pre><code>Object.prototype.toString.apply([1, 2, 3]) === &quot;[object Array]&quot;;  Object.prototype.toString.apply(function(){}) === &quot;[object Function]&quot;  Object.prototype.toString.apply(null) === &quot;[object Null]&quot;  // ie678返回[object Object]  Object.prototype.toString.apply(undefined) === &quot;[object Undefined]&quot;  Object.prototype.toString.apply(12313) === &quot;[object Number]&quot;  Object.prototype.toString.apply(&apos;12313&apos;) === &quot;[object String]&quot;</code></pre><p>constructor<br>duck type</p><h3 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h3><p>表达式是一种js短语，可使js解释器用来产生一个值</p><pre><code>// 原始表达式3.14, &quot;test&quot;      // 常量，直接量null, this, true  // 关键字i, j, k;           // 变量// 复合表达式10 * 20;           // 原始表达式+运算符+原始表达式// 初始化表达式[1, 2];[1,,2];{x: 1, y: 2};// 函数表达式var fe = function(){};(function(){console.log(&apos;1111&apos;);}){};// 属性访问表达式var o = {x:1};o.x;o[&apos;x&apos;];// 调用表达式func();// 对象创建表达式new Func(1, 2);new Object;</code></pre><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><blockquote><p>一元（+num）<br>二元（a + b）<br>三元（c：a：b） 赋值(x += 1)<br>比较(a == b)<br>算术（a - b）<br>位 （a | b）<br>逻辑 (exp1 &amp;&amp; exp2)<br>字符串(“a” + “b”)<br>特殊</p></blockquote><h3 id="特殊运算符"><a href="#特殊运算符" class="headerlink" title="特殊运算符"></a>特殊运算符</h3><blockquote><p>c? a:b<br>var val = (1, 2, 3) // 逗号运算符<br>delete obj.x // 删除对象属性<br>‘x’ in window; // in 运算符<br>instanceof, typeof // 判断类型<br>new Foo(); // new 运算符<br>this // this运算符<br>void 0 // undefined</p></blockquote><h3 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h3><p>块语句block<br>块语句是没有作用域的</p><pre><code>{  var str = &apos;hi&apos;;  console.log(str);  }  </code></pre><p>声明语句 var<br>var a=1, b=1; 函数语句function</p><pre><code>// 函数声明语句  function fd() {      return true;  }    // 函数表达式  var fe = function() {    //do sth};</code></pre><p>for in 语句</p><pre><code>var p;  var obj = {x:1, y:2};  for(p in obj) {    // 顺序不确定  }</code></pre><p>swith语句</p><pre><code>var val = 2;switch (val) {    case 1:        console.log(1);        break;    case 2:        console.log(2);        break;    case 3:        console.log(3);        break;    default:        console.log(0);        break;}</code></pre><p>循环语句</p><pre><code>while (isTrue) {    // do sth}do {    // do sth} while (isTrue)var i;for (i = 0; i &lt; n; i++) {    // do sth}</code></pre><p>with语句 // 不使用 try catch语句</p><pre><code>try {    try {        throw new Error(&apos;oops&apos;);    } catch(ex) {        console.error(&apos;inner catch&apos;, ex.message);        throw ex;    } finally {        console.log(&apos;inner  finally&apos;);    }} catch(ex) {    console.error(&apos;outer catch&apos;, ex.message);} finally {    console.log(&apos;outer finally&apos;);}</code></pre><p>结果 内部catch&gt;内部finally&gt;外部catch&gt;外部finally</p><pre><code>inner catch oops  inner  finally  outer catch oops  outer finally  </code></pre><h3 id="严格模式-待补充）"><a href="#严格模式-待补充）" class="headerlink" title="严格模式(待补充）"></a>严格模式(待补充）</h3><pre><code>function func() {    &apos;use strict&apos;;}</code></pre><h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><p>对象创建<br>字面量创建</p><pre><code>var obj = {x: 1};console.log(obj);console.log(obj.y);Object.prototype.y = 2;console.log(obj);console.log(obj.y);obj.y = undefined;console.log(obj);console.log(obj.y);{ x: 1 }undefined{ x: 1 }2{ x: 1, y: undefined }undefined</code></pre><p>new构造器创建</p><pre><code>function foo() { this.color = &apos;red&apos;;}foo.prototype.background = &apos;#000&apos;;var redColor = new foo();console.log(redColor);console.log(typeof redColor.toString);console.log(redColor.color);console.log(redColor.background);console.log(foo);console.log(foo.prototype);console.log(foo.prototype.prototype);console.log(&apos;background&apos; in redColor);redColor.background = &apos;#FFF&apos;;console.log(redColor.background);console.log(foo.prototype.background);foo { color: &apos;red&apos; }functionred#000[Function: foo]foo { background: &apos;#000&apos; }undefinedtrue#FFF#000</code></pre><p>Object.create()创建</p><pre><code>function obj() {    this.x = 1;}console.log(obj);var obj1 = new obj();console.log(obj1);var obj2 = Object.create(obj);console.log(obj2);console.log(obj2.x);var obj3 = Object.create(obj1);console.log(obj3);console.log(obj3.x);;[Function: obj]obj { x: 1 }Function {}undefinedobj {}1</code></pre><h3 id="对象的内部原型-proto-和构造器的原型（prototype）的关系。"><a href="#对象的内部原型-proto-和构造器的原型（prototype）的关系。" class="headerlink" title="对象的内部原型(proto)和构造器的原型（prototype）的关系。"></a>对象的内部原型(<strong>proto</strong>)和构造器的原型（prototype）的关系。</h3><p>一、所有构造器/函数的<strong>proto</strong>都指向Function.prototype，它是一个空函数（Empty function）</p><pre><code>Number.__proto__ === Function.prototype  // true  Boolean.__proto__ === Function.prototype // true  String.__proto__ === Function.prototype  // true  Object.__proto__ === Function.prototype  // true  Function.__proto__ === Function.prototype // true  Array.__proto__ === Function.prototype   // true  RegExp.__proto__ === Function.prototype  // true  Error.__proto__ === Function.prototype   // true  Date.__proto__ === Function.prototype    // true  Math.__proto__ === Object.prototype  // true  JSON.__proto__ === Object.prototype  // true // 函数声明function Person() {}// 函数表达式var Man = function() {}console.log(Person.__proto__ === Function.prototype) // true  console.log(Man.__proto__ === Function.prototype)    // true  </code></pre><p>所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身。所有构造器都继承了Function.prototype的属性及方法。如length、call、apply、bind（ES5）</p><pre><code>console.log(typeof Function.prototype) // functionconsole.log(typeof Object.prototype)   // objectconsole.log(typeof Number.prototype)   // objectconsole.log(typeof Boolean.prototype)  // objectconsole.log(typeof String.prototype)   // objectconsole.log(typeof Array.prototype)    // objectconsole.log(typeof RegExp.prototype)   // objectconsole.log(typeof Error.prototype)    // objectconsole.log(typeof Date.prototype)     // objectconsole.log(typeof Object.prototype)   // object  console.log(Function.prototype.__proto__ === Object.prototype) // true    Object.prototype.__proto__ === null  // true  </code></pre><p>二、所有对象的<strong>proto</strong>都指向其构造器的prototype<br>JavaScript引擎内置构造器</p><pre><code>var obj = {name: &apos;jack&apos;}var arr = [1,2,3]var reg = /hello/gvar date = new Datevar err = new Error(&apos;exception&apos;)console.log(obj.__proto__ === Object.prototype) // trueconsole.log(arr.__proto__ === Array.prototype)  // trueconsole.log(reg.__proto__ === RegExp.prototype) // trueconsole.log(date.__proto__ === Date.prototype)  // trueconsole.log(err.__proto__ === Error.prototype)  // true</code></pre><p>自定义的构造器</p><pre><code>function Person(name) {    this.name = name}var p = new Person(&apos;jack&apos;)console.log(p.__proto__ === Person.prototype) // true</code></pre><p>每个对象都有一个constructor属性，可以获取它的构造器</p><pre><code>function Person(name) {    this.name = name}var p = new Person(&apos;jack&apos;)console.log(p.__proto__ === p.constructor.prototype) // true</code></pre><h3 id="对象属性操作"><a href="#对象属性操作" class="headerlink" title="对象属性操作"></a>对象属性操作</h3><p>属性读写</p><pre><code>// 属性读写var obj = {x1: 1, x2: 2};var i = 1, n = 2;for(; i&lt;= n; i++) {    console.log(obj[&apos;x&apos; + i]);}// 输出1，2var p;for(p in obj) {    console.log(obj[p]);}// 输出1，2var obj = {x: 1};// 读写异常console.log(obj.y); // undefinedvar yz = obj.y.z;  // TypeError: Cannot read property &apos;z&apos; of undefinedobj.y.z = 2;      //TypeError: Cannot set property &apos;z&apos; of undefined// 正确方式var yz;if(obj.y) {    yz = obj.y.z;}// 或者var yz = obj &amp;&amp; obj.y &amp;&amp; obj.y.z  // 这个会返回undefined</code></pre><p>属性删除</p><pre><code>var person = {age: 28, title: &apos;fe&apos;};console.log(delete person.age);  // trueconsole.log(delete person[&apos;age&apos;]);  // trueconsole.log(person.age);  // undefinedconsole.log(delete person.age);   // 注意这个也返回true 判断操作结束后该属性是否存在// 有些属性是不能删除的console.log(delete Object.prototype);  // false// 原因var descriptor = Object.getOwnPropertyDescriptor(Object, &apos;prototype&apos;);console.log(descriptor.configurable);  // false// 变量及函数不可删除var globalVal = 1;console.log(delete globalVal);  // false(function() {    var localVal = 1;    console.log(delete localVal);}());  // falsefunction fd() {}console.log(delete fd);  // false(function() {    function fd() {};    console.log(delete fd);}());  // false// 隐示定义的变量可以ohNo = 1;console.log(delete ohNo);  // true</code></pre><p>对象属性检测</p><pre><code>var cat = new Object();cat.legs = 4;cat.name = &apos;Kitty&apos;;console.log(&apos;legs&apos; in cat);  // trueconsole.log(&apos;abc&apos; in cat);  // falseconsole.log(&apos;toString&apos; in cat);  // true 继承属性console.log(cat.hasOwnProperty(&apos;legs&apos;));  // trueconsole.log(cat.hasOwnProperty(&apos;toString&apos;));  // falseconsole.log(cat.propertyIsEnumerable(&apos;legs&apos;));  // trueconsole.log(cat.propertyIsEnumerable(&apos;toString&apos;));  // falseObject.defineProperty(cat, &apos;price&apos;, {enumerable: false, value: 1000});// defineProperty是Object的方法，默认的标签enumerable值为false// Object.x创建属性，默认的标签值为trueconsole.log(cat.propertyIsEnumerable(&apos;price&apos;));  // falseconsole.log(cat.hasOwnProperty(&apos;price&apos;));  // true// 判断属性是否存在if(cat &amp;&amp; cat.legs) {    cat.legs *= 2;}if(cat.legs != undefined) {    // !== undefined 或者 !== null}if(cat.legs !== undefined) {    // !== undefined}</code></pre><p>对象属性枚举</p><pre><code>var o = {x: 1, y: 2, z: 3};console.log(&apos;toString&apos; in o);  // trueo.propertyIsEnumerable(&apos;toString&apos;);  // falsevar key;console.log(o.x);  // 1console.log(o.y);  // 2console.log(o.z);  // 3for(key in o) {    console.log(key);  // x, y, z    console.log(o.key);  // undefined    console.log(o[key]);  // 1, 2, 3}var obj = Object.create(o);obj.a = 4;var key;for(key in obj) {    console.log(key); // a, x, y, z}var key1;for (key1 in obj) {    if(obj.hasOwnProperty(key1)) {        console.log(key1); // a    }}</code></pre><p>对象属性的get/set方法</p><pre><code>// 对象属性的get/set方法var man = {    name: &apos;Bug&apos;,    weibo: &apos;Bug&apos;,    get age() {        return new Date().getFullYear() - 1988;    },    set age(val) {        console.log(&apos;cannot be set &apos; + val);    },};console.log(man.age);  // 调用age的get方法27man.age = 100;  // 调用age的set方法 cannot be set 100console.log(man.age);  // 27var man = {    weibo: &apos;Bug&apos;,    $age: null,    get age() {        if(this.$age == undefined) {            return new Date().getFullYear() - 1988;        } else {            return this.$age;        }    },    set age(val) {        val = +val; // 转为数字        if(!isNaN(val) &amp;&amp; val &gt; 0 &amp;&amp; val &lt; 150) {            this.$age = + val;        } else {            throw new Error(&apos;Incorrect val = &apos; + val );        }    }}console.log(man.age);  // 27man.age = 100;console.log(man.age);  // 100//man.age = &apos;abc&apos;;  // Error: Incorrect val = NaN// get/set方法与原型链// 这是错误的定义对象属性get方法方式function foo1() {}foo1.prototype.z = {    get: function() {        return 2;    }};var obj = new foo1();console.log(obj.z);  // 这个会被认为是对象 { get: [Function] }obj.z = 200;console.log(obj.z);  // 200// 正确定义方法function foo() {}Object.defineProperty(foo.prototype, &apos;z&apos;, {    get: function() {        return 1;    },    // configurable: true,  // 开启此属于也不会被改变    // writable: true,  // 此项不能配置writable/value get/set 二选一 });var obj = new foo();console.log(obj.z);   // 1obj.z = 100;console.log(obj.z);  // 但是还是1 并没有被改变Object.defineProperty(obj, &apos;z&apos;, {    value: 100,    configurable: true});console.log(obj.z);  // 100delete obj.z;console.log(obj.z);  // 返回到1// 另外一个例子var o = {};Object.defineProperty(o, &apos;x&apos;, {    value: 1});  // 默认writable: false, configurable: falsevar obj = Object.create(o);console.log(obj.x);  // 1obj.x = 100;console.log(obj.x);  // 还是1Object.defineProperty(obj, &apos;x&apos;, {    writable: true,    configurable: true,    value: 100});console.log(obj.x);  // 100obj.x = 200;console.log(obj.x); // 200</code></pre><h3 id="对象属性标签"><a href="#对象属性标签" class="headerlink" title="对象属性标签"></a>对象属性标签</h3><pre><code>person = {};Object.defineProperty(person, &apos;type&apos;, {    configurable: false,    writable: true,    enumerable: false,    value: &apos;Object&apos;,});console.log(Object.keys(person));   // [] 返回空数组，不能枚举console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object&apos;, writable: true, enumerable: false, configurable: false }// writable为true，可以通过赋值方法修改value值 [通过赋值修改属性值只和writable标签有关，和configurable无关]person.type = &apos;Object2&apos;;console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));  // { value: &apos;Object2&apos;, writable: true, enumerable: false, configurable: false }// configurable: false 无法使用delete删除属性， 无法使用get/set方法，  无法重新配置属性标签（除了将writable从true修改为false）console.log(delete person.type);   // 返回false// 只有writable和configurable标签都为false时，不能修改value标签值，其他情况都可以修改value标签值Object.defineProperty(person, &apos;type&apos;, {    configurable: false,    writable: true,    enumerable: false,    value: &apos;Object1&apos;,});console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: true, enumerable: false, configurable: false }// 可以重新配置writable标签值(只能重true改为false)Object.defineProperty(person, &apos;type&apos;, {    writable: false,});console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: false, enumerable: false, configurable: false }// 无法将writable从false改为trueObject.defineProperty(person, &apos;type&apos;, {    writable: true,});console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type// 无法重新配置enumerable，configurable属性Object.defineProperty(person, &apos;type&apos;, {    enumerable: true,});console.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type</code></pre><h3 id="对象标签"><a href="#对象标签" class="headerlink" title="对象标签"></a>对象标签</h3><p>原型标签<strong>proto</strong></p><pre><code>// 原型标签__proto__function Person(name) {    this.name = name;}var p = new Person(&apos;jack&apos;);console.log(p.__proto__ === Person.prototype);  // true</code></pre><p>类型标签</p><pre><code>//  对象class标签，表示对象是哪个类型，没有直接的方法去修改或者获取var toString = Object.prototype.toString;console.log(toString.call(null));  // [object Null]console.log(toString.call(undefined));  // [object Undefined]console.log(toString.call(1));  // [object Number]console.log(toString.call(new Number(1)));  // [object Number]console.log(toString.call(true));  // [object Boolean]console.log(toString.call(new Boolean(true)));  // [object Boolean]</code></pre><p>可扩展标签</p><pre><code>// extensible 可扩展标签，表示是否可以继续添加对象属性var obj = {x: 1, y: 2};console.log(Object.isExtensible(obj));  // true 对象可扩展Object.preventExtensions(obj);  // 配置对象不可扩展console.log(Object.isExtensible(obj));  // false 对象不可扩展obj.z =1;console.log(obj.z);  // undefined 添加属性失败console.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // // { value: 1, writable: true, enumerable: true, configurable: true }// Object.seal方法，对象的所有属性configurable值为falseObject.seal(obj);console.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // { value: 1, writable: true, enumerable: true, configurable: false }console.log(Object.isSealed(obj)); // true// Object.freeze方法，对象的所有属性configurable，writable标签值为falseObject.freeze(obj);console.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));   // // { value: 1, writable: false, enumerable: true, configurable: false }console.log(Object.isFrozen(obj));  // true</code></pre><h3 id="JS对象与json格式转换"><a href="#JS对象与json格式转换" class="headerlink" title="JS对象与json格式转换"></a>JS对象与json格式转换</h3><pre><code>// 将js对象转为json格式JSON.stringify()var obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null};console.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:true,&quot;z&quot;:[1,2,3],&quot;nullVal&quot;:null}// undefined,NaN,Infinity等特殊属性值var obj = {val: undefined, a: NaN, b: Infinity, c: new Date()};console.log(JSON.stringify(obj));  // {&quot;a&quot;:null,&quot;b&quot;:null,&quot;c&quot;:&quot;2015-12-19T12:30:40.456Z&quot;}// 将json格式转为js对象JSON.parsevar obj = JSON.parse(&apos;{&quot;x&quot;: 1}&apos;);console.log(obj.x);  // 1//toJSON方法var obj = {    x: 1,    y: 2,    o: {        o1: 1,        o2: 2,        toJSON: function() {            return this.o1 + this.o2;        }    },};console.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:2,&quot;o&quot;:3}</code></pre><p>###toString valueOf方法</p><pre><code>// 对象在作为操作数时，解释器总是优先调用valueOf()--(Date类型的对象在二元“+”运算时例外),而其他情况，解释器总是认为我们想要的是字符串，所以会优先调用toString()。var obj = {x: 1, y: 2};console.log(obj.toString());  // [object Object]console.log(+obj.toString());  // NaNconsole.log(3 + obj.toString());  // 3[object Object] 会被理解为字符串拼接console.log(+obj.valueOf());  // NaN// 重写obj.toString = function() {    return this.x + this.y;};console.log(+obj);  // 3obj.valueOf = function() {    return this.x + this.y + 100;};console.log(+obj);  // 103// 如果只重写了toString，对象转换时会无视valueOf的存在来进行转换。但是，如果只重写了valueOf方法，在要转换为字符串的时候会优先考虑valueOf方法。在不能调用toString的情况下，只能让valueOf上阵了。var cc = {    i: 10,    valueOf: function() {        console.log(&apos;valueOf&apos;);        return this.i;    }};console.log(cc);// 10 { [Number: 10] i: 10, valueOf: [Function] }console.log(+cc); // 10 valueOfconsole.log(&apos;&apos;+cc); // 10 valueOfconsole.log(String(cc)); // [object Object]console.log(Number(cc)); // 10 valueOfconsole.log(cc == &apos;10&apos;); // true valueOf</code></pre><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>创建数组</p><pre><code>// 字面量创建数组 数组的长度不能超过2^23 - 1 = 4,294,967,295var BAT = [&apos;B&apos;, &apos;A&apos;, &apos;T&apos;];var students = [{name: &apos;B&apos;, age: 27}, {name: &apos;A&apos;, age: 30}];var arr = [&apos;T&apos;, 123, true, null, undefined];var arrInArr = [[1, 2], [1, 2, 3]];// 对象创建数组 new关键字可以省略var arr = new Array();  // var = [];var arrWithLength = new Array(100);  // undefined * 100var arrLikesLiteral = new Array(true, false, null, 1, 2, &apos;hi&apos;);  // [true, false, null, 1, 2, &apos;hi&apos;]</code></pre><p>数组元素操作</p><pre><code>// 数组元素读写// 索引访问var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr[1]);  // bconsole.log(arr.length);  // 5arr[5] = &apos;f&apos;;console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]console.log(arr.length);  // 6// delete方法并不会改变数组长度,delete 和定义为undefined的区别delete arr[0];console.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]console.log(arr.length);  // 6console.log(0 in arr);  // 会返回falsearr[1] = undefined;console.log(arr);  // [ , undefined, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]console.log(arr.length);  // 6console.log(1 in arr);  // true// 数组是动态的，无需指定大小// 指定索引位置，改变数组var arr = [];arr[1] = &apos;b&apos;;console.log(arr.length);  // 2console.log(arr);   // [ , &apos;b&apos; ]// push方法，在数组尾部添加元素,并返回新的数组长度console.log(arr.push(&apos;c&apos;));  // 3console.log(arr);  // [ , &apos;b&apos;, &apos;c&apos; ]// 在数组尾部添加的另一种方法arr[arr.length] = &apos;d&apos;;console.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]// unshift方法，在数组头部添加元素，并返回新的数组长度console.log(arr.unshift(&apos;a&apos;));  // 5console.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]// pop方法，删除数组尾部的元素并返回这个元素console.log(arr.pop());  // &apos;d&apos;console.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos; ]// 删除数组尾部元素的另个方法arr.length -= 1;console.log(arr);  // [ &apos;a&apos;, , &apos;b&apos; ]// shift方法，删除数组头部的元素并返回这个元素console.log(arr.shift());  // &apos;a&apos;console.log(arr);  // [ , &apos;b&apos; ]</code></pre><p>数组迭代</p><pre><code>// 数组迭代var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;];for(var i = 0; i &lt; arr.length; i++) {    console.log(arr[i]);}// a b c d e f gfor(i in arr) {    console.log(arr[i]);}// a b c d e f g// for in 表达式的坑：会迭代原型的元素Array.prototype.x = &apos;keng&apos;;for(i in arr) {    console.log(arr[i]);}// a b c d e f g kengfor(i in arr) {    if(arr.hasOwnProperty(i)) {        console.log(arr[i]);    }}// a b c d e f g</code></pre><p>特殊数组：二维数组和稀疏数组</p><pre><code>// 特殊数组：二维数组，稀疏数组// 二维数组var arr = [[&apos;a&apos;, &apos;b&apos;], [&apos;c&apos;, &apos;d&apos;], [&apos;e&apos;, &apos;f&apos;]];var i = 0, j = 0;var row;for(; i &lt; arr.length; i++) {    row = arr[i];    console.log(&apos;row&apos; + i);    for(j = 0; j &lt; row.length; j++) {        console.log(row[j]);    }}// row0 a b row1 c d row2 e f// 稀疏数组：并不含有从0开始的连续索引var arr1 = [undefined];var arr2 = new Array(1);console.log(0 in arr1);  // trueconsole.log(0 in arr2);  // false</code></pre><h3 id="数组的方法"><a href="#数组的方法" class="headerlink" title="数组的方法"></a>数组的方法</h3><p>Array.prototype.join(separator)</p><pre><code>// Array.prototype.join(separator)方法：将数组拼接成字符串，返回字符串，不改变原数组var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];console.log(arr.join());  // a,b,cconsole.log(arr.join(&apos;_&apos;));  // a,b,cfunction repeatString(str, n) {    return new Array(n + 1).join(str);}console.log(repeatString(&apos;a&apos;, 3));  // aaaconsole.log(repeatString(&apos;Hi&apos;, 5));  // HiHiHiHiHi</code></pre><p>Array.prototype.reverse()</p><pre><code>// Array.prototype.reverse() 将数组逆序，返回数组本身，会改变数组本身var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];var arr1 = arr;var arr2 = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];console.log(arr.reverse());  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]console.log(arr);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]console.log(arr1);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]console.log(arr2);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]</code></pre><p>Array.prototype.sort(sortby）</p><pre><code>// Array.prototype.sort(sortby)方法：接受一个函数参数(不传参数默认按字符编码顺序)，返回数组本身，会修改原数组var arr = [&apos;f&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;a&apos;];console.log(arr.sort());  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]var arr = [13, 24, 51, 3];console.log(arr.sort());  // [ 13, 24, 3, 51 ]// 传入参数：比较函数(a, b)// 若 a 小于 b，在排序后的数组中 a 应该出现在 b 之前，则返回一个小于 0 的值。// 若 a 等于 b，则返回 0。// 若 a 大于 b，则返回一个大于 0 的值。function sortNumber(a, b) {    return a - b;}console.log(arr.sort(sortNumber));  // [ 3, 13, 24, 51 ]var arr = [{age: 25}, {age: 29}, {age: 40}];console.log(arr.sort(function sortAge(a, b) {    return a.age - b.age;}));  // [ { age: 25 }, { age: 29 }, { age: 40 } ]</code></pre><p>Array.prototype.concat(arrayX, arrayY…..)</p><pre><code>// Array.prototype.concat(arrayX, arrayY.....)方法 连接多个数组，返回一个新的数组，不会改变原数组var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];console.log(arr.concat(&apos;d&apos;, &apos;e&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]console.log(arr.concat([&apos;d&apos;, &apos;e&apos;], &apos;f&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]console.log(arr.concat([&apos;d&apos;, &apos;e&apos;], [&apos;f&apos;, &apos;g&apos;]));  // &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos; ]console.log(arr.concat([[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ]console.log(arr.concat([[[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;], &apos;g&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ], &apos;g&apos; ]</code></pre><p>Array.prototype.slice(start, end)</p><pre><code>// Array.prototype.slice(start, end)方法：左闭右开截取数组，返回一个新的数组，不改变原数组var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.slice(1, 3));  // [&apos;b&apos;, &apos;c&apos;]console.log(arr.slice(1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;]console.log(arr.slice(1, -1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;]console.log(arr.slice(-4, -3));  // [&apos;b&apos;]</code></pre><p>Array.prototype.splice(index, howmany, item1,….itemX)</p><pre><code>// Array.prototype.splice(index, howmany, item1,....itemX)方法：// 向/从数组中添加/删除项目，然后返回被删除的项目。会改变原数组// index参数：必须，整数，添加或删除的位置，左闭合// howmany参数：可选，设置为0，则不会删除// item1,.....itemX：可选，向数组中添加的元素var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice(2));   // [ &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]console.log(arr);  // [ &apos;a&apos;, &apos;b&apos; ]var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice(2, 1));  // [ &apos;c&apos; ]console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos; ]var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice(2, 0));  // []console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice(2, 2, &apos;f&apos;, &apos;g&apos;, [&apos;h&apos;, &apos;i&apos;]));  // [ &apos;c&apos;, &apos;d&apos; ]console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;g&apos;, [ &apos;h&apos;, &apos;i&apos; ], &apos;e&apos; ]// 指定位置插入新的元素var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice(2, 0, &apos;f&apos;));  // []console.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];console.log(arr.splice());  // []console.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]</code></pre><p>Array.prototype.forEach()</p><pre><code>// Array.prototype.forEach()方法(ES5)：接收函数参数// 函数的3个参数x: 元素值，index：元素索引，a 数组本身var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];arr.forEach(function(x, index, a) {    console.log(x + &apos;_&apos; + index + &apos;_&apos; + a);});// a_0_a,b,c,d,e b_1_a,b,c,d,e c_2_a,b,c,d,e d_3_a,b,c,d,e e_4_a,b,c,d,e</code></pre><p>Array.prototype.map()</p><pre><code>//Array.prototype.map()方法(ES5):接收函数参数,不会修改原数组var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];var arr1 = arr.map(function(x) {    return x + &apos;like&apos;;});console.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]console.log(arr1);  // [ &apos;alike&apos;, &apos;blike&apos;, &apos;clike&apos; ]</code></pre><p>Array.prototype.filter()</p><pre><code>// Array.prototype.filter()过滤方法(ES5):接收函数参数，不修改原数组var arr = [1,2,3,4,5,6,7,8,9,10];var arr1 = arr.filter(function(x, index) {    return index % 3 === 0 || x &gt;= 8;});console.log(arr1);  // [ 1, 4, 7, 8, 9, 10 ]console.log(arr);  // [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]</code></pre><p>Array.prototype.every() &amp; Array.prototype.some()</p><pre><code>// Array.prototype.every() &amp; Array.prototype.some()判断方法(ES5):接收函数参数，不修改原数组// every 全部符合条件  some 只需一个符合条件var arr = [1,2,3,4,5];console.log(arr.every(function(x) {    return x &lt; 10;}));  // trueconsole.log(arr.every(function(x) {    return x &lt;= 3;}));  // falseconsole.log(arr.some(function(x) {    return x === 3;}));  // trueconsole.log(arr.some(function(x) {    return x === 100;}));  // false</code></pre><p>Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)</p><pre><code>// Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)方法// 接收一个函数参数和一个数组索引参数，并返回一个值，不修改原数组// 函数参加接收2个参数分别代表2个索引// 索引参数表示从第index个元素开始var arr = [1, 2, 3];var sum = arr.reduce(function(x, y) {    return x + y;}, 0);console.log(sum);  // 6  1+2返回3 3+3 返回6var arr = [3, 9, 6];var max = arr.reduce(function(x, y) {    console.log(x + &apos;|&apos; + y);    return x &gt; y ? x : y;});// 3|9// 9|6console.log(max);  // 9var max = arr.reduceRight(function(x, y) {    console.log(x + &apos;|&apos; + y);    return x &gt; y ? x : y;});// 6|9// 9|3console.log(max);  // 9</code></pre><p>Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)</p><pre><code>// Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)数字检索方法// value参数表示要查找的元素值，index表示从第几个索引位置开始查找(闭合)var arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;b&apos;, &apos;a&apos;];console.log(arr.indexOf(&apos;b&apos;));  // 1 在数组中查找是否有元素值为&apos;b&apos;，有则返回这个元素索引console.log(arr.indexOf(&apos;f&apos;));  // -1 如果没有则返回-1console.log(arr.indexOf(&apos;b&apos;, 1));  // 1 从第2个元素开始查找，返回索引1console.log(arr.indexOf(&apos;b&apos;, 2));  // 3console.log(arr.indexOf(&apos;b&apos;, -2));  // 3console.log(arr.indexOf(&apos;b&apos;, -4));  // 1console.log(arr.indexOf(&apos;b&apos;, -8));  // 1console.log(arr.lastIndexOf(&apos;b&apos;));  // 3</code></pre><p>Array.isArray()</p><pre><code>// Array.isArray() 判断是否为数组console.log(Array.isArray([]));  // true</code></pre><h3 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h3><pre><code>// 函数声明function add(a, b) {    a = +a;    b = +b;    if (isNaN(a) || isNaN(b)) {        return;    }    return a + b;}// 函数表达式var add = function(a, b) {    // do sth};// IEF(立即执行函数表达式)(function() {    // do sth})();// 函数表达式return function () {    // do sth};// NFE(命名式函数表达式)var add = function foo(a, b) {    // do sth};</code></pre><p><strong>函数声明和函数表达式区别：函数声明会前置</strong></p><pre><code>var num = add(1, 2);console.log(num);function add(a, b) {    a = +a;    b = +b;    if (isNaN(a) || isNaN(b)) {        return;    }    return a + b;}// 结果为3var num = add(1, 2);console.log(num);var add = function (a, b) {    a = +a;    b = +b;    if (isNaN(a) || isNaN(b)) {        return;    }    return a + b;};// TypeError: add is not a function</code></pre><h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><p>全局下的this</p><pre><code>// 全局下的this(浏览器下)console.log(this.window === document);  // trueconsole.log(this === window);  // truethis.a = 37;console.log(window.a);  // 37</code></pre><p>一般函数的this</p><pre><code>// 一般函数的this（浏览器下）function f1() {    return this;}f1() === window;  // truefunction f2() {    &quot;use strict&quot;;  // 严格模式下    return this}f2() === undefined;  // true</code></pre><p>作为对象方法的函数的this</p><pre><code>var o = {    prop: 37,    f: function() {        return this.prop;    }};console.log(o.f());  // 37var o = {prop: 37};function  independent() {    return this.prop;}o.f = independent;console.log(o.f());  // 37</code></pre><p>原型链上的this</p><pre><code>var o = {    f: function() {        return this.a + this.b;    }};var p = Object.create(o); // p为空对象，其原型会指向op.a = 1;p.b = 4;console.log(p.f())  // 5</code></pre><p>构造器中的this</p><pre><code>// 当new的函数构造器没有return返回值或者返回值不是对象时，new返回一个this指向构造器的prototype这样一个空对象// 如果return返回的是对象 new返回的这是这个对象function Myclass() {    this.a = 37;}var o = new Myclass();console.log(o.a);  // 37function C2() {    this.a = 37;    return {a: 38};}o = new C2();console.log(o.a);  // 38</code></pre><p>call和apply的this</p><pre><code>function add(c, d) {    return this.a + this.b + c + d;}var o = {a: 1, b: 2};add.call(o, 5, 6);  // 1+3+5+7=16add.apply(o, [10, 20]);  //1+3+10+20=34function bar() {    console.log(Object.prototype.toString.call(this));}bar.call(7); // [object Number]</code></pre><p>band和this</p><pre><code>//bind是es5后，ie9+使用function f() {    return this.a;}var g = f.bind({a: &apos;test&apos;});console.log(g());  // testvar o = {    a: 37,    f: f,    g: g};console.log(o.f(), o.g());  // 37, test</code></pre><p>函数arguments属性</p><pre><code>function foo(x, y, z) {    arguments.length;  // 2 实际传入的参数数量    arguments[0];  // 1 传入第一个参数值    arguments[0] = 10;    x;  // 10 将第一个参数值修改为10， 严格模式下任然是1    arguments[2] = 100;    z; // undefined  由于第三个参数没有传入，不会绑定    arguments.callee  === foo;  // true   严格模式下不能使用}foo(1, 2);foo.length;  // 3   3个参数foo.name;  // &quot;foo&quot; 函数名</code></pre><h3 id="call和apply"><a href="#call和apply" class="headerlink" title="call和apply"></a>call和apply</h3><pre><code>// apply和call方法（浏览器）// 第一个参数是作为this的对象，如果不是对象，会转换为对象// call传入的是扁平传入参数// apply第二个参数树数组function foo(x, y) {    console.log(x, y, this);}foo.call(100, 1, 2);  // 1, 2, Number(100)foo.apply(true, [3, 4]);  //3, 4, Boolean(true)foo.apply(null);  // undefined, undefined, windowfoo.apply(undefined);  // undefined, undefined, window</code></pre><h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p>bind方法：改变this</p><pre><code>// bind方法this.x = 9;var module = {    x: 81,    getX: function() {        return this.x;    }};module.getX();  // 81 this指向modulevar getX = module.getX;getX();  // 9 this指向全局变量var boundGetX = getX.bind(module);boundGetX();  // 81  bind改变this指向</code></pre><p>bind方法：科里化</p><pre><code>// bind方法function add(a, b, c) {    return a+b+c;}var func = add.bind(undefined, 100);func(1, 2);  // 103  undefined传给this， 100传给第一个参数avar func2 = func.bind(undefined, 200);func2(10);  // 310 undefined传给this，200传给b</code></pre><p>bind与new</p><pre><code>// bind方法与newfunction foo() {    this.b = 100;    return this.a;}var func = foo.bind({a: 1});func(); // 1  foo.bind后this指向{a: 1} return this.a = 1new func();  // {b: 100} new调用将返回一个this，this会被初始化一个空对象，并且其原型是foo.prototype,空对象的b属性为100</code></pre><h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>闭包基本概念</p><pre><code>// 闭包var n = 999;function f1() {    console.log(n);}f1();  // 999  函数内部可以访问全局变量function f1() {    var n = 999;}console.log(n);  // error  函数外部无法访问函数内部局部变量function f1() {    n = 999;}console.log(n); // 999 因为没有使用var语句，相当于定义一个全局变量// 简单的闭包原型function f1() {    var n = 999;    function f2() {        console.log(n);    }    return f2}var result = f1();result();  // 999</code></pre><p>闭包案例</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Title&lt;/title&gt;    &lt;style&gt;        #div1 {            background-color: rosybrown;        }        #div2 {            background-color: aquamarine;        }        #div3 {            background-color: yellowgreen;        }    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;    for(var i = 1; i &lt; 4; i++) {        alert(i);  // 结果为1，2，3        document.getElementById(&apos;div&apos; + i).                addEventListener(&apos;click&apos;, function() {            alert(i);  // 点击div1，div2，div3结果都是4,因为addEventListener的回调函数执行时i都为4        });    }&lt;/script&gt;&lt;/html&gt;</code></pre><p>正确写法</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Title&lt;/title&gt;    &lt;style&gt;        #div1 {            background-color: rosybrown;        }        #div2 {            background-color: aquamarine;        }        #div3 {            background-color: yellowgreen;        }    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;    for(var i = 1; i &lt; 4; i++) {        !function(i) {            alert(i);  // 1,2,3            document.getElementById(&apos;div&apos; + i).               addEventListener(&apos;click&apos;, function() {                   alert(i);  // 1, 2,3             });        }(i);    }&lt;/script&gt;&lt;/html&gt;</code></pre><p>闭包中的封装</p><pre><code>(function() {    var _userID = 23245;    var _typeID = &apos;item&apos;;    var exportID = {};    function converter(userID) {        return +userID;    }    exportID.getUserID = function() {        return converter(_userID);    };    exportID.getTypeID = function() {        return _typeID;    };    global.exportID = exportID;}());console.log(exportID.getUserID());  //23245console.log(exportID._userID);  // undefined</code></pre><h3 id="三种作用域"><a href="#三种作用域" class="headerlink" title="三种作用域"></a>三种作用域</h3><pre><code>// 作用域： 全局作用域，函数作用域，eval作用域var a = 10;(function() {    var b = 20;})();console.log(a);  // 10console.log(b);  // errorfor(var item in {a: 1, b: 2}) {    console.log(item);  // a, b}console.log(item); // b</code></pre><h3 id="ES3中的执行上下文"><a href="#ES3中的执行上下文" class="headerlink" title="ES3中的执行上下文"></a>ES3中的执行上下文</h3><p>EC = Execution Context 执行上下文<br>变量对象（Variable Object 简写VO）是一个抽象概念，用于存储执行上下文中的变量，函数声明，函数参数</p><pre><code>var a = 10;function test(x) {    var b = 20;}test(30);</code></pre><p>对应的上下文</p><pre><code>// 整个js环境中的VOVO(globalContext) = {    a: 10,    test: &lt;ref to function&gt;};// 执行test(30)的VOVO(test functionContext) = {    x: 30,    b: 20};</code></pre><p>全局执行上下文</p><pre><code>VO(globalContext) === [[global]][[global]] = {    Math : &lt;...&gt;,    String : &lt;...&gt;,    isNaN: function() {[Native Code]},    ...    ...    window: global};String(10);  //[[global]].String(10)window.a = 10;  // [[global]].window.a = 10this.b = 20;  // [[global]].b = 20</code></pre><p>变量初始化阶段</p><pre><code>// 1, 函数参数（若没有传入，则其值为undefined）// 2, 函数声明（若函数声明和函数参数冲突，则函数声明会覆盖掉函数参数）// 3，变量声明（初始化变量值为undefined，若何函数参数，函数声明冲突，会被忽略掉）function test(a, b) {    var c = 10;    function d() {}    var e = function _e() {};    (function x() {});    b = 20;}test(10);AO(test) = {    a: 10,    b: undefined,    c: undefined,    d: &lt;ref to func &apos;d&apos;&gt;,    e: undefined,};</code></pre><p>变量初始化案例1</p><pre><code>function foo(x, y, z) {    function x() {}    console.log(x);}foo(100);  // [Function: x]//AO(foo) = {    //x: 100,    y: undefined,    z: undefined,    x: &lt;ref to func &apos;x&apos;&gt;,  // 函数声明x会覆盖掉参数声明 }</code></pre><p>变量初始化案例2</p><pre><code>function foo(x, y, z) {    function func() {}    var func;    console.log(func);}foo(100);  // [Function: func]function foo(x, y, z) {    function func() {}    var func = 1;    console.log(func);}foo(100);  // 1  执行阶段会执行func = 1 这个语句</code></pre><p>代码执行阶段</p><pre><code>function test(a, b) {    var c = 10;    function d() {}    var e = function _e() {};    (function x() {})();    b = 20;}// 初始化阶段AO(test) = {    a: 10,    b: undefined,    c: undefined,    d: &lt;ref to func &apos;d&apos;&gt;,    e: undefined};// 代码执行阶段AO(test) = {    a: 10,    b: 20,    c: 10,    d: &lt;reference to FunctionDeclaration &apos;d&apos;&gt;,    e: function _e()};</code></pre><p>全局执行上下文案例</p><pre><code>console.log(x);  // [Function: x]var x = 10;  // 初始化阶段x: 冲突，被忽略console.log(x);  // 10x = 20;function x() {}  // 初始化阶段x: &lt;ref to func &apos;x&apos;&gt;console.log(x);  // 20if (true) {    var a = 1;  // 初始化阶段a: undefined} else {    var b = true;  // 初始化阶段b: undefined}console.log(a);  // 1console.log(b);  // undefined</code></pre><h3 id="prototype"><a href="#prototype" class="headerlink" title="prototype"></a>prototype</h3><p>prototype是函数对象上的预设的对象属性<br>原型是对象上的原型，通常都是构造器的prototype属性<br>实例</p><pre><code>function Abc() {    this.y = 2;    var z = 3;}console.log(Abc);  // [Function: Abc]console.log(Abc.prototype);  // Abc {}console.log(typeof Abc.prototype);  // objectAbc.prototype.x = 1;console.log(Abc.prototype);  // Abc { x: 1 }var obj1 = new Abc();console.log(obj1.__proto__);  // Abc { x: 1 }console.log(obj1.__proto__ === Abc.prototype);  // true  new构造器创建的对象的原型是构造器的prototype属性console.log(obj1);  // Abc { y: 2 }console.log(obj1.y);  // 2console.log(obj1.x);  // 1</code></pre><h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>实现继承的方法</p><pre><code>// 实现继承的方法function Person() {}function Student() {}Student.prototype = Person.prototype;  // 错误，会影响被继承类的方法Student.prototype = new Person();  // 错误，传参问题，因为Student是类，并不是实例// 正确的方法Student.prototype = Object.create(Person.prototype);Student.prototype.constructor = Student;// Object.create()是es5的方法，下面是fix方法if(!Object.create) {    Object.create = function(proto) {        function F() {}        F.prototype = proto;        return new F;    };}</code></pre><p>原型的继承方法</p><pre><code>function Person(name, age) {    this.name = name;    this.age = age;    this.sayNo = function() {        console.log(this.name + &apos; say no&apos;);    }}Person.prototype.hi = function() {    console.log(&apos;Hi, my name is &apos; + this.name + &apos;,I\&apos;m &apos; + this.age + &apos; years old now&apos;);};Person.prototype.LEGS_NUM = 2;Person.prototype.ARMS_NUM = 2;Person.prototype.walk = function() {    console.log(this.name + &apos; is walking...&apos;);};console.log(Person);  // [Function: Person]console.log(Person.prototype);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }var Jack = new Person();  // Person构造器没有return对象，所以返回的是thisJack.sayNo();  // undefined say noJack.hi();  // Hi, my name is undefined,I&apos;m undefined years old nowJack.walk();  // undefined is walking...console.log(Jack);  // Person { name: undefined, age: undefined, sayNo: [Function] }console.log(Jack.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }// 以下5行代码是js中对象继承的写法function Student(name, age, className) {    Person.call(this, name, age);  // 使用call方法调用父构造器函数    this.className = className;}Student.prototype = Object.create(Person.prototype);   // 这个如果直接使用Student.prototype = Person.prototype，改变Student对象方法会改变Person对象的方法，因为他们指向的是同一个对象Student.prototype.constructor = Student;Student.prototype.hi = function() {    console.log(&apos;Hi, my name is &apos; + this.name + &apos;, I\&apos;m&apos; + this.age + &apos; years old now, and from &apos; + this.className + &apos;.&apos;);};Student.prototype.learn = function(subject) {    console.log(this.name + &apos; is learning &apos; + subject + &apos; at &apos; + this.className + &apos;.&apos;);};var Lussi = new Student(&apos;Lussi&apos;, 27, &apos;Class Tree&apos;);Lussi.sayNo();  // Lussi say noLussi.hi();  // Hi, my name is Lussi, I&apos;m27 years old now, and from Class Tree.Lussi.walk();  // Lussi is walking...Lussi.learn(&apos;math&apos;);  // Lussi is learning math at Class Tree.console.log(Lussi);  // Student {name: &apos;Lussi&apos;, age: 27, sayNo: [Function], className: &apos;Class Tree&apos; }console.log(Lussi.__proto__);  // Student {constructor: [Function: Student], hi: [Function], learn: [Function] }console.log(Lussi.__proto__.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }console.log(Lussi.__proto__.__proto__.__proto__);  // {}console.log(Lussi.__proto__.__proto__.__proto__.__proto__);  // null  // 改变prototypeStudent.prototype.x = 101;  // 会影响已经创建实例的属性console.log(Jack.x);  // undefinedconsole.log(Lussi.x);  // 101Student.prototype = {y: 2};  // 不会影响已经创建实例的属性，但会影响新创建的实例，并且重新修改prototype.y属性也不会改变console.log(Jack.y); // undefinedconsole.log(Lussi.y);  // undefinedvar Lilei = new Student(&apos;Lilei&apos;, 24, &apos;Class three&apos;);console.log(Lilei.x);  // undefinedconsole.log(Lilei.y);  // 2Student.prototype.y = 100;console.log(Lilei.y);  // 100console.log(Lussi.y);  // undefinedStudent.prototype.z = 30;console.log(Lilei.z);  // 30console.log(Lussi.z);  // undefinedPerson.prototype.z = 40;console.log(Lilei.z);  // 30console.log(Lussi.z);  // 40console.log(Jack.z);  // 40</code></pre><h3 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h3><pre><code>// instanceof  左边是对象（如果不是，直接返回false），右边是构造器（如果不是，直接报错），判断构造器的prototype属性是否在对象的原型链上console.log([1, 2] instanceof Array);  // trueconsole.log(1 instanceof Array);  // falseconsole.log(Array.prototype);  // []console.log(new Object() instanceof Array);  //falseconsole.log(Object.prototype);  // {}console.log(new Object() instanceof Object);  // trueconsole.log(new Array() instanceof Object);  // true</code></pre><h3 id="模拟重载"><a href="#模拟重载" class="headerlink" title="模拟重载"></a>模拟重载</h3><pre><code>function Person() {    var args = arguments;    // 判断第一个传入的是不是对象，因为args[null]也返回object，所有需要判断是否为null    if(typeof args[0] === &apos;object&apos; &amp;&amp; args[0]) {        if(args[0].name) {            this.name = args[0].name;        }        if(args[0].age) {            this.age = args[0].age;        }    } else {        if(args[0]) {            this.name = args[0];        }        if(args[1]) {            this.age = args[1];        }    }}Person.prototype.toString = function() {    console.log(&apos;name=&apos; + this.name + &apos;, age=&apos; + this.age);};var LiLei = new Person(&apos;LiLei&apos;, 23);var Hanmm = new Person({name: &apos;Hanmm&apos;, age: 21});LiLei.toString();  // name=LiLei, age=23Hanmm.toString();  // name=Hanmm, age=21</code></pre><h3 id="调用子类方法"><a href="#调用子类方法" class="headerlink" title="调用子类方法"></a>调用子类方法</h3><pre><code>function Person(name) {    this.name = name;}function Student(name, className) {    this.className = className;    Person.call(this, name);}Person.prototype.init = function() {    console.log(&apos;Person.init&apos;);};Student.prototype.init = function() {    console.log(&apos;Student.init&apos;);    Person.prototype.init.apply(this, arguments);};var LiLei = new Student(&apos;LiLei&apos;, &apos;Class four&apos;);console.log(LiLei);  // Student { className: &apos;Class four&apos;, name: &apos;LiLei&apos; }LiLei.init();  // Student.init  Person.init</code></pre><h3 id="实现链式调用"><a href="#实现链式调用" class="headerlink" title="实现链式调用"></a>实现链式调用</h3><pre><code>function ClassManager() {    console.log(&apos;ClassManager&apos;);    this.name = &apos;ClassName&apos;;}ClassManager.prototype.addClass = function(str) {    console.log(&apos;class: &apos;  + str + &apos; added.&apos;);    console.log(this);    return this;  // this始终指向ClassManger类的实例};var manager = new ClassManager();manager.addClass(&apos;A&apos;).addClass(&apos;B&apos;).addClass(&apos;C&apos;);  //class: A added. ClassManager { name: &apos;ClassName&apos; } class: B added. ClassManager { name: &apos;ClassName&apos; } class: C added. ClassManager { name: &apos;ClassName&apos; }</code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>css兼容性汇总</title>
      <link href="/2016/11/10/css%E5%85%BC%E5%AE%B9%E6%80%A7%E6%B1%87%E6%80%BB/"/>
      <url>/2016/11/10/css%E5%85%BC%E5%AE%B9%E6%80%A7%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h3 id="ie6-ie7中overflow-hidden失效问题"><a href="#ie6-ie7中overflow-hidden失效问题" class="headerlink" title="ie6,ie7中overflow:hidden失效问题"></a>ie6,ie7中overflow:hidden失效问题</h3><p>在父元素中使用position:relative;可以hack iframe自适应高度</p><h3 id="不建议使用iframe"><a href="#不建议使用iframe" class="headerlink" title="不建议使用iframe"></a>不建议使用iframe</h3><p>首先在css里面设置一个min-height</p><pre><code>min-height: 100px;</code></pre><p>主页面嵌入如下js代码</p><pre><code>&lt;script&gt;    function setIframeHeight(iframe) {        if (iframe) {            var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;            if (iframeWin.document.body) {                iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;            }        }    };    window.onload = function () {        setIframeHeight(document.getElementById(&apos;external-frame&apos;));    };&lt;/script&gt;</code></pre><p>iframe标签里</p><pre><code>&lt;iframe src=&quot;backtop.html&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; id=&quot;external-frame&quot; onload=&quot;setIframeHeight(this)&quot;&gt;&lt;/iframe&gt;</code></pre><p>css代码</p><pre><code>ul {  display: block;  width: 100%;  height: 100%;  text-indent: 0;  padding: 0;  position: absolute;  top: -100%;  left: 0;    }</code></pre><p>js代码</p><pre><code>var defaultTopPosition = $(&apos;#indexCellcate&apos;).css(&apos;top&apos;);</code></pre><p>浏览器差异</p><pre><code>ie7，ie8 返回-205.422px  现代chrome，firefox -205.422px  但是ie9及以上会返回0px </code></pre><p>如果将css中的top设置为-205.422px，则无差异。<br>但响应式布局要求百分百设置,我的解决思路:<br>获取对应元素的高度来替代top值</p><pre><code>var defaultTopPosition = cellcate.children(&apos;li&apos;).height();defaultTopPosition = -parseInt(defaultTopPosition);</code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>windowsserver服务器基础设置</title>
      <link href="/2016/11/09/windowsserver%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E8%AE%BE%E7%BD%AE/"/>
      <url>/2016/11/09/windowsserver%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h3><p>禁止administrators组远程连接</p><blockquote><p>运行gpedit.msc<br>计算机配置-&gt;windows设置-&gt;安全设置-&gt;本地策略-&gt;用户权限分配-&gt;通过终端服务允许登录<br>将Administrators账号删除掉,保留Remote Desktop Users</p></blockquote><p>创建新的用户</p><blockquote><p>本地用户和组-&gt;用户右键-&gt;新用户-&gt;输入用户名，设置密码 添加Administrators组，Remote Desktop Users组</p></blockquote><p>限制登陆次数</p><blockquote><p>计算机配置-&gt;windows设置-&gt;安全设置-&gt;账户策略-&gt;账户锁定策略”，“账户锁定阈值”设置为 20后，系统会自动设置锁定时间和计数器</p></blockquote><p>3389端口修改</p><blockquote><p>修改注册表，是不是需要修改？</p></blockquote><p>超过2个远程连接处理办法及规避方法</p><pre><code>mstsc /console /v:10.10.10.10:3389</code></pre><blockquote><p>开始－管理工具－终端服务配置－服务器配置－限制每个用户使用一个会话</p></blockquote><h3 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h3><p>开启防火墙</p><blockquote><p>控制面板&gt;防火墙&gt;开启<br>例外里勾选远程桌面,保证服务器可以正常连接<br>其他情况就在添加端口里添加即可</p></blockquote><h3 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h3><p>开启ftp</p><blockquote><p>在控制面板的添加/删除程序——Windows组件向导——应用程序服务器——Internet信息服务(IIS)中选中“文件传输协议(FTP)服务”。<br>需要文件夹AMD64 设置一个ftp用户ftpuser<br>在ftp设置中关掉允许匿名连接<br>主目录中本地路径为E:\FTP<br>不要勾选写入权限<br>默认ftp站点新建虚拟目录ftpuser 路径E:\FTP\ftpuser<br>在防火墙上开启20，21端口 在ftp客户端选择port主动模式，主动模式不需要服务器开启其他端口</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>thinkphp入门基础</title>
      <link href="/2016/11/09/thinkphp%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/thinkphp%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><h3 id="配置URL伪静态"><a href="#配置URL伪静态" class="headerlink" title="配置URL伪静态"></a>配置URL伪静态</h3><p>3.1版本默认支持.html,.shtml,.xml,.pdf伪静态<br>在配置文件中配置[是在项目下的配置文件./App/Conf/config.php]</p><pre><code>&apos;URL_HTML_SUFFIX&apos;=&gt;&apos;html|shmtl|xml&apos; // 多个用 | 分割</code></pre><h3 id="配置URL路由"><a href="#配置URL路由" class="headerlink" title="配置URL路由"></a>配置URL路由</h3><p>基本规则</p><blockquote><p>一、规则路由<br>格式1：’路由规则’=&gt;’[分组/模块/操作]?额外参数1=值1&amp;额外参数2=值2…’<br>格式2：’路由规则’=&gt;array(‘[分组/模块/操作]‘,’额外参数1=值1&amp;额外参数2=值2…’)<br>格式3：’路由规则’=&gt;’外部地址’<br>格式4：’路由规则’=&gt;array(‘外部地址’,’重定向代码’)<br>注意事项：<br>路由规则中如果以“:”开头，表示动态变量，否则为静态地址<br>格式2的额外参数可以传入数组或者字符串<br>外部地址中如果要引用动态变量， 采用 :1、:2 的方式<br>路由规则支持变量的数字约束定义，例如：’news/:id\d’=&gt;’News/read’<br>规则路由可以支持 全动态和动静结合定义，例如’:user/blog/:id’=&gt;’Home/Blog/user’<br>路由规则非数字变量支持排除，例如 ‘news/:cate^add|edit|delete’=&gt;’News/category’<br>路由规则中的静态地址部分不区分大小写</p></blockquote><p>配置文件开启路由</p><pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由&apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则    &apos;news/:year/:month/:day&apos; =&gt; array(&apos;News/archive&apos;, &apos;status=1&apos;),    &apos;news/:id&apos;               =&gt; &apos;News/read&apos;,    &apos;news/read/:id&apos;          =&gt; &apos;/news/:1&apos;, ),</code></pre><blockquote><p><code>http://serverName/index.php/news/2012/01/08</code>匹配第一条路由<br>也可以写成<code>&#39;news/:year/:month/:day/&#39;=&gt;&#39;News/archive?status=1&#39;,</code> <code>http://serverName/index.php/news/8</code>匹配第二条路由 第三条用于url地址迁移，重定向使用</p></blockquote><h3 id="正则路由"><a href="#正则路由" class="headerlink" title="正则路由"></a>正则路由</h3><blockquote><p>正则路由可以实现更加复杂的路由定义，支持的定义格式如下：<br>格式1：’路由正则’=&gt;’[分组/模块/操作]?参数1=值1&amp;参数2=值2…’<br>格式2：’路由正则’=&gt;array(‘[分组/模块/操作]‘,’参数1=值1&amp;参数2=值2…’)<br>格式3：’路由正则’=&gt;’外部地址’<br>格式4：’路由正则’=&gt;array(‘外部地址’,’重定向代码’)</p></blockquote><p>注意事项：<br>正则路由规则必须以“/”开始和结束<br>格式2的参数可以传入数组或者字符串<br>参数值和外部地址中可以用动态变量 采用 :1、 :2 的方式<br>下面是正则路由的定义示例：</p><pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由 &apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则    &apos;/^blog\/(\d+)$/&apos;        =&gt; &apos;Blog/read?id=:1&apos;,    &apos;/^blog\/(\d+)\/(\d+)$/&apos; =&gt; &apos;Blog/achive?year=:1&amp;month=:2&apos;,    &apos;/^blog\/(\d+)_(\d+)$/&apos;  =&gt; &apos;blog.php?id=:1&amp;page=:2&apos;, ), <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">    ### URL区分大小写</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;URL\_CASE\_INSENSITIVE&apos; =&gt;true, // 不区分 &apos;URL\_CASE\_INSENSITIVE&apos; =&gt;false, // 区分</span><br><span class="line"></span><br><span class="line">    ### 缓存</span><br><span class="line">    ### 静态缓存</span><br><span class="line">    开启静态缓存[是在分组下的配置文件./App/Moduels/Index/Conf/config.php]  </span><br><span class="line">    和静态缓存相关的配置参数包括：  </span><br><span class="line">    HTML_CACHE_ON 是否开启静态缓存功能  </span><br><span class="line">    HTML_FILE_SUFFIX 静态文件后缀 惯例配置的值是 .html  </span><br><span class="line">    HTML_CACHE_TIME 默认的静态缓存有效期 默认60秒 可以在静态规则定义覆盖  </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;HTML\_CACHE\_ON&apos;=&gt;true, &apos;HTML\_CACHE\_RULES&apos;=&gt; array( &apos;ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写)&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写):ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;*&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;Show:index&apos; =&gt; array(&apos;&#123;:module&#125;_&#123;:action&#125;_&#123;id&#125;&apos;, 100),</span><br><span class="line"></span><br><span class="line">    所有控制器下read方法缓存，其中，&#123;id&#125; 表示取$_GET[&apos;id&apos;] 为静态缓存文件名，第二个参数表示缓存60秒</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,&apos;60&apos;)</span><br><span class="line"></span><br><span class="line">    User控制器下所有方法缓存，其中，&#123;:action&#125; 表示当前的操作名称</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;user:&apos;=&gt;array(&apos;User/&#123;:action&#125;_&#123;id&#125;&apos;,&apos;600&apos;)</span><br><span class="line"></span><br><span class="line">    Blog控制器下read方法缓存</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;blog:read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,0)</span><br><span class="line"></span><br><span class="line">    全局缓存</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&apos;*&apos;=&gt;array(&apos;&#123;$\_SERVER.REQUEST\_URI|md5&#125;&apos;),</span><br><span class="line"></span><br><span class="line">    静态规则  </span><br><span class="line">    1.  使用系统变量 包括 _GET _REQUEST _SERVER _SESSION _COOKIE</span><br><span class="line">    &gt; &#123;$_×××|function&#125;</span><br><span class="line">    </span><br><span class="line">    2.  使用框架特定的变量</span><br><span class="line">    &gt; &#123;:app&#125;、&#123;:group&#125; 、&#123;:module&#125; 和&#123;:action&#125; 分别表示当前项目名、分组名、模块名和操作名</span><br><span class="line">    </span><br><span class="line">    3.  使用_GET变量</span><br><span class="line">    &gt; &#123;var|function&#125;    也就是说 &#123;id&#125; 其实等效于 &#123;$_GET.id&#125;</span><br><span class="line">    </span><br><span class="line">    4.  直接使用函数</span><br><span class="line">    &gt; &#123;|function&#125;   例如：&#123;|time&#125;</span><br><span class="line">    </span><br><span class="line">    5.  支持混合定义</span><br><span class="line">    &gt; &apos;&#123;id&#125;,&#123;name|md5&#125;&apos;   </span><br><span class="line">    在&#123;&#125;之外的字符作为字符串对待，如果包含有”/”，会自动创建目录。  </span><br><span class="line">    例如，定义下面的静态规则：  </span><br><span class="line">    &#123;:module&#125;/&#123;:action&#125;_&#123;id&#125;  </span><br><span class="line">    则会在静态目录下面创建模块名称的子目录，然后写入操作名_id.shtml 文件。    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    使用get中文参数乱码问题</span><br><span class="line">    ### 原因</span><br><span class="line">    中文浏览器中默认使用的是gbk2312编码</span><br><span class="line">    </span><br><span class="line">    ### 解决方法</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">/\*\* \* 解决get参数中带中文的乱码问题 * @param $keywords 传入的关键字 * @return string */ function decodeToUtf($keywords) &#123; $keywords = mb\_convert\_encoding($keywords, &apos;UTF-8&apos;,&apos;GB2312,UTF-8&apos;); return $keywords; &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">$keywords = I(&apos;keywords&apos;); $keywords = decodeToUtf($keywords); $page = new Page($count,self::$perPage); $page-&gt;parameter = &apos;keywords=&apos; . $keywords;</span><br></pre></td></tr></table></figure></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法</title>
      <link href="/2016/11/09/windows%E8%BD%AF%E4%BB%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E9%94%99%E8%AF%AF429,ACTIVEX%E9%83%A8%E4%BB%B6%E4%B8%8D%E8%83%BD%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
      <url>/2016/11/09/windows%E8%BD%AF%E4%BB%B6%E8%BF%90%E8%A1%8C%E6%97%B6%E9%94%99%E8%AF%AF429,ACTIVEX%E9%83%A8%E4%BB%B6%E4%B8%8D%E8%83%BD%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h3 id="安装软件出现“ACTIVEX部件不能创建对象”"><a href="#安装软件出现“ACTIVEX部件不能创建对象”" class="headerlink" title="安装软件出现“ACTIVEX部件不能创建对象”"></a>安装软件出现“ACTIVEX部件不能创建对象”</h3><p>提示错误</p><blockquote><p>中文：“运行时错误429，ActiveX部件不能创建对象”<br>英文：”Run-time error ‘429’ ActiveX componnent can’t create object”</p></blockquote><p>新建文件，将下面代码复制粘贴，文件另存为xxx.bat 运行xxx.bat，重启电脑，OK.</p><pre><code>echo 正在修复，这个过程可能需要几分钟，请稍候…… rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\System32\dacui.dll rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\Catroot\icatalog.mdb regsvr32 /s comcat.dll regsvr32 /s asctrls.ocx regsvr32 /s oleaut32.dll regsvr32 /s shdocvw.dll /I regsvr32 /s shdocvw.dll regsvr32 /s browseui.dll regsvr32 /s browseui.dll /I regsvr32 /s msrating.dll regsvr32 /s mlang.dll regsvr32 /s hlink.dll regsvr32 /s mshtml.dll regsvr32 /s mshtmled.dll regsvr32 /s urlmon.dll regsvr32 /s plugin.ocx regsvr32 /s sendmail.dll regsvr32 /s mshtml.dll /i regsvr32 /s scrobj.dll regsvr32 /s corpol.dll regsvr32 /s jscrīpt.dll regsvr32 /s msxml.dll regsvr32 /s imgutil.dll regsvr32 /s cryptext.dll regsvr32 /s inseng.dll regsvr32 /s iesetup.dll /i regsvr32 /s cryptdlg.dll regsvr32 /s actxprxy.dll regsvr32 /s dispex.dll regsvr32 /s occache.dll regsvr32 /s iepeers.dll regsvr32 /s urlmon.dll /i regsvr32 /s cdfview.dll regsvr32 /s webcheck.dll regsvr32 /s mobsync.dll regsvr32 /s pngfilt.dll regsvr32 /s licmgr10.dll regsvr32 /s hhctrl.ocx regsvr32 /s inetcfg.dll regsvr32 /s trialoc.dll regsvr32 /s tdc.ocx regsvr32 /s MSR2C.DLL regsvr32 /s msident.dll regsvr32 /s msieftp.dll regsvr32 /s xmsconf.ocx regsvr32 /s ils.dll regsvr32 /s msoeacct.dll regsvr32 /s wab32.dll regsvr32 /s wabimp.dll regsvr32 /s wabfind.dll regsvr32 /s oemiglib.dll regsvr32 /s directdb.dll regsvr32 /s inetcomm.dll regsvr32 /s msoe.dll regsvr32 /s oeimport.dll regsvr32 /s msdxm.ocx regsvr32 /s dxmasf.dll regsvr32 /s laprxy.dll regsvr32 /s l3codecx.ax regsvr32 /s acelpdec.ax regsvr32 /s mpg4ds32.ax regsvr32 /s danim.dll regsvr32 /s Daxctle.ocx regsvr32 /s lmrt.dll regsvr32 /s datime.dll regsvr32 /s dxtrans.dll regsvr32 /s dxtmsft.dll regsvr32 /s wshom.ocx regsvr32 /s wshext.dll regsvr32 /s vbscrīpt.dll regsvr32 /s scrrun.dll mstinit.exe /setup regsvr32 /s msnsspc.dll /SspcCreateSspiReg regsvr32 /s msapsspc.dll /SspcCreateSspiReg echo. echo. echo 修复成功！任意键退出！ pause&gt;nul</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sublime入门基础</title>
      <link href="/2016/11/09/sublime%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/sublime%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p><a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">http://www.sublimetext.com/3</a></p><h3 id="Ubuntu下载"><a href="#Ubuntu下载" class="headerlink" title="Ubuntu下载"></a>Ubuntu下载</h3><pre><code>sudo add-apt-repository ppa:webupd8team/sublime-text-3sudo apt-get updatesudo apt-get install sublime-text-installer</code></pre><h3 id="插件下载地址"><a href="#插件下载地址" class="headerlink" title="插件下载地址"></a>插件下载地址</h3><p><a href="https://packagecontrol.io/" target="_blank" rel="noopener">https://packagecontrol.io/</a></p><h3 id="注册码"><a href="#注册码" class="headerlink" title="注册码"></a>注册码</h3><pre><code>----- BEGIN LICENSE ----Andrew WeberSingle User LicenseEA7E-855605813A03DD 5E4AD9E6 6C0EEB94 BC99798F942194A6 02396E98 E62C9979 4BB979FE91424C9D A45400BF F6747D88 2FB8807890F5CC94 1CDC92DC 8457107A F151657B1D22E383 A997F016 42397640 33F41CFCE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D5CDB7036 E56DE1C0 EFCC0840 650CD3A6B98FC99C 8FAC73EE D2B95564 DF450523------ END LICENSE ------</code></pre><h3 id="安装Package-Control"><a href="#安装Package-Control" class="headerlink" title="安装Package Control"></a>安装Package Control</h3><pre><code>import urllib.request,os; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), &apos;wb&apos;).write(urllib.request.urlopen( &apos;http://sublime.wbond.net/&apos; + pf.replace(&apos; &apos;,&apos;%20&apos;)).read())</code></pre><h3 id="安装模板Material-Theme"><a href="#安装模板Material-Theme" class="headerlink" title="安装模板Material Theme"></a>安装模板Material Theme</h3><p>配置方法</p><pre><code>Package Control Messages========================Material Theme--------------  Material Theme for Sublime Text 3  For more information on the Material Theme: https://github.com/equinusocio/material-theme  **********************************************************************************************  If installing manually (not through Package Control), add the following to your   Settings - User file and restart Sublime Text after:  {    &quot;theme&quot;: &quot;Material-Theme.sublime-theme&quot;,    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme.tmTheme&quot;,  }  **********************************************************************************************  This theme includes a Darker and Lighter version:  Darker version:  {    &quot;theme&quot;: &quot;Material-Theme-Darker.sublime-theme&quot;,    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Darker.tmTheme&quot;,  }  Lighter version:  {    &quot;theme&quot;: &quot;Material-Theme-Lighter.sublime-theme&quot;,    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Lighter.tmTheme&quot;,  }  **********************************************************************************************  Recommended UI and font settings for a better experience:  {    &quot;overlay_scroll_bars&quot;: &quot;enabled&quot;,    &quot;line_padding_top&quot;: 3,    &quot;line_padding_bottom&quot;: 3,    &quot;always_show_minimap_viewport&quot;: true,    &quot;bold_folder_labels&quot;: true,    &quot;indent_guide_options&quot;: [ &quot;draw_normal&quot;, &quot;draw_active&quot; ]    // Highlight active indent    &quot;font_options&quot;: [ &quot;gray_antialias&quot; ],                       // For retina Mac  }  **********************************************************************************************  Other available theme options:  &quot;material_theme_small_tab&quot;: true,                           // Set small tabs  &quot;material_theme_disable_fileicons&quot;: true,                   // Hide siderbar file type icons  &quot;material_theme_disable_folder_animation&quot;: true,            // Disable folder animation  &quot;material_theme_small_statusbar&quot;: true,                     // Set small status bar  &quot;material_theme_disable_tree_indicator&quot;: true,              // Disable sidebar file indicator  &quot;material_theme_bold_tab&quot;: true,                            // Make the tab labels bolder  &quot;material_theme_tabs_separator&quot;: true,                      // Show tabs separator  &quot;material_theme_accent_lime&quot;: true,                         // set green lime accent color  &quot;material_theme_accent_purple&quot;: true,                       // set purple accent color  &quot;material_theme_accent_red&quot;: true,                          // set pale red accent color  &quot;material_theme_accent_orange&quot;: true,                       // set orange accent color  &quot;material_theme_accent_yellow&quot;: true,                       // set yellow accent color  &quot;material_theme_panel_separator&quot;: true,                     // show bottom panel separator  &quot;material_theme_tabs_autowidth&quot;: true,                      // Enable autowidth for tabs  &quot;material_theme_contrast_mode&quot;: true,                       // Enable sidebar and panels contrast mode</code></pre><h3 id="设置空格缩进"><a href="#设置空格缩进" class="headerlink" title="设置空格缩进"></a>设置空格缩进</h3><pre><code>{        &quot;tab_size&quot;: 4,        &quot;translate_tabs_to_spaces&quot;: true } </code></pre><h3 id="设置行间距"><a href="#设置行间距" class="headerlink" title="设置行间距"></a>设置行间距</h3><pre><code>{    &quot;line_padding_bottom&quot;: 3,     &quot;line_padding_top&quot;: 3,}    </code></pre><h3 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h3><p><strong>Emmet(懂的)</strong><br><strong>ConvertToUtf8(编码转换)</strong><br><strong>Sublime​Linter(代码检查工具，需要配合各语言插件包检查)</strong><br><strong>SideBarEnhancements（侧边栏右键增强）</strong><br><strong>Bracket​Highlighter（显示标签块？？）</strong><br><strong>SublimeCodeIntel(跳转到自定义函数)</strong></p><blockquote><p>For Windows:<br>Jump to definition = Alt+Click<br>Jump to definition = Control+Windows+Alt+Up<br>Go back = Control+Windows+Alt+Left<br>Manual Code Intelligence = Control+Shift+space<br>需要自己设置执行路径</p></blockquote><pre><code>&quot;PHP&quot;: {    &quot;php&quot;: &quot;D:\\PHP\\php.exe&quot;,    &quot;codeintel_scan_extra_dir&quot;: [],    &quot;codeintel_scan_files_in_project&quot;: true,    &quot;codeintel_max_recursive_dir_depth&quot;: 15,    &quot;codeintel_scan_exclude_dir&quot;:[&quot;D:\\PHP&quot;]}</code></pre><p><strong>HTML5(html5的snippets)</strong><br><strong>Alignment(自动对齐插件)</strong><br><strong>SFTP(ftp上传)需要配置对应的ftp路径等信息</strong> <strong>git</strong> <strong>jquery(jquery snippets)</strong> <strong>SaSS(可以支持sass)</strong> <strong>DocBlockr（块状注释）</strong></p><h3 id="ubuntu安装中文输入法"><a href="#ubuntu安装中文输入法" class="headerlink" title="ubuntu安装中文输入法"></a>ubuntu安装中文输入法</h3><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>git clone https://github.com/lyfeyaj/sublime-text-imfix.git</code></pre><h3 id="复制文件"><a href="#复制文件" class="headerlink" title="复制文件"></a>复制文件</h3><pre><code>cd ~/sublime-text-imfixsudo cp ./lib/libsublime-imfix.so /opt/sublime_text/sudo cp ./src/subl /usr/bin/</code></pre><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>终端输入</p><pre><code>LD_PRELOAD=./libsublime-imfix.so subl</code></pre><h3 id="建立快捷方式"><a href="#建立快捷方式" class="headerlink" title="建立快捷方式"></a>建立快捷方式</h3><p>新建文件sublime放在/home目录下，脚本内容：</p><pre><code>#!/bin/bashLD_PRELOAD=/opt/sublime_text/libsublime-imfix.so subl</code></pre><h3 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h3><p>终端输入</p><pre><code>bash ~/sublime</code></pre><h3 id="快捷方式修改"><a href="#快捷方式修改" class="headerlink" title="快捷方式修改"></a>快捷方式修改</h3><p>将[Desktop Entry]中的字符串<br>Exec=/opt/sublime_text/sublime_text %F<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text %F”<br>将[Desktop Action Window]中的字符串<br>Exec=/opt/sublime_text/sublime_text -n<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text -n”<br>将[Desktop Action Document]中的字符串<br>Exec=/opt/sublime_text/sublime_text –command new_file<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text –command new_file”<br>注意：<br>修改时请注意双引号””,否则会导致不能打开带有空格文件名的文件。</p>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IDE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git入门基础</title>
      <link href="/2016/11/09/git%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/git%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><pre><code>git init</code></pre><h3 id="查看分支"><a href="#查看分支" class="headerlink" title="查看分支"></a>查看分支</h3><pre><code>E:\HKMAIN (master)λ git branch* master  v1.1  v1.2λ git branch -v* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.  v1.1   b48a782 试剂盒现货列表添加样本信息一栏  v1.2   acbf4f1 c1.2</code></pre><h3 id="删除分支"><a href="#删除分支" class="headerlink" title="删除分支"></a>删除分支</h3><p>查看未合并的分支</p><pre><code>λ git branch --no-merged</code></pre><p>删除分支</p><pre><code>git branch -d v1.1</code></pre><p>如果是未合并的分支，使用大写的-D</p><pre><code>E:\HKMAIN (master)λ git branch -d v1.1Deleted branch v1.1 (was b48a782).E:\HKMAIN (master)λ git branch -v* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.  v1.2   acbf4f1 c1.2</code></pre><h3 id="创建分支"><a href="#创建分支" class="headerlink" title="创建分支"></a>创建分支</h3><pre><code>git branch v2.0E:\HKMAIN (master)λ git branch VmysqlE:\HKMAIN (master)λ git branch  Vmysql* master  v1.2E:\HKMAIN (master)λ git checkout VmysqlSwitched to branch &apos;Vmysql&apos;E:\HKMAIN (Vmysql)λ</code></pre><p>或者直接使用git checkout -b v3.0</p><pre><code>E:\HKMAIN (Vmysql)λ git checkout -b VsqlserverSwitched to a new branch &apos;Vsqlserver&apos;E:\HKMAIN (Vsqlserver)λ git branch  Vmysql* Vsqlserver  master  v1.2</code></pre><h3 id="git查看远程仓库"><a href="#git查看远程仓库" class="headerlink" title="git查看远程仓库"></a>git查看远程仓库</h3><pre><code># git查看远程仓库git remote -v# git添加远程仓库git remote add xxx git@gitlab.xxx.com:xxx/xxx# 删除远程分值git remote rm xxx</code></pre><h3 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a>git stash</h3><p>使用git stash命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用git stash pop来恢复之前的进度继续开发新功能。</p><pre><code># 保存当前进度git stash# 查看现有的存储git stash list# 恢复最新的进度到工作区git stash popgit stash save your-file-name</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Excel入门基础</title>
      <link href="/2016/11/09/excel%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/excel%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="返回最后一个值、倒数第二个值"><a href="#返回最后一个值、倒数第二个值" class="headerlink" title="返回最后一个值、倒数第二个值"></a>返回最后一个值、倒数第二个值</h3><pre><code>=LOOKUP(1,0/(A2:J2&lt;&gt;&quot;&quot;),A2:J2)=LOOKUP(1,0/(B2:J2&lt;&gt;&quot;&quot;),A2:J2)</code></pre><h3 id="返回时间差"><a href="#返回时间差" class="headerlink" title="返回时间差"></a>返回时间差</h3><pre><code>=DATEDIF(--TEXT(F2,&quot;00-00-00&quot;),TODAY(),&quot;D&quot;)</code></pre><h3 id="VLOOKUP-逆向检索"><a href="#VLOOKUP-逆向检索" class="headerlink" title="VLOOKUP 逆向检索"></a>VLOOKUP 逆向检索</h3><blockquote><p><a href="http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna" target="_blank" rel="noopener">http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna</a></p></blockquote><pre><code>=VLOOKUP(C2,IF({1,0},Sheet2!$D$2:$D$5,Sheet2!$A$2:$A$5),2,FALSE)=INDEX(Sheet2!A:A,MATCH(Sheet1!C2,Sheet2!D:D,0))</code></pre><h3 id="多条件统计求和-COUNTIFS"><a href="#多条件统计求和-COUNTIFS" class="headerlink" title="多条件统计求和 COUNTIFS"></a>多条件统计求和 COUNTIFS</h3><p>统计每个部门人数</p><pre><code>{=SUM(IFERROR(1/(COUNTIFS(Sheet2!L$2:Sheet2!L$250,B5,Sheet2!N$2:Sheet2!N$250,Sheet2!N$2:Sheet2!N$250)*(Sheet2!L$2:Sheet2!L$250=B5)),))}</code></pre><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160304142206.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>wireshark抓包基础</title>
      <link href="/2016/11/09/wireshark%E6%8A%93%E5%8C%85%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/wireshark%E6%8A%93%E5%8C%85%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="nmap安装"><a href="#nmap安装" class="headerlink" title="nmap安装"></a>nmap安装</h3><pre><code>sudo apt-get install nmap</code></pre><h3 id="Zenmap图形GUI安装"><a href="#Zenmap图形GUI安装" class="headerlink" title="Zenmap图形GUI安装"></a>Zenmap图形GUI安装</h3><pre><code>sudo apt-get install Zenmap</code></pre><h3 id="扫描主机"><a href="#扫描主机" class="headerlink" title="扫描主机"></a>扫描主机</h3><pre><code>nmap -T4 -A -v 192.168.1.3/16</code></pre><p>其中-A选项用于使用进攻性（Aggressive）方式扫描；-T4指定扫描过程使用的时序（Timing），总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况良好的情况推荐使用T4；-v表示显示冗余（verbosity）信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态。<br>/32 表示扫描 192.168.1.3<br>/24 表示扫描 192.168.1.0-192.168.1.255<br>/16 表示扫描 192.168.0.0-192.168.255.255<br>/8<br>/1<br>参考<a href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1" target="_blank" rel="noopener">cird</a></p><h3 id="Nmap所识别的6个端口状态。"><a href="#Nmap所识别的6个端口状态。" class="headerlink" title="Nmap所识别的6个端口状态。"></a>Nmap所识别的6个端口状态。</h3><p>open(开放的) 应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。 closed(关闭的) 关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。 filtered(被过滤的) 由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。 unfiltered(未被过滤的) 未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。 open|filtered(开放或者被过滤的) 当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。 closed|filtered(关闭或者被过滤的) 该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。</p><h3 id="监视指定网络接口的数据包tcpdump"><a href="#监视指定网络接口的数据包tcpdump" class="headerlink" title="监视指定网络接口的数据包tcpdump"></a>监视指定网络接口的数据包tcpdump</h3><p>如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0，</p><pre><code>tcpdump -i eth0</code></pre><h3 id="路由追踪traceroute"><a href="#路由追踪traceroute" class="headerlink" title="路由追踪traceroute"></a>路由追踪traceroute</h3><p>linux</p><pre><code>sudo apt-get install traceroute  traceroute hostname</code></pre><p>window</p><pre><code>tracert hostname</code></pre><h3 id="ubuntu开启和关闭混杂模式"><a href="#ubuntu开启和关闭混杂模式" class="headerlink" title="ubuntu开启和关闭混杂模式"></a>ubuntu开启和关闭混杂模式</h3><p>``` ifconfig eth0 promisc # 设置eth0为混杂模式。 ifconfig eth0 -promisc # 取消它的混杂模式</p><pre><code>ifconfig参数详解</code></pre><p>字段含义说明： eth0/eth1： 分别表示第一块网卡和第二块网卡； lo： 表示回环测试接口，注意，这个虚拟的interface一定要存在！ usb0： 表示USB接口的网卡； Linkencap： 表示位于OSI物理层的名称，即连接类型Ethernet（以太网） HWaddr： 表示网卡的硬件地址，即MAC地址 inetaddr ： 表示网卡IP； Bcast： 表示广播(broadcast ) 的地址； Mask： 表示子网掩码； UP： 表示网卡开启状态； BROADCAST： 表示支持广播； MULTICAST： 表示网卡混杂模式； RUNNING： 表示网卡的网线被接上； MULTICAST： 表示支持组播； MTU： 表示MaximumTrasmission Unit 最大传输单元(字节)，即此接口一次所能传输的最大封包； Metric： 表示路由度量值，缺省值是0； RX： 表示网络由激活到目前为止接收的数据包； TX： 表示网络由激活到目前为止发送的数据包； collisions： 表示网络信号冲突的情况； txqueuelen： 表示传输缓冲区长度大小； Memory： 表示占用内存范围。</p><pre><code>### 安装wireshark</code></pre><p>sudo apt-get install wireshark</p><pre><code>wireshark捕获过滤器  </code></pre><p>src 192.168.0.10 &amp;&amp; port 80 源地址192.168.0.10和端口为80相关<br>host 192.160.0.1 和主机192.168.0.1相关<br>src host 192.168.0.1<br>port 8080<br>!port 8080<br>dst port 80<br>icmp<br>!ip6</p><pre><code>wireshark显示过滤器  </code></pre><p>!tcp<br>ip.addr == 192.168.0.1<br>frame.len &lt;= 128<br>tcp.port == 23 || tcp.port == 21<br>smtp || pop || imap<br>ip.addr == 192.168.0.1 or ip.addr == 192.168.0.2</p><h1 id="操作符-gt-lt-gt-lt"><a href="#操作符-gt-lt-gt-lt" class="headerlink" title="操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;="></a>操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;=</h1><h1 id="操作符-and-or-xor-有且仅有1个满足-not"><a href="#操作符-and-or-xor-有且仅有1个满足-not" class="headerlink" title="操作符 and, or, xor(有且仅有1个满足), not"></a>操作符 and, or, xor(有且仅有1个满足), not</h1>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>jetbrains使用配置</title>
      <link href="/2016/11/09/jetbrains%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/"/>
      <url>/2016/11/09/jetbrains%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="需要新的license"><a href="#需要新的license" class="headerlink" title="需要新的license"></a>需要新的license</h3><p>选择server license<br>添加 <a href="http://idea.lanyus.com/" target="_blank" rel="noopener">http://idea.lanyus.com/</a><br>点击 “ok”<br>成功添加<br>phpstorm10.03开始使用<a href="http://idea.qinxi1992.cn/" target="_blank" rel="noopener">http://idea.qinxi1992.cn/</a><br>pycharm</p><pre><code>43B4A73YYJ-eyJsaWNlbnNlSWQiOiI0M0I0QTczWVlKIiwibGljZW5zZWVOYW1lIjoibGFuIHl1IiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IkZvciBlZHVjYXRpb25hbCB1c2Ugb25seSIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJBQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IkRQTiIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiRE0iLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJDTCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJDIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiUEMiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJEQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9XSwiaGFzaCI6IjMzOTgyOTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-keaxIkRgXPKE4BR/ZTs7s7UkP92LBxRe57HvWamu1EHVXTcV1B4f/KNQIrpOpN6dgpjig5eMVMPmo7yMPl+bmwQ8pTZaCGFuLqCHD1ngo6ywHKIQy0nR249sAUVaCl2wGJwaO4JeOh1opUx8chzSBVRZBMz0/MGyygi7duYAff9JQqfH3p/BhDTNM8eKl6z5tnneZ8ZG5bG1XvqFTqWk4FhGsEWdK7B+He44hPjBxKQl2gmZAodb6g9YxfTHhVRKQY5hQ7KPXNvh3ikerHkoaL5apgsVBZJOTDE2KdYTnGLmqxghFx6L0ofqKI6hMr48ergMyflDk6wLNGWJvYHLWw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</code></pre><h3 id="输入法问题"><a href="#输入法问题" class="headerlink" title="输入法问题"></a>输入法问题</h3><p>升级到ubuntu16.04后，输入无法使用<br>去安装目录bin文件夹下找到启动idea.sh,用编辑器打开，添加</p><pre><code>XMODIFIERS=&quot;@im=fcitx&quot;export XMODIFIERS</code></pre><p>在</p><pre><code># ---------------------------------------------------------------------# Run the IDE.# ---------------------------------------------------------------------</code></pre><p>上面即可！</p><h3 id="ubuntu安装"><a href="#ubuntu安装" class="headerlink" title="ubuntu安装"></a>ubuntu安装</h3><p>下载并压缩到/opt/目录下,并在/usr/share/appliactions/下创建快捷方式的文件，命名为phpstorm.desktop,编辑如下代码，保存</p><pre><code>[Desktop Entry]Categories=Development;Comment[zh_CN]=Comment=Exec=/opt/phpstorm/bin/phpstorm.shGenericName[zh_CN]=IDEGenericName=IDEIcon=/opt/phpstorm/bin/webide.pngName[zh_CN]=phpStormName=phpStorm　　　　　　　Path=StartupNotify=trueTerminal=falseType=ApplicationX-DBUS-ServiceName=X-DBUS-StartupType=X-KDE-SubstituteUID=falseX-KDE-Username=Learn Programming</code></pre><h3 id="界面样式"><a href="#界面样式" class="headerlink" title="界面样式"></a>界面样式</h3><p><a href="https://github.com/jkaving/intellij-colors-solarized" target="_blank" rel="noopener">theme</a><br><a href="https://github.com/ChrisRM/material-theme-jetbrains" target="_blank" rel="noopener">背景修改，含theme</a></p><h3 id="界面配置"><a href="#界面配置" class="headerlink" title="界面配置"></a>界面配置</h3><p>显示行号<br>Editor-&gt;General-&gt;Appearance-&gt;Show line number<br>关闭自动保存<br>Appearance&amp;Behavior-&gt;System settings-&gt;save files on frame deactivation 关闭<br>Editor-&gt;General-&gt;Editor tabs-&gt;Mark modified tabs with asterisk 勾选</p><h3 id="theme安装"><a href="#theme安装" class="headerlink" title="theme安装"></a>theme安装</h3><p>安装模板下载<a href="http://phpstorm-themes.com/" target="_blank" rel="noopener">http://phpstorm-themes.com/</a><br>ubuntu安装地址~/.pycharm/config/colors/ ###快捷键 Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/<em>…</em>/ ）<br>Shift+F6 重构-重命名<br>Ctrl+X 删除行<br>Ctrl+D 复制行<br>Ctrl+G 查找行<br>Ctrl+Shift+Up/Down 代码向上/下移动。<br>F2 或Shift+F2 高亮错误或警告快速定位<br>写代码，按Tab 生成代码<br>选中文本，按Ctrl+Shift+F7 高亮显示所有该文本，按Esc高亮消失。(因为这个功能我就可以发放心的放弃sublime了)<br>Ctrl+B或Ctrl+鼠标左键单击 快速打开光标处的类或方法，（NB的功能）<br>Ctrl + Alt + B Go to implementation(s) 跳转方法实现处<br>Ctrl + Shift + I Open quick definition lookup 打开定义快速查找<br>Alt + Up/Down Go to previous/next method 跳转到上一个/下一个方法<br>Ctrl+E 最近打开的文件<br>Alt+F1 查找代码所在位置<br>Ctrl+Alt+L 格式化代码<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本<br>Ctrl+P 方法参数提示<br>F3 查找下一个<br>Shift+F3 查找上一个<br>alt+Shift+F 将当前文件加入收藏夹<br>ctrl+alt+s 打开配置窗口<br>ctrl+Shift+N 通过文件名快速查找工程内的文件（必记）<br>ctrl+Shift+alt+N 通过一个字符快速查找位置（必记）<br>Shift+enter 重新开始一行（无论光标在哪个位置）<br>Ctrl + Alt + T with…（if, else, try, catch, for, etc）用 * 来围绕选中的代码行，（ * 包括 if 、 while 、 try catch 等）<br>Ctrl + Shift + U Toggle case for word at caret or selected block 光标所在位置大小写<br>Ctrl + Delete Delete to word end 删除文字结束<br>Ctrl + Backspace Delete to word start 删除文字开始<br>Ctrl + E Recent files popup 弹出最近打开的文件<br>F11 Toggle bookmark 切换标记，我觉得叫书签更好，就是sublime text 的F2<br>Ctrl + Shift + F12 Toggle maximizing editor 切换最大化编辑器<br>Alt + Shift + F Add to Favorites 添至收藏夹</p>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IDE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache入门基础</title>
      <link href="/2016/11/09/apache%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/apache%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="查看apache加载的模块"><a href="#查看apache加载的模块" class="headerlink" title="查看apache加载的模块"></a>查看apache加载的模块</h3><pre><code>apachectl -t -D DUMP_MODULES  </code></pre><h3 id="禁用和启用模块"><a href="#禁用和启用模块" class="headerlink" title="禁用和启用模块"></a>禁用和启用模块</h3><pre><code>sudo a2dismod pythonsudo a2enmod python</code></pre><h3 id="查看版本号"><a href="#查看版本号" class="headerlink" title="查看版本号"></a>查看版本号</h3><pre><code>apachectl -v</code></pre><h3 id="赋予权限"><a href="#赋予权限" class="headerlink" title="赋予权限"></a>赋予权限</h3><p>2.2.x以下版本</p><pre><code>Order deny,allowAllow from all</code></pre><p>2.4.x以上版本</p><pre><code>Require all granted</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>django入门基础</title>
      <link href="/2016/11/09/django%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/django%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="2017-11-10号重新更新基本安装和线上部署"><a href="#2017-11-10号重新更新基本安装和线上部署" class="headerlink" title="2017.11.10号重新更新基本安装和线上部署"></a>2017.11.10号重新更新基本安装和线上部署</h3><p>环境：python3.5 django1.11</p><pre><code># 安装环境$ sudo apt-get update$ sudo apt-get install python3-pip apache2 libapache2-mod-wsgi-py3$ sudo pip3 install virtualenv# 安装项目目录$ cd ~/www/html/$ virtualenv --no-site-packages -p /usr/bin/python3.5 CCO$ cd CCO$ source ./bin/activate(CCO) $ pip3 install ipython(CCO) $ pip3 install Django==1.11.7# 查看django是否安装成功(CCO) $  ipython &gt; import django &gt; django.VERSION # 打印出django版本表示成功# 开始创建项目(CCO) $ django-admin.py startproject CCO_WEB# 创建应用(CCO) $ cd CCO_WEB(CCO) $ django-admin.py startapp polls# 修改文件内容(CCO) $ vim CCO_WEB/CCO_WEB/setting.pyALLOWED_HOSTS = [&apos;127.0.0.1&apos;, &apos;localhost&apos;]  # 修改STATIC_URL = &apos;/static/&apos; # 原始STATIC_ROOT = os.path.join(BASE_DIR, &apos;static/&apos;) # 添加# 创建数据库和超级管理员(CCO) $ ./manage.py makemigrations(CCO) $ ./manage.py migrate(CCO) $ ./manage.py createsuperuser # 创建超级管理员(CCO) $ ./manage.py collectstatic # 收集静态文件### 用django自带服务器运行(CCO) $ sudo ufw allow 8000 # 关闭防火墙(CCO) $ ./manage.py runserver 0.0.0.0:8000 # 成功表示django开发环境配置完成### 线上部署apache虚拟主机配置$ sudo vim /etc/apache2/sites-available/www.cco.com.conf&lt;VirtualHost *:80&gt;        ServerName www.example.com        ServerAdmin webmaster@localhost         # 这里指明静态文件存放的地方    Alias /static  /home/hanchang/www/html/CCO/CCO_WEB/static    # 给文件夹分配权限    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/static&gt;            Require all granted    &lt;/Directory&gt;    #接下来，我们将授予访问存储Django代码的二级项目目录中的wsgi.py文件的权限。    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB&gt;    &lt;Files wsgi.py&gt;            Require all granted    &lt;/Files&gt;    &lt;/Directory&gt;        WSGIDaemonProcess CCO_WEB python-home=/home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB python-path=/home/hanchang/www/html/CCO    WSGIProcessGroup CCO_WEB    WSGIScriptAlias / /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB/wsgi.py    ErrorLog ${APACHE_LOG_DIR}/error.log    CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/VirtualHost&gt;### 线上sudo a2ensite www.cco.comsudo service apache2 restarthttp://127.0.0.1 查看原文查看　https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-apache-and-mod_wsgi-on-ubuntu-16-04</code></pre><h3 id="数据库安装"><a href="#数据库安装" class="headerlink" title="数据库安装"></a>数据库安装</h3><pre><code>$ sudo apt-get install python-setuptools$ sudo apt-get install libmysqld-dev$ sudo apt-get install libmysqlclient-dev$ sudo apt-get install python-dev$ sudo easy_install mysql-python$ pip3 install mysqlclient</code></pre><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code># 需要先安装虚拟环境(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><h3 id="查看是否安装成功及版本号"><a href="#查看是否安装成功及版本号" class="headerlink" title="查看是否安装成功及版本号"></a>查看是否安装成功及版本号</h3><pre><code>pythonimport djangodjango.VERSION</code></pre><h3 id="安装MysqlDb"><a href="#安装MysqlDb" class="headerlink" title="安装MysqlDb"></a>安装MysqlDb</h3><p>ubuntu</p><pre><code># ubuntu安装步骤：sudo apt-get install python-setuptoolssudo apt-get install libmysqld-devsudo apt-get install libmysqlclient-devsudo apt-get install python-devsudo easy_install mysql-python</code></pre><p>windows下<a href="https://pypi.python.org/pypi/MySQL-python/1.2.5" target="_blank" rel="noopener">https://pypi.python.org/pypi/MySQL-python/1.2.5</a> 下载.exe一键安装</p><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><pre><code>django-admin.py startproject Novel</code></pre><h3 id="创建APP"><a href="#创建APP" class="headerlink" title="创建APP"></a>创建APP</h3><pre><code>python manage.py startapp Heros</code></pre><p>/Novel/settings.py</p><pre><code>INSTALLED_APPS = (    ...    &apos;Heroes&apos;,  #这里填写的是app的名称)</code></pre><h3 id="命令行调试模式"><a href="#命令行调试模式" class="headerlink" title="命令行调试模式"></a>命令行调试模式</h3><pre><code>python manage.py shell</code></pre><h3 id="运行开发服务器"><a href="#运行开发服务器" class="headerlink" title="运行开发服务器"></a>运行开发服务器</h3><pre><code>cd mysitepython manage.py runserver 或者python manage.py runserver 0.0.0.0:8000</code></pre><h3 id="运行shell脚本方式"><a href="#运行shell脚本方式" class="headerlink" title="运行shell脚本方式"></a>运行shell脚本方式</h3><pre><code>python manager.py shell # 启动脚本环境from testapp.models import *  # 导入数据库</code></pre><h3 id="部署线上环境"><a href="#部署线上环境" class="headerlink" title="部署线上环境"></a>部署线上环境</h3><p>安装apache模块</p><pre><code># Python 2sudo apt-get install libapache2-mod-wsgi# Python 3sudo apt-get install libapache2-mod-wsgi-py3</code></pre><p>Novel/Novel/wsgi.py</p><pre><code>import osimport syssys.path.append(&apos;/var/www/html/Novel/&apos;)sys.path.append(&apos;/var/www/html/Novel/Novel/&apos;)sys.path.append(&apos;/var/www/html/Novel/lib/python2.7/site-packages&apos;) # 虚拟环境需要添加from django.core.wsgi import get_wsgi_applicationos.environ.setdefault(&quot;DJANGO_SETTINGS_MODULE&quot;, &quot;Novel.settings&quot;)application = get_wsgi_application()</code></pre><p>/etc/apache2/sites-enable/novel.conf</p><pre><code>&lt;VirtualHost *:1200&gt;    ServerAdmin webmaster@localhost    DocumentRoot /var/www/html/Novel/Novel/Novel    ErrorLog ${APACHE_LOG_DIR}/error.log    CustomLog ${APACHE_LOG_DIR}/access.log combined    # 静态文件设置    Alias /static/ /var/www/html/Novel/Novel/Novel/static/    &lt;Directory /var/www/html/Novel/Novel/Novel/static/&gt;        Require all granted    &lt;/Directory&gt;    WSGIScriptAlias / /var/www/html/Novel/Novel/Novel/wsgi.py    &lt;Directory /var/www/html/Novel/Novel/Novel/&gt;        Require all granted        &lt;Files wsgi.py&gt;            Require all granted        &lt;/Files&gt;    &lt;/Directory&gt;&lt;/VirtualHost&gt;</code></pre><h3 id="视图与路由绑定"><a href="#视图与路由绑定" class="headerlink" title="视图与路由绑定"></a>视图与路由绑定</h3><p>/Heroes/views.py</p><pre><code>from django.http import HttpResponse, Http404# Create your views here.def hello(request):    return HttpResponse(&quot;Hello World&quot;)</code></pre><p>/Novel/urls.py</p><pre><code>from django.conf.urls import include, urlfrom Heroes.views import *urlpatterns = [    url(r&apos;^hello/$&apos;, hello),    url(r&apos;^time/plus/(\d{1,2})/$&apos;, hours_ahead)]</code></pre><h3 id="视图与模板"><a href="#视图与模板" class="headerlink" title="视图与模板"></a>视图与模板</h3><p>/Novel/settings.py设置模板路径</p><pre><code>TEMPLATES = [    {        # .....        &apos;DIRS&apos;: [            os.path.join(os.path.dirname(__file__), &apos;templates&apos;).replace(&apos;\\&apos;,&apos;/&apos;),        ],        # ....    },]</code></pre><p>/Novel/Heroes/views.py修改视图</p><pre><code>from django.shortcuts import render_to_responsefrom django.http import HttpResponse, Http404import datetime# Create your views here.def current_datetime(request):    now = datetime.datetime.now()    # html = &apos;&lt;html&gt;&lt;body&gt;It is %s.&lt;/body&gt;&lt;/html&gt;&apos; % now    return render_to_response(&apos;Heroes/current_datetime.html&apos;, {&apos;current_time&apos;: now})</code></pre><p>/Novel目录下创建templates/Heroes/current_datetime.html</p><pre><code>&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;{ { current_time }}&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h3><p>/Novel/settings.py</p><pre><code>DATABASES = {    &apos;default&apos;: {        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,        &apos;NAME&apos;: &apos;Novel&apos;,        &apos;USER&apos;: &apos;root&apos;,        &apos;PASSWORD&apos;: &apos;password&apos;,        &apos;HOST&apos;: &apos;127.0.0.1&apos;,        &apos;PORT&apos;: &apos;3306&apos;    }}</code></pre><p>测试是否成功</p><pre><code>python manage.py shell&gt;&gt;&gt; from django.db import connection&gt;&gt;&gt; cursor = connection.cursor()</code></pre><h3 id="视图返回json数据格式"><a href="#视图返回json数据格式" class="headerlink" title="视图返回json数据格式"></a>视图返回json数据格式</h3><p>views.py</p><pre><code>from django.http import HttpResponse, Http404from json import dumpsdef login_handle(request):    if request.method != &apos;POST&apos;:        raise Http404()    inputs = request.POST    json_str = dumps(inputs)    return HttpResponse(json_str, content_type=&apos;application/json&apos;)</code></pre><p>### 静态文件 settings.py <figure class="highlight plain"><figcaption><span>线上模式静态地址 STATIC_URL </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">开发模式静态地址</span><br><span class="line">========</span><br><span class="line"></span><br><span class="line">STATICFILES_DIRS = (os.path.join(os.path.dirname(**file**), &apos;static&apos;).replace(&apos;\\&apos;,&apos;/&apos;),)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql主从复制</title>
      <link href="/2016/11/09/mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/"/>
      <url>/2016/11/09/mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h3><p>主服务器<br>192.168.0.160 mysql 5.6.17 win2008R2<br>从服务器<br>192.168.0.206 mysql 5.6.12 win2003</p><h3 id="主服务器创建数据库test1-test2"><a href="#主服务器创建数据库test1-test2" class="headerlink" title="主服务器创建数据库test1, test2"></a>主服务器创建数据库test1, test2</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     mysql&gt;USE test1mysql&gt;CREATE TABLE `test1`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  mysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)mysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;    mysql&gt;USE test2mysql&gt;CREATE TABLE `test2`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  mysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)</code></pre><h3 id="将test1-test2-复制到从服务器上"><a href="#将test1-test2-复制到从服务器上" class="headerlink" title="将test1,test2 复制到从服务器上"></a>将test1,test2 复制到从服务器上</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     mysql&gt;USE test1  mysql&gt;set names utf8;  mysql&gt;source c:/test1.sql;mysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     mysql&gt;USE test2  mysql&gt;set names utf8;  mysql&gt;source c:/test2.sql;</code></pre><h3 id="主服务器配置"><a href="#主服务器配置" class="headerlink" title="主服务器配置"></a>主服务器配置</h3><p>编辑配置文件my.ini</p><pre><code>[mysqld] server-id=1     # 配一个唯一的ID编号，1至32  log-bin=mysql-bin  # 二进制文件存放路径  binlog-do-db=test1  # 需要同步的数据库名  binlog-ignore-db=test2  # 不需要同步的数据库名</code></pre><p>重启mysql并重新登陆，创建授权用户</p><pre><code>mysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave@192.168.0.206 identified by &apos;123456&apos; ;  mysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave1@192.168.0.118 identified by &apos;123456&apos; ; # 如果是多从mysql&gt;flush privileges;     mysql&gt;show master status;  # 找到File 和 Position 的值记录下来    </code></pre><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160401152254.png" alt></p><h3 id="从服务器配置192-168-0-206"><a href="#从服务器配置192-168-0-206" class="headerlink" title="从服务器配置192.168.0.206"></a>从服务器配置192.168.0.206</h3><p>编辑配置文件my.ini添加</p><pre><code>[mysqld]server-id=2     #唯一replicate-do-db=test1replicate-ignore-db=test2</code></pre><p>重启数据库并重新登陆</p><pre><code>mysql&gt;mysql -uroot -p  mysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  mysql&gt;start slave;mysql&gt;show slave status\G</code></pre><p>结果出现一下内容表示成功</p><pre><code>Slave_IO_Running: YesSlave_SQL_Running: Yes</code></pre><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160401152538.png" alt> 多从，另一个从服务器配置192.168.0.118<br>编辑配置文件my.ini添加</p><pre><code>[mysqld]server-id=3     #唯一，注意和其他的从服务器不一致replicate-do-db=test1replicate-ignore-db=test2</code></pre><p>重启mysql并重新登陆，创建授权用户</p><pre><code>mysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave1&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  mysql&gt;start slave;mysql&gt;show slave status\G    </code></pre><h3 id="最后测试"><a href="#最后测试" class="headerlink" title="最后测试"></a>最后测试</h3><p>在主服务器添加表和数据，可以看到从服务器数据库已经修改。<br>重启主从数据库，依然可以正常同步。</p><h3 id="错误处理办法"><a href="#错误处理办法" class="headerlink" title="错误处理办法"></a>错误处理办法</h3><p>连接不上master：<br>1，密码是否正确，是否给予权限<br>2，防火墙是否开启3306端口 配置的时候注意锁表</p><pre><code>LOCK TABLESUNLOCK TABLES;</code></pre><p>错误提示 Got fatal error 1236 from master when reading data from binary log: ‘Slave can not handle replication events with the checksum that master is configured to log; the first event ‘mysql-bin.000002’ at 120, the last event read from ‘./mysql-bin.000002’ at 120, the last byte read from ‘./mysql-bin.000002’ at 120 由于主库是5.6, 从库是5.5.<br>5.6的版本中加入了replication event checksum，主从复制时间校验功能，所以需要把这个关掉才能正常同步到5.5的slave 修改主库</p><pre><code>sudo vim /etc/my.cnfbinlog_checksum=none</code></pre><p>重新配置主从即可</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql入门基础</title>
      <link href="/2016/11/09/mysql%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/mysql%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h4><p>ubuntu16.04</p><pre><code>sudo apt-get install mysql-serversudo apt install mysql-client  # 服务器端不需要mysql_secure_installation</code></pre><h4 id="查看mysql版本信息"><a href="#查看mysql版本信息" class="headerlink" title="查看mysql版本信息"></a>查看mysql版本信息</h4><pre><code>mysql --version  mysql&gt; show variables like &apos;%version_%&apos;;</code></pre><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160121142352.png" alt></p><h4 id="数据库创建备份导入命令"><a href="#数据库创建备份导入命令" class="headerlink" title="数据库创建备份导入命令"></a>数据库创建备份导入命令</h4><pre><code>// 创建数据库  CREATE DATABASE `test` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;  // 删除数据库   DROP DATABASE IF EXISTS `test`; // 创建表  CREATE TABLE test(name varchar(32) not null,password varchar(64) not null)DEFAULT charset=utf8;  ### 重置自增字段<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tableName`</span> AUTO_INCREMENT = <span class="number">1</span>; </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">    <span class="keyword">truncate</span> tableName; </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 删除表</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>;</span><br><span class="line">    </span><br><span class="line">    // 删除表内容，保留表结构  </span><br><span class="line">    mysql&gt; TRUNCATE TABLE `tabel_name`;</span><br><span class="line">    Query OK, 0 rows affected (0.29 sec)</span><br><span class="line">    </span><br><span class="line">    // 删除表并重置主键，不会留下日志，相当于删除表并重建    </span><br><span class="line">    <span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> <span class="string">`animal_cell_attribute`</span> </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    // 导出一个数据库    </span><br><span class="line">    mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名.sql   </span><br><span class="line">    mysqldump -u root -p uscnerp &gt; uscnerp.sql    </span><br><span class="line">    Enter <span class="keyword">password</span>:  </span><br><span class="line">    </span><br><span class="line">    // 导出一张表</span><br><span class="line">    mysqldump -u 用户名 -p 数据库名 表名 &gt; 导出的文件名.sql  </span><br><span class="line">    mysqldump -u root -p animal animal_service &gt; animal_service.sql</span><br><span class="line">    Enter <span class="keyword">password</span>: **********  </span><br><span class="line">    </span><br><span class="line">    // 导出多个数据库</span><br><span class="line">    mysqldump  -uroot -p <span class="comment">--databases test mysql #空格分隔</span></span><br><span class="line">    </span><br><span class="line">    // 导出到excel表格</span><br><span class="line">    mysql   -uroot   -p   -e   <span class="string">"select   *   from   test.table2 "</span>   &gt;   d:a.xsl</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    // 导入数据库  </span><br><span class="line">    mysql -u root -p   </span><br><span class="line">    mysql&gt;<span class="keyword">use</span> 数据库  </span><br><span class="line">    mysql&gt;<span class="keyword">set</span> <span class="keyword">names</span> utf8; （先确认编码，如果不设置可能会出现乱码，注意不是UTF-8）   </span><br><span class="line">    mysql&gt;source d:\wcnc_db.sql</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">### 查看表</span></span><br><span class="line"></span><br><span class="line">查看表结构</span><br><span class="line"></span><br><span class="line">    <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> 表名;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">### 配置用户权限</span></span><br><span class="line"></span><br><span class="line">重置root密码并查看所有用户权限</span><br><span class="line"></span><br><span class="line">    mysql&gt; use mysql;</span><br><span class="line">    Database changed</span><br><span class="line">    mysql&gt; UPDATE user SET Password = PASSWORD('newpassword') WHERE user = 'root';</span><br><span class="line">    Query OK, 3 rows affected (0.02 sec)</span><br><span class="line">    Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class="line">    </span><br><span class="line">    mysql&gt; SELECT Host,User,Password FROM mysql.user;</span><br><span class="line">    +<span class="comment">-----------+--------+-------------------------------------------+</span></span><br><span class="line">    | Host      | User   | Password                                  |</span><br><span class="line">    +<span class="comment">-----------+--------+-------------------------------------------+</span></span><br><span class="line">    | localhost | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class="line">    | 127.0.0.1 | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class="line">    | ::1       | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class="line">    | localhost |        |                                           |</span><br><span class="line">    | localhost | animal | *CC87B1E39E699B64E0B80741B5D1991BC5BE57AC |</span><br><span class="line">    +<span class="comment">-----------+--------+-------------------------------------------+</span></span><br><span class="line">    5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">查看全部用户</span><br><span class="line"></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="keyword">CONCAT</span>(<span class="string">'User: '''</span>,<span class="keyword">user</span>,<span class="string">'''@'''</span>,host,<span class="string">''';'</span>) <span class="keyword">AS</span> <span class="keyword">query</span> <span class="keyword">FROM</span> mysql.user;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">创建用户</span><br><span class="line"></span><br><span class="line">    mysql&gt; CREATE USER username@localhost IDENTIFIED BY 'password';</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&gt; username:用户名  </span><br><span class="line">&gt; @localhost：表示用户只能在本地访问  </span><br><span class="line">&gt; password:密码</span><br><span class="line"></span><br><span class="line">配置权限</span><br><span class="line"></span><br><span class="line">    <span class="keyword">GRANT</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">UPDATE</span> <span class="keyword">ON</span> database.* <span class="keyword">TO</span> username@localhost <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'password'</span>;  </span><br><span class="line">    <span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">user</span>;@localhost </span><br><span class="line">    // <span class="keyword">GRANT</span> 权限名称 <span class="keyword">ON</span> 数据库.数据表 <span class="keyword">TO</span> 用户名@访问地址 <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'密码'</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">刷新权限列表</span><br><span class="line"></span><br><span class="line">    <span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">配置备份用户权限</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'backuper'</span>@<span class="string">'localhost'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'PASSWORD'</span>;</span><br><span class="line">    <span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, RELOAD, PROCESS, <span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>, SUPER, <span class="keyword">LOCK</span> <span class="keyword">TABLES</span>, <span class="keyword">REPLICATION</span> <span class="keyword">CLIENT</span>, <span class="keyword">SHOW</span> <span class="keyword">VIEW</span>, <span class="keyword">EVENT</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'backuper'</span>@<span class="string">'localhost'</span>;</span><br><span class="line">    <span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">### window服务器下自动备份</span></span><br><span class="line"></span><br><span class="line">**编写脚本**</span><br><span class="line"></span><br><span class="line">    rem *******************************Code Start*****************************</span><br><span class="line">    @echo off</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">set</span> <span class="string">"Ymd=%date:~,4%%date:~5,2%%date:~8,2%"</span></span><br><span class="line">    mysqldump <span class="comment">--opt -u root --password=abcdefg database &gt; F:\FTP\BackupMysql\database_%Ymd%.sql</span></span><br><span class="line">    @echo <span class="keyword">on</span></span><br><span class="line">    <span class="keyword">rem</span> *******************************Code <span class="keyword">End</span>*****************************</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">**定时任务**  </span><br><span class="line">注意在操作中填写脚本并在起始于写入脚本所在盘符E:\</span><br><span class="line"></span><br><span class="line"><span class="comment">### 删除mysql</span></span><br><span class="line"></span><br><span class="line">&gt; 在服务里找到mysql服务，停止使用  </span><br><span class="line">&gt; 控制面板中卸载mysql 注册表文件删除： HKEY\_LOCAL\_MACHINE/<span class="keyword">SYSTEM</span>/ControlSet001/Services/Eventlog/Application/MySQL 目录删除; HKEY\_LOCAL\_MACHINE/SYSTEM/ControlSet002/Services/Eventlog/Application/MySQL 目录删除; HKEY\_LOCAL\_MACHINE/SYSTEM/CurrentControlSet/Services/Eventlog/Application/MySQL 目录删除; 在硬盘和注册表中搜索mysql并删除掉</span><br><span class="line"></span><br><span class="line"><span class="comment">### 开启慢查询日志</span></span><br></pre></td></tr></table></figure>sudo vim /etc/my.cnf# slow_query_logslow_query_log=onslow-query-log-file=/var/log/mysql/slow.log # 保证此文件属于mysql用户，mysql组，并可写权限long_query_time=1 # 超过1秒写入慢查询日志log-queries-not-using-indexes</code></pre><blockquote><p>重启mysql</p></blockquote><pre><code>### 查看是否开启mysql慢查询日志&gt;mysql show variables like &quot;slow_query_log&quot;;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rsync同步web服务器</title>
      <link href="/2016/11/09/rsync%E5%90%8C%E6%AD%A5web%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2016/11/09/rsync%E5%90%8C%E6%AD%A5web%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h3><p>服务端安装 WIN2008R2 ip:192.168.0.160<br>客户端安装 WIN2003 ip:192.168.0.206</p><h3 id="程序下载"><a href="#程序下载" class="headerlink" title="程序下载"></a>程序下载</h3><p>新版已经开始收费，这里使用旧版4.0.5,百度网盘下载<a href="http://pan.baidu.com/s/1kTNyk1h" target="_blank" rel="noopener">http://pan.baidu.com/s/1kTNyk1h</a></p><h3 id="服务端安装"><a href="#服务端安装" class="headerlink" title="服务端安装"></a>服务端安装</h3><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync.png" alt> 一路直接下一步，这里会创建一个用户，创建的默认密码可以不需要修改，直接下一步。 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync1.png" alt> 创建的用户 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync2.png" alt> 创建的服务改为自动启动</p><h3 id="客户端安装"><a href="#客户端安装" class="headerlink" title="客户端安装"></a>客户端安装</h3><p>一路下一步直到完成。</p><h3 id="配置服务端"><a href="#配置服务端" class="headerlink" title="配置服务端"></a>配置服务端</h3><pre><code>use chroot = false# 不验证用户密码strict modes = falselock file = rsyncd.lock hosts allow = 192.168.0.206max connections = 5# 默认端口port = 873# 指定匿名访问uid = 0gid = 0log file = rsyncd.log# Module definitions# Remember cygwin naming conventions : c:\work becomes /cygdrive/c/work[web]path = /cygdrive/C/WEB# 下面两行是配置用户名密码的# auth users = dbbackuper# secrets file = /cygdrive/e/Setting/Rsync/rsync_db.ps# 只允许客户端下载，不允许客户端上传read only = truetransfer logging = yes</code></pre><p>防火墙设置允许配置的端口通过<br>查看端口配置是否错误</p><pre><code>telnet 192.168.0.160 873  @RSYNCD: 30.0</code></pre><p>服务器端配置测试文件目录 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync3.png" alt> 其中targetDir为联接文件</p><pre><code>C:\&gt;mklink /J WEB\targetDir\ source\为 WEB\targetDir\ &lt;&lt;===&gt;&gt; source\ 创建的联接</code></pre><h3 id="配置客户端"><a href="#配置客户端" class="headerlink" title="配置客户端"></a>配置客户端</h3><p>在安装目录下使用如下命令</p><pre><code>C:\Program Files\cwRsync\bin&gt;rsync --port=873 -vzrtopg --progress --delete 192.168.0.160::web /cygdrive/C/WEBreceiving incremental file listskipping non-regular file &quot;targetDir&quot;./TEST4/test3/sent 39 bytes  received 163 bytes  134.67 bytes/sectotal size is 19  speedup is 0.09</code></pre><p>查看客户端文件目录</p><pre><code>test3TEST4</code></pre><p>提示skipping non-regular file ‘targetDir’忽略软链接解决办法<br>参数-L:–copy-links 像对待常规文件一样处理软链结</p><pre><code>C:\Program Files\cwRsync\bin&gt;rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEBreceiving incremental file listdeleting test5/adda.txtdeleting test5/./TEST4/targetDir/targetDir/HAFA/targetDir/pdf/targetDir/pdf/TARGE.txt           0 100%    0.00kB/s    0:00:00 (xfer#1, to-check=1/8)test3/sent 70 bytes  received 272 bytes  97.71 bytes/sectotal size is 0  speedup is 0.00</code></pre><h3 id="实现客户端定时任务"><a href="#实现客户端定时任务" class="headerlink" title="实现客户端定时任务"></a>实现客户端定时任务</h3><p>1，要添加环境变量到系统中<br>2，上传脚本文件到客户端sync_client.bat</p><pre><code>rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEB</code></pre><p>3,在系统中添加定时任务，并指定更新时间</p><h3 id="具体参数详解"><a href="#具体参数详解" class="headerlink" title="具体参数详解"></a>具体参数详解</h3><p>rsync参数的具体解释如下： -v, –verbose 详细模式输出<br>-q, –quiet 精简输出模式<br>-c, –checksum 打开校验开关，强制对文件传输进行校验<br>-a, –archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD<br>-r, –recursive 对子目录以递归模式处理<br>-R, –relative 使用相对路径信息<br>-b, –backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为<del>filename。可以使用–suffix选项来指定不同的备份文件前缀。<br>–backup-dir 将备份文件(如</del>filename)存放在在目录下。<br>-suffix=SUFFIX 定义备份文件前缀<br>-u, –update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)<br>-l, –links 保留软链结<br>-L, –copy-links 想对待常规文件一样处理软链结<br>–copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结<br>–safe-links 忽略指向SRC路径目录树以外的链结<br>-H, –hard-links 保留硬链结<br>-p, –perms 保持文件权限<br>-o, –owner 保持文件属主信息<br>-g, –group 保持文件属组信息<br>-D, –devices 保持设备文件信息<br>-t, –times 保持文件时间信息<br>-S, –sparse 对稀疏文件进行特殊处理以节省DST的空间<br>-n, –dry-run现实哪些文件将被传输<br>-W, –whole-file 拷贝文件，不进行增量检测<br>-x, –one-file-system 不要跨越文件系统边界<br>-B, –block-size=SIZE 检验算法使用的块尺寸，默认是700字节<br>-e, –rsh=COMMAND 指定使用rsh、ssh方式进行数据同步<br>–rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息<br>-C, –cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件<br>–existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件<br>–delete 删除那些DST中SRC没有的文件<br>–delete-excluded 同样删除接收端那些被该选项指定排除的文件<br>–delete-after 传输结束以后再删除<br>–ignore-errors 及时出现IO错误也进行删除<br>–max-delete=NUM 最多删除NUM个文件<br>–partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输<br>–force 强制删除目录，即使不为空<br>–numeric-ids 不将数字的用户和组ID匹配为用户名和组名<br>–timeout=TIME IP超时时间，单位为秒<br>-I, –ignore-times 不跳过那些有同样的时间和长度的文件<br>–size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间<br>–modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0<br>-T –temp-dir=DIR 在DIR中创建临时文件<br>–compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份<br>-P 等同于 –partial<br>–progress 显示备份过程<br>-z, –compress 对备份的文件在传输时进行压缩处理<br>–exclude=PATTERN 指定排除不需要传输的文件模式<br>–include=PATTERN 指定不排除而需要传输的文件模式<br>–exclude-from=FILE 排除FILE中指定模式的文件<br>–include-from=FILE 不排除FILE指定模式匹配的文件<br>–version 打印版本信息<br>–address 绑定到特定的地址<br>–config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件<br>–port=PORT 指定其他的rsync服务端口<br>–blocking-io 对远程shell使用阻塞IO<br>-stats 给出某些文件的传输状态<br>–progress 在传输时现实传输过程<br>–log-format=formAT 指定日志文件格式<br>–password-file=FILE 从FILE中得到密码<br>–bwlimit=KBPS 限制I/O带宽，KBytes per second<br>-h, –help 显示帮助信息</p><h3 id="部分错误的解决办法"><a href="#部分错误的解决办法" class="headerlink" title="部分错误的解决办法"></a>部分错误的解决办法</h3><p>1.’rsync’ 不是内部或外部命令，也不是可运行的程序或批处理文件。<br>加环境变量 path = C:\Program Files (x86)\cwRsync\bin 2.rsync: failed to connect to 192.168.1.82: Connection timed out (116) rsync error: error in socket IO (code 10) at clientserver.c(122) [Receiver=3.0.7]<br>网络通畅，服务器端允许访问端口 873 3.@ERROR: invalid uid nobody<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>指定uid gid<br>uid = 0<br>gid = 0 4.@ERROR: chdir failed<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>path目录配置的正确，得存在<br>解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。<br>也可以通过 菜单–cwRsyncServer–02. Prep a Dir for Upload 配置目录权限 除完全控制和特殊权限外的所有权限 5.@ERROR: auth failed on module test<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>客户端设置<br>a.在命令上要指定好用户名<br>b.密码文件只写密码<br>rsyncd.secrets文件<br>rsyncpass<br>c.用户名密码都要正确 6.Unexpected local arg: /cygdrive/d/rsyncBackup<br>If arg is a remote file/dir, prefix it with a colon (:).<br>rsync error: syntax or usage error (code 1) at main.c(1218) [Receiver=3.0.7]<br>不一定是这个路径有问题，可能是–password-file路径中有空格，服务器端没问题，客户端好像不行 7.password file must be owned by root when running as root<br>continuing without password file<br>Password:<br>设置密码访问权限chown.exe可从服务器端拷贝过来<br>chmod -c 600 /cygdrive/c/etc/rsyncd.secrets<br>chown administrator /cygdrive/c/etc/rsyncd.secrets<br>服务器端不设也可以 8.当出现rsync: chown “” failed: Invalid argument (22)错误时，是因为参数中有o，即保留文件的owner信息，而window服务端无法完成chown操作，解决办法是去掉参数o。另外有些可能还会出现rsync: chgrp “” failed: Invalid argument (22)，原因类似，只要去掉参数中的g即可。</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux开发环境常用软件</title>
      <link href="/2016/11/09/linux%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/"/>
      <url>/2016/11/09/linux%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="显示电脑硬件信息"><a href="#显示电脑硬件信息" class="headerlink" title="显示电脑硬件信息"></a>显示电脑硬件信息</h4><pre><code>$ sudo add-apt-repository ppa:dawidd0811/neofetch$ sudo apt-get update$ sudo apt-get install neofetchneofetch</code></pre><h4 id="安装独立显卡驱动"><a href="#安装独立显卡驱动" class="headerlink" title="安装独立显卡驱动"></a>安装独立显卡驱动</h4><p><a href="https://blog.csdn.net/ghw15221836342/article/details/79571559" target="_blank" rel="noopener">https://blog.csdn.net/ghw15221836342/article/details/79571559</a></p><pre><code># 驱动版本查询   https://www.nvidia.com/Download/index.aspx?lang=en-us# 安装sudo add-apt-repository ppa:graphics-drivers/ppa  sudo apt-get update  sudo apt-get install nvidia-390 #此处要根据上面查询到的版本适当更改sudo apt-get install mesa-common-dev  sudo apt-get install freeglut3-de# 测试nvidia-smi  #若出现电脑GPU列表，即安装成功或者nvidia-settings #显示你的显卡信息<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">    </span><br><span class="line">    #### Chrome浏览器</span><br><span class="line">    下载地址 [百度云盘](http://pan.baidu.com/s/1hq0Nom4)</span><br><span class="line">    </span><br><span class="line">    #### 配置SS</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">安装</span><br><span class="line">==</span><br><span class="line"></span><br><span class="line">apt-get install python-pip pip install s\_h\_a\_d\_o\_w\_s\_o\_c\_k\_s</span><br><span class="line"></span><br><span class="line">启动</span><br><span class="line">==</span><br><span class="line"></span><br><span class="line">sslocal -s server\_ip -p server\_port -l 1080 -k password -t 600 -m aes-256-cfb</span><br><span class="line"></span><br><span class="line">简写</span><br><span class="line">==</span><br><span class="line"></span><br><span class="line">sslocal -s ip -p port -k &quot;password&quot;</span><br><span class="line"></span><br><span class="line">    开机启动配置  </span><br><span class="line">    在/home下新建文件ss.sh脚本</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">#!/bin/bash #文件名:ss.sh sslocal -s ip -p port -k &quot;password&quot;</span><br><span class="line"></span><br><span class="line">    编辑开机启动文件</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">sudo vim /etc/rc.local</span><br></pre></td></tr></table></figure># 最后加入以下内容nohup bash /home/ss.sh&gt;/home/ss.txt &amp;</code></pre><p>代理设置</p><pre><code>service： 127.0.0.1port ： 1080type： socks5</code></pre><h4 id="配置proxychains"><a href="#配置proxychains" class="headerlink" title="配置proxychains"></a>配置proxychains</h4><pre><code># 安装sudo apt install proxychainssudo vim /etc/proxychains.conf~ socks5 127.0.0.1 1080  # 最后一行加入socks代理# 测试proxychains wget https://www.google.com</code></pre><h4 id="wine-qq（现在推荐docker安装qq）"><a href="#wine-qq（现在推荐docker安装qq）" class="headerlink" title="wine qq（现在推荐docker安装qq）"></a>wine qq（现在推荐docker安装qq）</h4><p>安装wine1.7以上版本<br>安装WineQQ7.8-20151109-Longene.deb版本<br>下载<a href="https://pan.baidu.com/s/1bpLn0vl" target="_blank" rel="noopener">网盘</a></p><h4 id="elinks-纯文本浏览器"><a href="#elinks-纯文本浏览器" class="headerlink" title="elinks 纯文本浏览器"></a>elinks 纯文本浏览器</h4><pre><code>sudo apt-get install elinks   # 安装elinks www.zhuohc.com  # 使用</code></pre><h4 id="unzip-zip"><a href="#unzip-zip" class="headerlink" title="unzip / zip"></a>unzip / zip</h4><p>解决中文乱码</p><pre><code>unzip -O CP936 xxx.zip</code></pre><p>解压到指定目录</p><pre><code>unzip -O xxx.zip -d xxx/</code></pre><p>压缩文件</p><pre><code>zip -r yasuo.zip abc.txt dir1</code></pre><h4 id="wps-office办公"><a href="#wps-office办公" class="headerlink" title="wps office办公"></a>wps office办公</h4><p>显示字体确实错误 <a href="https://pan.baidu.com/s/1bpLn0vl" target="_blank" rel="noopener">下载字体</a><br>将字体复制到linux字体中</p><pre><code>sudo cp * /usr/share/fonts</code></pre><p>生成字体索引信息</p><pre><code>sudo mkfontscalesudo mkfontdir</code></pre><p>更新字体缓存</p><pre><code>sudo fc-cache</code></pre><p>中文无法输入</p><pre><code>$ vi /usr/bin/wps  # word文档#!/bin/bashexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  export QT_IM_MODULE=&quot;fcitx&quot;     # 添加的内容    gOpt=#gOptExt=-multiplygTemplateExt=(&quot;wpt&quot; &quot;dot&quot; &quot;dotx&quot;)$ vi /usr/bin/et   # excel表格#!/bin/bashexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  export QT_IM_MODULE=&quot;fcitx&quot;  # 添加的内容  gOpt=#gOptExt=-multiply</code></pre><h4 id="输入法"><a href="#输入法" class="headerlink" title="输入法"></a>输入法</h4><p>系统自带或者sougou输入法 ， 倬彼昊天系列皮肤</p><h4 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h4><p>系统设置&gt;键盘&gt;自定义快捷键&gt;+&gt;<br>名称填screenshot<br>命令</p><pre><code>gnome-screenshot -a</code></pre><p>在disabled修改快捷键</p><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>安装uget</p><pre><code>sudo add-apt-repository ppa:plushuang-tw/uget-stable sudo apt-get update sudo apt-get install uget</code></pre><p>安装aria2</p><pre><code>sudo add-apt-repository ppa:t-tujikawa/ppa sudo apt-get update sudo apt-get install aria2</code></pre><p>在uget gui里编辑插件，选择aria2</p><h4 id="美化监视工具"><a href="#美化监视工具" class="headerlink" title="美化监视工具"></a>美化监视工具</h4><pre><code> sudo apt-get install conky   sudo add-apt-repository ppa:teejee2008/ppa sudo apt-get update sudo apt-get install conky-manager <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">显示桌面会自动隐藏conky的bug解决办法:  </span><br><span class="line">编辑配置文件</span><br></pre></td></tr></table></figure> # own_window_type normalown_window_type desktop</code></pre><p>#### 快速搜索文件</p><pre><code>sudo add-apt-repository ppa:synapse-core/testingsudo apt-get updatesudo apt-get install synapse  </code></pre><h4 id="卸载synapse"><a href="#卸载synapse" class="headerlink" title="卸载synapse"></a>卸载synapse</h4><pre><code>sudo apt-get remove synapse</code></pre><h4 id="移除PPA"><a href="#移除PPA" class="headerlink" title="移除PPA"></a>移除PPA</h4><pre><code>sudo apt-get install ppa-purgesudo ppa-purge ppa:synapse-core/testing</code></pre><h4 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh-my-zsh"></a>安装oh-my-zsh</h4><pre><code># https://github.com/robbyrussell/oh-my-zsh$ sudo apt-get install git$ sudo apt-get install zsh$ sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;$ chsh -s /bin/zsh # 更改默认bash//或:$ chsh -s `which zsh`$ sudo reboot</code></pre><h4 id="terminator-终端管理软件"><a href="#terminator-终端管理软件" class="headerlink" title="terminator 终端管理软件"></a>terminator 终端管理软件</h4><p>安装</p><pre><code>sudo add-apt-repository ppa:gnome-terminatorsudo apt-get updatesudo apt-get install terminator</code></pre><p>基本设置方法</p><blockquote><p>右键点击终端任意区域，选择首选项</p></blockquote><p>设置<a href="https://github.com/ghuntley/terminator-solarized" target="_blank" rel="noopener">solarized</a>配色（<a href="http://blog.codinglabs.org/articles/getting-started-with-ubuntu.html" target="_blank" rel="noopener">参考</a>）</p><pre><code>cd ~/.config/terminator  vim config</code></pre><p>覆盖以下内容</p><pre><code>[global_config]    title_transmit_bg_color = &quot;#d30102&quot;    focus = system    suppress_multiple_term_dialog = True[keybindings][profiles]    [[default]]        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;        copy_on_selection = True        background_image = None        background_darkness = 0.95        background_type = transparent        use_system_font = False        cursor_color = &quot;#eee8d5&quot;        foreground_color = &quot;#839496&quot;        show_titlebar = False        font = Monospace 11        background_color = &quot;#002b36&quot;    [[solarized-dark]]        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;        background_color = &quot;#002b36&quot;        background_image = None        cursor_color = &quot;#eee8d5&quot;        foreground_color = &quot;#839496&quot;    [[solarized-light]]        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;        background_color = &quot;#fdf6e3&quot;        background_image = None        cursor_color = &quot;#002b36&quot;        foreground_color = &quot;#657b83&quot;[layouts]    [[default]]        [[[child1]]]            type = Terminal            parent = window0            profile = default        [[[window0]]]            type = Window            parent = &quot;&quot;[plugins]</code></pre><p>以上配置后会修改配色方案，但是没有bright色<br><a href="https://github.com/seebi/dircolors-solarized" target="_blank" rel="noopener">dircolors-solarized</a>项目提供了适合于solarized的dircolors配色方案，只要选择合适的方案使用就可以了。</p><pre><code>curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark &gt; ~/.dircolors</code></pre><p>然后在~/.bashrc中加入如下配置：</p><pre><code># enable color support of ls and also add handy aliasesif [ -x /usr/bin/dircolors ]; then    test -r ~/.dircolors &amp;&amp; eval &quot;$(dircolors -b ~/.dircolors)&quot; || eval &quot;$(dircolors -b)&quot;    alias ls=&apos;ls --color=auto&apos;    #alias dir=&apos;dir --color=auto&apos;    #alias vdir=&apos;vdir --color=auto&apos;    alias grep=&apos;grep --color=auto&apos;    alias fgrep=&apos;fgrep --color=auto&apos;    alias egrep=&apos;egrep --color=auto&apos;fi# some more ls aliasesalias ll=&apos;ls -alF&apos;alias la=&apos;ls -A&apos;alias l=&apos;ls -CF&apos;</code></pre><p>执行</p><pre><code>source ~/.bashrc</code></pre><h4 id="tmux配合terminator使用"><a href="#tmux配合terminator使用" class="headerlink" title="tmux配合terminator使用"></a>tmux配合terminator使用</h4><p>安装</p><pre><code>sudo apt-get install tmux</code></pre><p>配置</p><pre><code>touch .tmux.conf</code></pre><p>配置内容和使用方法</p><pre><code># 设置前缀为Ctrl + xset -g prefix C-x# 解除Ctrl+b 与前缀的对应关系unbind C-b# 将r 设置为加载配置文件，并显示&quot;reloaded!&quot;信息bind r source-file ~/.tmux.conf \; display &quot;Reloaded!&quot;# copy-mode 将快捷键设置为vi 模式setw -g mode-keys vi# tmux-powerline设置set-option -g status onset-option -g status-interval 2set-option -g status-utf8 onset-option -g status-justify &quot;centre&quot;set-option -g status-left-length 60set-option -g status-right-length 90set-option -g status-left &quot;#(~/.tmux/tmux-powerline/powerline.sh left)&quot;set-option -g status-right &quot;#(~/.tmux/tmux-powerline/powerline.sh right)&quot;# 将窗口列表换成 powerline的风格set-window-option -g window-status-current-format &quot;#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀&quot;# 设置默认bashset-option -g default-shell /bin/zsh########## 复制模式  ########### copy mode 复制模式# &apos;prefix +  [ &apos;进入复制模式# 按space 开始复制# Enter退出复制模式</code></pre><p>需要安装powerline插件</p><pre><code>https://github.com/erikw/tmux-powerline</code></pre><p>显示日期的星期</p><pre><code>vim data_day.sh # date +&quot;%a&quot;改成大写 date +&quot;%A&quot;</code></pre><p>powerline字体安装查看 <a href="http://powerline.readthedocs.io/en/latest/installation/linux.html" target="_blank" rel="noopener">http://powerline.readthedocs.io/en/latest/installation/linux.html</a> 在terminator配置自动启动turm</p><pre><code>首选项-&gt;配置&gt;命令&gt;自定义命令   ([[ -f &quot;$TMUX&quot; ]] &amp;&amp; tmux -2 -S $TMUX) || (TMUX=&quot;&quot; tmux -2)</code></pre><p>自动部署多窗口任务</p><pre><code>touch ~/development.startchmod +x development.starttmux has-session -t developmentif [ $? != 0 ]then    tmux new-session -s development -n editor -d    tmux send-keys -t development &apos;vim&apos; C-m    tmux split-window -v -t development    tmux select-layout -t development main-horizontal    tmux new-window -n bash -t development    tmux new-window -n ssh -t development    tmux new-window -n mysql -t development    tmux new-window -n front-end -t development    tmux select-window -t development:1fitmux attach -t development</code></pre><p>执行文件</p><pre><code>~/development.start</code></pre><h4 id="Visual-Studio-Code"><a href="#Visual-Studio-Code" class="headerlink" title="Visual Studio Code"></a>Visual Studio Code</h4><p>通过官方PPA来安装Ubuntu Make</p><pre><code>sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-makesudo apt-get updatesudo apt-get install ubuntu-make</code></pre><p>安装Ubuntu Make完后，接着使用下列命令安装Visual Studio Code</p><pre><code>umake web visual-studio-code</code></pre><p>卸载命令</p><pre><code>umake web visual-studio-code --remove</code></pre><h4 id="wine"><a href="#wine" class="headerlink" title="wine"></a>wine</h4><p>卸载wineqq</p><pre><code>sudo dpkg -l | grep qq  # 找到安装包名称   sudo dpkg -r wine-qq7.8-longeneteam # 卸载</code></pre><h4 id="curl-http请求"><a href="#curl-http请求" class="headerlink" title="curl http请求"></a>curl http请求</h4><pre><code>curl &quot;http://www.baidu.com&quot; # 如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地  curl -i &quot;http://www.baidu.com&quot; # 显示全部信息  curl -l &quot;http://www.baidu.com&quot; # 只显示头部信息  curl -v &quot;http://www.baidu.com&quot; # 显示get请求全过程解析    curl -d &quot;param1=value1¶m2=value2&quot; &quot;http://www.baidu.com&quot; # post请求  </code></pre><h4 id="安卓虚拟机genymotion"><a href="#安卓虚拟机genymotion" class="headerlink" title="安卓虚拟机genymotion"></a>安卓虚拟机genymotion</h4><p>前提必须安装virtualBox<br>下载地址: <a href="https://www.genymotion.com/download/" target="_blank" rel="noopener">https://www.genymotion.com/download/</a><br>需要先注册,下载后执行</p><pre><code>chmod +x genymotion-2.2.2_x64.bin./genymotion-2.2.2_x64.bin -d /home/user</code></pre><p>执行home/user/genymotion/genymotion</p><h4 id="安装为知笔记"><a href="#安装为知笔记" class="headerlink" title="安装为知笔记"></a>安装为知笔记</h4><p>简易版本</p><pre><code>http://ppa.launchpad.net/wiznote-team/ppa/ubuntu/pool/main/w/wiznote/</code></pre><p>编译安装</p><pre><code>http://www.wiz.cn/compile-client.html</code></pre><p>chrome安装扩展</p><pre><code>https://chrome.google.com/webstore/detail/wiznote-web-clipper/jfanfpmalehkemdiiebjljddhgojhfab/related?hl=zh-CN</code></pre><h4 id="安装系统状态指示器"><a href="#安装系统状态指示器" class="headerlink" title="安装系统状态指示器"></a>安装系统状态指示器</h4><pre><code>sudo add-apt-repository ppa:indicator-multiload/stable-dailysudo apt-get updatesudo apt-get install indicator-multiload</code></pre><h4 id="安装albert搜索框"><a href="#安装albert搜索框" class="headerlink" title="安装albert搜索框"></a>安装albert搜索框</h4><pre><code>sudo add-apt-repository ppa:noobslab/macbuntusudo apt-get updatesudo apt-get install albert设置快捷键Ctrl+/ 样式NUMIX</code></pre><h4 id="下载特殊文件"><a href="#下载特殊文件" class="headerlink" title="下载特殊文件"></a>下载特殊文件</h4><pre><code>sudo apt-get install ktorrentsudo apt-get install amule</code></pre>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python入门基础</title>
      <link href="/2016/11/09/python%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/09/python%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="1-linux源码安装（适合生产环境）"><a href="#1-linux源码安装（适合生产环境）" class="headerlink" title="1. linux源码安装（适合生产环境）"></a>1. linux源码安装（适合生产环境）</h4><p>安装python3.x.x</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 以centos系统安装python3.6.6为例</span><br><span class="line">$ sudo yum groupinstall &quot;Development tools&quot;</span><br><span class="line">$ sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br><span class="line">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class="line">$ tar -xJf Python-3.6.6.tar.xz</span><br><span class="line">$ cd Python-3.6.6</span><br><span class="line">$ ./configure --prefix=/usr/local/python3  # 编译配置</span><br><span class="line">$ sudo make</span><br><span class="line">$ sudo make install</span><br><span class="line"># 创建软链接</span><br><span class="line">$ ln -s /usr/local/python3/bin/python3 /usr/bin/python3</span><br><span class="line">$ ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure><p>安装虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install python-virtualenv  # centos</span><br></pre></td></tr></table></figure><p>创建项目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ virtualenv --no-site-packages -p /usr/bin/python3 .env-project</span><br><span class="line">$ source.env-project/bin/active  # 进入虚拟环境</span><br><span class="line">(.env-project) deactive  # 退出虚拟环境</span><br></pre></td></tr></table></figure><h4 id="2-pyenv安装-适合开发环境"><a href="#2-pyenv安装-适合开发环境" class="headerlink" title="2. pyenv安装(适合开发环境)"></a>2. pyenv安装(适合开发环境)</h4><p>安装pyenv</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash</span><br></pre></td></tr></table></figure><p>设置环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc  # 具体文件看自己的终端工具</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$HOME/.pyenv/bin:$PATH</span><br><span class="line">eval &quot;$(pyenv init -)&quot;</span><br><span class="line">eval &quot;$(pyenv virtualenv-init -)&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ source ~/.zshrc</span><br></pre></td></tr></table></figure><p>检查环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pyenv doctor  # 如有错误，根据自己的环境解决</span><br></pre></td></tr></table></figure><p>安装python3.x.x</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure><p>如果pyenv下载文件缓慢，可以先下载文件到缓存中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~/.pyenv/cache  # 没有则创建文件</span><br><span class="line">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class="line">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure><p>依次安装python3.7.3 python2.7.10</p><p>查看当前系统所有python版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ pyenv versions</span><br><span class="line">* system (set by /home/zhc/.pyenv/version)</span><br><span class="line">  2.7.10</span><br><span class="line">  3.6.6</span><br><span class="line">  3.7.3</span><br></pre></td></tr></table></figure><p>pyenv系统级别global切换版本&lt;pyenv目录级别local切换版本&lt;pyenv当前shell级别切换版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ pyenv global 3.6.6                                                                 </span><br><span class="line">$ pyenv version                                                                     </span><br><span class="line">3.6.6 (set by /home/zhc/.pyenv/version)                                                 </span><br><span class="line">$ pyenv global 3.7.3</span><br><span class="line">$ pyenv version</span><br><span class="line">3.7.3 (set by /home/zhc/.pyenv/version)</span><br><span class="line">$ pyenv shell 3.6.6</span><br><span class="line">$ pyenv version</span><br><span class="line">3.6.6 (set by PYENV_VERSION environment variable) </span><br><span class="line">$ pyenv local 3.6.6  # 会在当前文件夹下创建.python-version文件，存储虚拟环境名称</span><br></pre></td></tr></table></figure><p>pyenv安装虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pyenv virtualenv 3.6.6 test-3.6.6</span><br><span class="line">pyenv virtualenv 3.7.3 test-3.7.3</span><br></pre></td></tr></table></figure><p>pyenv删除虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyenv uninstall test-3.6.6</span><br></pre></td></tr></table></figure><p>pyenv查看全部虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ pyenv virtualenvs                                                                 </span><br><span class="line">  3.6.6/envs/test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)                 </span><br><span class="line">  3.7.3/envs/test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)                 </span><br><span class="line">  test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)</span><br><span class="line">  test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)</span><br></pre></td></tr></table></figure><p>切换虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ pyenv activate test-3.6.6</span><br><span class="line">$ pyenv local test-3.6.6</span><br><span class="line">$ source deactivate</span><br></pre></td></tr></table></figure><p>pyenv重建环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyenv rehash</span><br></pre></td></tr></table></figure><h4 id="源码安装python2-7-9"><a href="#源码安装python2-7-9" class="headerlink" title="源码安装python2.7.9"></a>源码安装python2.7.9</h4><pre><code>$ sudo apt-get install -y openssl$ sudo apt-get install -y libssl-dev # 即 openssl-devel$ sudo apt-get install -y libffi-dev # 即 libffi-devel$ sudo apt-get install -y python-openssl$ sudo apt-get install libbz2-dev$ sudo apt-get install libxml2-dev$ sudo apt-get install libxslt1-dev$ sudo apt-get install sqlite3 libsqlite3-dev$ sudo apt-get install libmysqlclient-devwget -c https://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz  tar -xzvf Python-2.7.9.tgz  cd Python-2.7.9/ </code></pre><p>修改源码，支持ssl</p><pre><code>vim Modules/Setup.dist# Socket module helper for SSL support; you must comment out the other# socket line above, and possibly edit the SSL variable:#SSL=/usr/local/ssl#_ssl _ssl.c \#        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \#        -L$(SSL)/lib -lssl -lcrypto</code></pre><p>改成</p><pre><code># Socket module helper for SSL support; you must comment out the other# socket line above, and possibly edit the SSL variable:SSL=/usr/local/ssl_ssl _ssl.c \        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \        -L$(SSL)/lib -lssl -lcryptoLDFLAGS=&quot;-L/usr/lib/x86_64-linux-gnu&quot; ./configure  make  sudo make install</code></pre><h4 id="虚拟环境搭建"><a href="#虚拟环境搭建" class="headerlink" title="虚拟环境搭建"></a>虚拟环境搭建</h4><p>安装</p><pre><code>sudo apt-get install python-virtualenv</code></pre><p>创建虚拟环境</p><pre><code>cd ~/var/wwwvirtualenv --no-site-packages -p /usr/local/bin/python Novel # 参数表示不安装系统已经安装的第三方包, -p表示用哪个版本的python</code></pre><p>启用虚拟环境</p><pre><code>cd /var/www/Novelsource ./bin/activate</code></pre><p>虚拟环境安装包</p><pre><code>(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><p>退出虚拟环境，进入正常环境</p><pre><code>deactivate</code></pre><p>虚拟环境复制</p><pre><code>pip freeze &gt; requirements.txtpip install -r requirements.txt</code></pre><h4 id="pip安装超时"><a href="#pip安装超时" class="headerlink" title="pip安装超时"></a>pip安装超时</h4><pre><code>pip --default-timeout=100 install -U pip</code></pre><h4 id="安装python-mysql"><a href="#安装python-mysql" class="headerlink" title="安装python-mysql"></a>安装python-mysql</h4><pre><code>sudo apt-get install python-setuptoolssudo apt-get install libmysqld-devsudo apt-get install libmysqlclient-devsudo apt-get install python-devsudo easy_install mysql-python</code></pre><p>在终端输入以下内容,不报错则表示成功</p><pre><code>import MySQLdb</code></pre><h4 id="获取文件修改时间"><a href="#获取文件修改时间" class="headerlink" title="获取文件修改时间"></a>获取文件修改时间</h4><pre><code>import timefilemt= time.localtime(os.stat(filename).st_mtime)  #文件修改时间filect = time.localtime(os.stat(filename).st_ctime)  #文件创建print time.strftime(&quot;%Y-%m-%d&quot;,filemt)  print time.strftime(&quot;%Y-%m-%d&quot;,filect)</code></pre><h4 id="获取多少天以前的时间"><a href="#获取多少天以前的时间" class="headerlink" title="获取多少天以前的时间"></a>获取多少天以前的时间</h4><pre><code>import datetime# 30天以前的日期date_time = (datetime.datetime.now() - datetime.timedelta(days=30)).strftime(&quot;%Y-%m-%d&quot;)print date_time</code></pre><h4 id="去除列表重复项内容"><a href="#去除列表重复项内容" class="headerlink" title="去除列表重复项内容"></a>去除列表重复项内容</h4><pre><code># 如果列表里面内容为字典f = lambda x,y:x if y in x else x + [y]products = reduce(f, [[], ] + products_query)print products# 如果列表里面内容为字符串l1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]l2 = list(set(l1))print l2# 保持原来的顺序l1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]l2 = sorted(set(l1),key=l1.index)print l2</code></pre><h4 id="md5，hash加密"><a href="#md5，hash加密" class="headerlink" title="md5，hash加密"></a>md5，hash加密</h4><pre><code>import hashlibdata =  &apos;This a md5 test!&apos;hash_md5 = hashlib.md5(data)  # md5hash_md5.hexdigest()hashlib.sha1(&apos;This is a sha1 test!&apos;).hexdigest() # sha1</code></pre><h4 id="打印输出对象"><a href="#打印输出对象" class="headerlink" title="打印输出对象"></a>打印输出对象</h4><pre><code>from pprint import pprintpprint(vars(object))</code></pre><h1 id="windows安装python相关环境"><a href="#windows安装python相关环境" class="headerlink" title="windows安装python相关环境"></a>windows安装python相关环境</h1><h4 id="安装虚拟环境"><a href="#安装虚拟环境" class="headerlink" title="安装虚拟环境"></a>安装虚拟环境</h4><pre><code># 安装包pip install virtualenv# 创建虚拟环境envvirtualenv.exe  env# 开启虚拟环境./scripts/active# 退出虚拟环境deactivate</code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos安装s_h_a_d_o_w_s_o_c_k_s服务</title>
      <link href="/2016/11/09/centos%E5%AE%89%E8%A3%85s_h_a_d_o_w_s_o_c_k_s%E6%9C%8D%E5%8A%A1/"/>
      <url>/2016/11/09/centos%E5%AE%89%E8%A3%85s_h_a_d_o_w_s_o_c_k_s%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="Python版本"><a href="#Python版本" class="headerlink" title="Python版本"></a>Python版本</h3><pre><code>python –version</code></pre><p>CentOS6.5默认安装的Python版本是2.6.6，返回值为：Python 2.6.6</p><h3 id="安装setuptools"><a href="#安装setuptools" class="headerlink" title="安装setuptools"></a>安装setuptools</h3><pre><code>yum install -y python-setuptools</code></pre><p>安装完毕后，easy_install命令就可以使用了。</p><h3 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h3><p>easy_install pip 通过easy_install安装pip是最为简单的方法。pip默认安装到/usr/bin目录下。</p><h3 id="安装s-h-a-d-o-w-s-o-c-k-s"><a href="#安装s-h-a-d-o-w-s-o-c-k-s" class="headerlink" title="安装s_h_a_d_o_w_s_o_c_k_s"></a>安装s_h_a_d_o_w_s_o_c_k_s</h3><pre><code>pip install shadowsocks</code></pre><h3 id="s-h-a-d-o-w-s-o-c-k-s的配置和使用"><a href="#s-h-a-d-o-w-s-o-c-k-s的配置和使用" class="headerlink" title="s_h_a_d_o_w_s_o_c_k_s的配置和使用"></a>s_h_a_d_o_w_s_o_c_k_s的配置和使用</h3><p>至于s_h_a_d_o_w_s_o_c_k_s可以拿来做什么，这里就毋须赘述了。直接开始吧。</p><h3 id="创建s-h-a-d-o-w-s-o-c-k-ss的配置文件："><a href="#创建s-h-a-d-o-w-s-o-c-k-ss的配置文件：" class="headerlink" title="创建s_h_a_d_o_w_s_o_c_k_ss的配置文件："></a>创建s_h_a_d_o_w_s_o_c_k_ss的配置文件：</h3><p>CentOS下通过vim创建该配置，运行命令： vi /etc/shadowsocks.json</p><pre><code>{&quot;server&quot;:&quot;your_server_ip&quot;,&quot;server_port&quot;:8989,&quot;local_address&quot;: &quot;127.0.0.1&quot;,&quot;local_port&quot;:1080,&quot;password&quot;:&quot;yourpassword&quot;,&quot;timeout&quot;:600,&quot;method&quot;:&quot;aes-256-cfb&quot;,&quot;fast_open&quot;: false,&quot;workers&quot;: 1}</code></pre><p>各字段的含义： server：服务器 IP (IPv4/IPv6)，注意这也将是服务端监听的 IP 地址<br>server_port：监听的服务器端口<br>local_address：本地监听的 IP 地址<br>local_port：本地端端口<br>password：用来加密的密码<br>timeout：超时时间（秒）<br>method：加密方法，可选择 “bf-cfb”, “aes-256-cfb”, “des-cfb”, “rc4″, 等等。默认是一种不安全的加密，推荐用 “aes-256-cfb” fast_open：true 或 false。如果你的服务器 Linux 内核在3.7+，可以开启 fast_open 以降低延迟。开启方法： echo 3 &gt; /proc/sys/net/ipv4/tcp_fastopen<br>开启之后，将 fast_open 的配置设置为 true 即可。<br>works：works数量，默认为 1</p><h3 id="安装M2Crypto"><a href="#安装M2Crypto" class="headerlink" title="安装M2Crypto"></a>安装M2Crypto</h3><p>默认加密方法 table 速度很快，但很不安全。推荐使用 “aes-256-cfb” 或者 “bf-cfb”。请不要使用 “rc4″，它不安全。如果选择 “table” 之外的加密，需要安装 M2Crypto。 先安装依赖包：</p><pre><code>yum install -y openssl-devel gcc swig python-devel autoconf libtool</code></pre><h3 id="安装setuptools-1"><a href="#安装setuptools-1" class="headerlink" title="安装setuptools"></a>安装setuptools</h3><pre><code>wget --no-check-certificate https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.pypython ez_setup.py install</code></pre><p>再通过pip安装M2Crypto：</p><pre><code>pip install M2Crypto</code></pre><h3 id="安装-gevent"><a href="#安装-gevent" class="headerlink" title="安装 gevent"></a>安装 gevent</h3><p>安装 gevent可以提高 Shadowsocks 的性能。CentOS下安装gevent依赖libevent和greenlet。</p><h3 id="安装libevent"><a href="#安装libevent" class="headerlink" title="安装libevent"></a>安装libevent</h3><pre><code>yum install -y libevent</code></pre><h3 id="greenlet："><a href="#greenlet：" class="headerlink" title="greenlet："></a>greenlet：</h3><pre><code>pip install greenlet</code></pre><p>###安装gevent：</p><pre><code>pip install gevent</code></pre><h3 id="命令行参数（服务器端启动命令）"><a href="#命令行参数（服务器端启动命令）" class="headerlink" title="命令行参数（服务器端启动命令）"></a>命令行参数（服务器端启动命令）</h3><pre><code>ssserver -c /etc/shadowsocks.json</code></pre><p>如果想在后台一直运行Shadowsocks，启动命令如下：</p><pre><code>nohup ssserver -c /etc/shadowsocks.json &gt; /dev/null 2&gt;&amp;1 &amp;</code></pre><p>备注：关于nohup，是可以让程序在后台运行的命令。 同时可以用命令行参数覆盖 /etc/shadowsocks.json 里的设置：</p><pre><code>sslocal -s 服务器地址 -p 服务器端口 -l 本地端端口 -k 密码 -m 加密方法ssserver -p 服务器端口 -k 密码 -m 加密方法</code></pre><p>备注：sslocal是客户端程序；ssserver是服务端程序。</p><h3 id="防火墙设置（如有）"><a href="#防火墙设置（如有）" class="headerlink" title="防火墙设置（如有）"></a>防火墙设置（如有）</h3><p>编辑防火墙配置文件/etc/sysconfig/iptables，将服务器端口（server_port）放行。<br>新增一条防火墙规则：</p><pre><code>iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8989 -j ACCEPT</code></pre><p>先要保存下:</p><pre><code>service iptables save</code></pre><p>重启防火墙iptables：</p><pre><code>service iptables restart</code></pre><p>至此，服务器端的 Shadowsocks 安装和配置完毕。 配置多个用户</p><pre><code>{&quot;timeout&quot;: 600,&quot;method&quot;: &quot;aes-256-cfb&quot;,&quot;port_password&quot;:{&quot;40001&quot;: &quot;password1&quot;,&quot;40002&quot;: &quot;password2&quot;,&quot;40003&quot;: &quot;password3&quot;},&quot;_comment&quot;:{&quot;40001&quot;: &quot;xiaoming&quot;,&quot;40002&quot;: &quot;lilei&quot;,&quot;40003&quot;: &quot;mike&quot;}}</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python将office word 转为html 并提取相关图片信息</title>
      <link href="/2016/11/09/python%E5%B0%86office%20word%20%E8%BD%AC%E4%B8%BAhtml%20%E5%B9%B6%E6%8F%90%E5%8F%96%E7%9B%B8%E5%85%B3%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF/"/>
      <url>/2016/11/09/python%E5%B0%86office%20word%20%E8%BD%AC%E4%B8%BAhtml%20%E5%B9%B6%E6%8F%90%E5%8F%96%E7%9B%B8%E5%85%B3%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>工作需要将2000多格word文档中的图片提取出来，并改名为word文档名</p><h3 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h3><blockquote><p>More exactly, a .docx document is a Zip archive in OpenXML format: you have first to uncompress it. I downloaded a sample (Google: some search term filetype:docx) and after unzipping I found some folders. The word folder contains the document itself, in file document.xml.</p></blockquote><p>于是使用unzip模块</p><pre><code>import zipfile</code></pre><p>但是报错</p><pre><code>BadZipfile: File is not a zip file</code></pre><p>检查发现同事提供的office word文件结尾为.doc,<br>于是使用7-zip进行提取发现确实报错</p><blockquote><p>文件末端错误</p></blockquote><p>尝试用本机office2013打开并另存为word文档.docx<br>再次使用7-zip进行提取，成功，会生成以下一个文件夹</p><blockquote><p>_rels文件夹<br>docProps文件夹<br>word文件夹<br>[Content_Types].xml文件</p></blockquote><p>其中\word\media文件夹下就有我需要的图片信息<br>既然需要更改文件后缀，那么就有另一个思路。</p><h3 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h3><blockquote><p>通过win32com.clientm将文件改为html文件，会生成类似的文件夹</p></blockquote><p>核心代码</p><pre><code># -*- encoding: utf8 -*-import win32comfrom win32com.client import constants# 打开初始化word文档w = win32com.client.Dispatch(&apos;Word.Application&apos;)w.Visible = 0w.DisplayAlerts = 0doc = w.Documents.Open(source_file)  # 打开文件doc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件doc.Close()w.Quit()</code></pre><p>另存为其他规格只需要将参数8修改即可</p><blockquote><p>wdFormatDocument = 0<br>wdFormatDocument97 = 0<br>wdFormatDocumentDefault = 16<br>wdFormatDOSText = 4<br>wdFormatDOSTextLineBreaks = 5<br>wdFormatEncodedText = 7<br>wdFormatFilteredHTML = 10<br>wdFormatFlatXML = 19<br>wdFormatFlatXMLMacroEnabled = 20<br>wdFormatFlatXMLTemplate = 21<br>wdFormatFlatXMLTemplateMacroEnabled = 22<br>wdFormatHTML = 8<br>wdFormatPDF = 17<br>wdFormatRTF = 6<br>wdFormatTemplate = 1<br>wdFormatTemplate97 = 1<br>wdFormatText = 2<br>wdFormatTextLineBreaks = 3<br>wdFormatUnicodeText = 7<br>wdFormatWebArchive = 9<br>wdFormatXML = 11<br>wdFormatXMLDocument = 12<br>wdFormatXMLDocumentMacroEnabled = 13<br>wdFormatXMLTemplate = 14<br>wdFormatXMLTemplateMacroEnabled = 15<br>wdFormatXPS = 18</p></blockquote><p>最后脚本</p><pre><code># -*- encoding: utf8 -*-import win32comimport osimport xlrdimport shutilfrom win32com.client import constants# 从excel表格中导入数据并组成字典XlsFile = &apos;default.xlsx&apos;                  # 需要的数据data = xlrd.open_workbook(XlsFile)table = data.sheets()[0]nrows = table.nrows# 获取文件名列表number_list = []for i in range(1, nrows):    number_list.append(table.row_values(i)[0])# 打开初始化word文档w = win32com.client.Dispatch(&apos;Word.Application&apos;)w.Visible = 0w.DisplayAlerts = 0# 遍历文件夹并将文件剪贴到新的文件夹中source_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;WordFile&apos;target_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;NewFile&apos;img_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;Img&apos;word_list = os.listdir(source_fold)for file_name in word_list:    # 根据货号在列表中查找    try:        file_number = file_name[0:10]        if file_number in number_list:            print(file_name + &apos;是需要的文件.&apos;)            source_file = source_fold + &apos;/&apos; + file_name            doc = w.Documents.Open(source_file)  # 打开文件            doc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件            doc.Close()            od_img = target_fold + &apos;/&apos; + file_number + &apos;.files&apos; + &apos;/&apos; + &apos;image003.jpg&apos;            shutil.copyfile(od_img, img_fold + &apos;/&apos; + file_number + &apos;.jpg&apos;)  # 复制新的文件            number_list.remove(file_number)  # 从excel列表中删除此元素防止重复选取    except Exception, e:        print(file_name)        print ew.Quit()try:    f = open(&quot;php.json&quot;, &quot;w&quot;)    print &gt;&gt;f, number_list  # 最后将剩下的元素打印到文件中except Exception, e:    print &apos;写入php.json失败&apos;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python从excel导出数据并批量替换word文档内容</title>
      <link href="/2016/11/09/python%E4%BB%8Eexcel%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2word%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9/"/>
      <url>/2016/11/09/python%E4%BB%8Eexcel%E5%AF%BC%E5%87%BA%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2word%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9/</url>
      
        <content type="html"><![CDATA[<h3 id="老外的代码"><a href="#老外的代码" class="headerlink" title="老外的代码"></a>老外的代码</h3><p>第一个是操作word，第二个是操作excel</p><pre><code>from win32com.client import constants, Dispatchimport pythoncomwdStory = 6class WordDocument(object):  &quot;&quot;&quot;  Some convenience methods for Word documents accessed  through COM.  &quot;&quot;&quot;  def __init__(self, visible=False):    self.app = Dispatch(&quot;Word.Application&quot;)    self.app.Visible = visible  def new(self, filename=None):    &quot;&quot;&quot;    Create a new Word document. If &apos;filename&apos; specified,    use the file as a template.    &quot;&quot;&quot;    self.app.Documents.Add(filename)  def open(self, filename):    &quot;&quot;&quot;    Open an existing Word document for editing.    &quot;&quot;&quot;    self.app.Documents.Open(filename)  def save(self, filename=None):    &quot;&quot;&quot;    Save the active document. If &apos;filename&apos; is given,    do a Save As.    &quot;&quot;&quot;    if filename:      self.app.ActiveDocument.SaveAs(filename)    else:      self.app.ActiveDocument.Save()  def save_as(self, filename):    return self.save(filename)  def print_out(self):    &quot;&quot;&quot;    Print the active document.    &quot;&quot;&quot;    self.app.Application.PrintOut()  def close(self):    &quot;&quot;&quot;    Close the active document.    &quot;&quot;&quot;    self.app.ActiveDocument.Close()  def quit(self):    &quot;&quot;&quot;    Quit Word.    &quot;&quot;&quot;    return self.app.Quit()  def find_and_replace(self, find_str, replace_str):    &quot;&quot;&quot;    Find all occurances of &apos;find_str&apos; and replace with &apos;replace_str&apos;    in the active document.    &quot;&quot;&quot;    self.app.Selection.HomeKey(Unit=wdStory)    find = self.app.Selection.Find    find.Text = find_str    while self.app.Selection.Find.Execute():      self.app.Selection.TypeText(Text=replace_str)from win32com.client import constants, Dispatchimport pythoncomimport osborderTop = 3borderBottom = 4borderLeft = 1borderRight = 2borderSolid = 1borderDashed = 2borderDotted = 3colorBlack = 1directionUp = -4162directionDown = -4121directionLeft = -4131directionRight = -4152class ExcelDocument(object):  &quot;&quot;&quot;  Some convenience methods for Excel documents accessed  through COM.  &quot;&quot;&quot;  def __init__(self, visible=False):    self.app = Dispatch(&quot;Excel.Application&quot;)    self.app.Visible = visible    self.sheet = 1  def new(self, filename=None):    &quot;&quot;&quot;    Create a new Excel workbook. If &apos;filename&apos; specified,    use the file as a template.    &quot;&quot;&quot;    self.app.Workbooks.Add(filename)  def open(self, filename):    &quot;&quot;&quot;    Open an existing Excel workbook for editing.    &quot;&quot;&quot;    self.app.Workbooks.Open(filename)  def set_sheet(self, sheet):    &quot;&quot;&quot;    Set the active worksheet.    &quot;&quot;&quot;    self.sheet = sheet  def get_range(self, range):    &quot;&quot;&quot;    Get a range object for the specified range or single cell.    &quot;&quot;&quot;    return self.app.ActiveWorkbook.Sheets(self.sheet).Range(range)  def set_value(self, cell, value=&apos;&apos;):    &quot;&quot;&quot;    Set the value of &apos;cell&apos; to &apos;value&apos;.    &quot;&quot;&quot;    self.get_range(cell).Value = value  def get_value(self, cell):    &quot;&quot;&quot;    Get the value of &apos;cell&apos;.    &quot;&quot;&quot;    value = self.get_range(cell).Value    if isinstance(value, tuple):      value = [v[0] for v in value]    return value  def set_border(self, range, side, line_style=borderSolid, color=colorBlack):    &quot;&quot;&quot;    Set a border on the specified range of cells or single cell.    &apos;range&apos; = range of cells or single cell    &apos;side&apos; = one of borderTop, borderBottom, borderLeft, borderRight    &apos;line_style&apos; = one of borderSolid, borderDashed, borderDotted, others?    &apos;color&apos; = one of colorBlack, others?    &quot;&quot;&quot;    range = self.get_range(range).Borders(side)    range.LineStyle = line_style    range.Color = color  def sort(self, range, key_cell):    &quot;&quot;&quot;    Sort the specified &apos;range&apos; of the activeworksheet by the    specified &apos;key_cell&apos;.    &quot;&quot;&quot;    range.Sort(Key1=self.get_range(key_cell), Order1=1, Header=0, OrderCustom=1, MatchCase=False, Orientation=1)  def hide_row(self, row, hide=True):    &quot;&quot;&quot;    Hide the specified &apos;row&apos;.    Specify hide=False to show the row.    &quot;&quot;&quot;    self.get_range(&apos;a%s&apos; % row).EntireRow.Hidden = hide  def hide_column(self, column, hide=True):    &quot;&quot;&quot;    Hide the specified &apos;column&apos;.    Specify hide=False to show the column.    &quot;&quot;&quot;    self.get_range(&apos;%s1&apos; % column).EntireColumn.Hidden = hide  def delete_row(self, row, shift=directionUp):    &quot;&quot;&quot;    Delete the entire &apos;row&apos;.    &quot;&quot;&quot;    self.get_range(&apos;a%s&apos; % row).EntireRow.Delete(Shift=shift)  def delete_column(self, column, shift=directionLeft):    &quot;&quot;&quot;    Delete the entire &apos;column&apos;.    &quot;&quot;&quot;    self.get_range(&apos;%s1&apos; % column).EntireColumn.Delete(Shift=shift)  def fit_column(self, column):    &quot;&quot;&quot;    Resize the specified &apos;column&apos; to fit all its contents.    &quot;&quot;&quot;    self.get_range(&apos;%s1&apos; % column).EntireColumn.AutoFit()  def save(self):    &quot;&quot;&quot;    Save the active workbook.    &quot;&quot;&quot;    self.app.ActiveWorkbook.Save()  def save_as(self, filename, delete_existing=False):    &quot;&quot;&quot;    Save the active workbook as a different filename.    If &apos;delete_existing&apos; is specified and the file already    exists, it will be deleted before saving.    &quot;&quot;&quot;    if delete_existing and os.path.exists(filename):      os.remove(filename)    self.app.ActiveWorkbook.SaveAs(filename)  def print_out(self):    &quot;&quot;&quot;    Print the active workbook.    &quot;&quot;&quot;    self.app.Application.PrintOut()  def close(self):    &quot;&quot;&quot;    Close the active workbook.    &quot;&quot;&quot;    self.app.ActiveWorkbook.Close()  def quit(self):    &quot;&quot;&quot;    Quit Excel.    &quot;&quot;&quot;    return self.app.Quit()</code></pre><h3 id="基本使用方法"><a href="#基本使用方法" class="headerlink" title="基本使用方法"></a>基本使用方法</h3><pre><code># -*- encoding: utf8 -*-# 配置项import osimport shutilimport reimport timeimport win32comfrom win32com.client import constantsimport xlrdXlsFile = &apos;default.xls&apos;                  # 需要的数据OldStrs = [&apos;#CatalogNumber#&apos;,           &apos;#ProductName#&apos;,           &apos;#OSpecies#&apos;,           &apos;#Short#&apos;,           &apos;#Organism#&apos;,           &apos;#Fragment#&apos;,           &apos;#PROTEIN#&apos;,           &apos;#Tag#&apos;           ]# 确认模板类型DefaultFile = raw_input(&apos;Want to use ihc.jpg,input \&apos;Y\&apos;,or input \&apos;N\&apos;:\n&apos;)if DefaultFile == &apos;N&apos;:    DocFile = os.path.abspath(&apos;default_noihc.doc&apos;)    print DocFileelif DefaultFile == &apos;Y&apos;:    DocFile = os.path.abspath(&apos;default.doc&apos;)    print DocFileelse:    raisefilepath = &apos;D:/Py/CreateAntibodyWord/NewFile&apos;    # 生成文件目录# 获取括号内容的正则表达式patt = re.compile(r&quot;\((.*?)\)&quot;, re.I | re.X)# 打开初始化word文档w = win32com.client.Dispatch(&apos;Word.Application&apos;)w.Visible = 0w.DisplayAlerts = 0# 从excel表格中导入数据data = xlrd.open_workbook(XlsFile) table = data.sheets()[0]nrows = table.nrows# 循环表格中的内容for i in range(1, nrows):    try:        # 获取新的数据        CatalogNumber = table.row_values(i)[0]        ProductName = table.row_values(i)[1]        OrganismSpecies = table.row_values(i)[2]        Tag = table.row_values(i)[3]        Fragment = table.row_values(i)[4]        Short = patt.findall(ProductName)[0]        # 获取对应蛋白的货号        ProteinNumber = re.sub(r&apos;^PA&apos;, r&apos;RP&apos;, CatalogNumber)        # Ge多物种没有缩写，用General替代        Organism = patt.findall(OrganismSpecies)        if len(Organism) &gt; 0:            Organism = Organism[0]        else:            Organism = &apos;General&apos;        # 没有氨基酸片段信息的用原始值替代        Fragment = patt.findall(Fragment)        if len(Fragment) &gt; 0:            Fragment = Fragment[0]        else:            Fragment = &apos;#Fragment#&apos;        NewStrs = [CatalogNumber,                   ProductName,                   OrganismSpecies,                   Short,                   Organism,                   Fragment,                   ProteinNumber,                   Tag                   ]        # 打开复制的文件        NewFileName = CatalogNumber + &apos;-e.doc&apos;                                        # 命名新的文件        shutil.copyfile(DocFile, filepath + &apos;/&apos; + NewFileName)                        # 复制新的文件        CopyFile = os.path.abspath(filepath + &apos;/&apos; + NewFileName)                      # 新的文件目录        doc = w.Documents.Open(FileName=CopyFile)                                     # 打开文件        # 文本框处理        canvas = doc.Shapes[2]        canvas.TextFrame.TextRange.Find.Execute(OldStrs[3], False, False, False, False, False, True, 1, True, NewStrs[3], 2)        canvas.TextFrame.TextRange.Find.Execute(OldStrs[4], False, False, False, False, False, True, 1, True, NewStrs[4], 2)        # 正文文字处理        w.Selection.Find.ClearFormatting()        w.Selection.Find.Replacement.ClearFormatting()        for j in range(len(NewStrs)):            w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)        # 获取属性信息并修改,参考https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.builtindocumentproperties(v=vs.120).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1        doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductName        doc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;        doc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductName        doc.BuiltInDocumentProperties(&apos;Category&apos;).Value = OrganismSpecies        # 保存文件并关闭        doc.Save()        doc.Close()        print CatalogNumber + &apos; create word success!&apos;    # 捕获异常并写入log文件中    except Exception, e:        print CatalogNumber + &apos; create word error!&apos;        print e        errorfile = open(filepath + &apos;/errorlog.txt&apos;, &apos;a&apos;)        try:            errorfile.write(CatalogNumber + &apos; create word error! &apos; + time.strftime(&apos;%Y-%m-%d %H:%M:%S&apos;) + &apos;\n&apos;)        except Exception, e:            doc.Close()            w.Quit()            raise e        finally:            errorfile.close()w.Quit()        </code></pre><h3 id="替换Word文档属性里的详细信息"><a href="#替换Word文档属性里的详细信息" class="headerlink" title="替换Word文档属性里的详细信息"></a>替换Word文档属性里的详细信息</h3><pre><code>doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductNamedoc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;doc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductNamedoc.BuiltInDocumentProperties(&apos;Category&apos;).Value = Ospecies</code></pre><p>参考<a href="http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box" target="_blank" rel="noopener">微软官方说明</a></p><h3 id="替换Word长文本"><a href="#替换Word长文本" class="headerlink" title="替换Word长文本"></a>替换Word长文本</h3><p>使用以下语句替换长文本会报错”字符串过长”</p><pre><code>w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)</code></pre><p>使用以下语句</p><pre><code>find = w.Selection.Findfind.Text = &apos;#SEQUENCE#&apos;while w.Selection.Find.Execute():    w.Selection.TypeText(Text=SEQUENCE)</code></pre><h3 id="替换Word文本框内容"><a href="#替换Word文本框内容" class="headerlink" title="替换Word文本框内容"></a>替换Word文本框内容</h3><p>参考以下代码 <a href="http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box" target="_blank" rel="noopener">http://stackoverflow.com/</a></p><pre><code>import win32com.clientword = win32com.client.Dispatch(&quot;Word.Application&quot;)canvas = word.ActiveDocument.Shapes[0]for item in canvas.CanvasItems:    print item.TextFrame.TextRange.Text</code></pre><p>或者</p><pre><code>find = shp.TextFrame.TextRange.Findfind.Text = sourcefind.Replacement.Text = targetfind.Execute(Replace=1, Forward=True)</code></pre>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况</title>
      <link href="/2016/11/09/%E5%B1%80%E5%9F%9F%E7%BD%91%E9%83%A8%E5%88%86%E7%94%B5%E8%84%91%E4%B8%8D%E8%83%BD%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C,%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9,%E6%89%93%E5%8D%B0%E6%9C%BA%E7%AD%89%E6%83%85%E5%86%B5/"/>
      <url>/2016/11/09/%E5%B1%80%E5%9F%9F%E7%BD%91%E9%83%A8%E5%88%86%E7%94%B5%E8%84%91%E4%B8%8D%E8%83%BD%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C,%E5%B1%80%E5%9F%9F%E7%BD%91%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9,%E6%89%93%E5%8D%B0%E6%9C%BA%E7%AD%89%E6%83%85%E5%86%B5/</url>
      
        <content type="html"><![CDATA[<h3 id="问题反应"><a href="#问题反应" class="headerlink" title="问题反应"></a>问题反应</h3><p>今天公司出现网络故障，有2个部门全部不能连接网络。</p><h3 id="正常问题"><a href="#正常问题" class="headerlink" title="正常问题"></a>正常问题</h3><blockquote><p>一台电脑不能上网，找该台电脑的问题<br>一部门电脑不能上网，找该部门交换机<br>多部门电脑不能上网，找主交换机问题<br>全部不能上网，拿电脑直连路由</p></blockquote><h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>公司主交换机A<br>部门分交换机B<br>测试电脑C<br>部门不能上网故障，正常情况应该是A模块出现问题。于是重启A，仍然有一个部门故障。<br>重启B，不能解决问题。<br>将C与B直连的线路连接到C，C正常。<br>A,B问题都排除，那么问题在哪？<br>继续尝试，B上只连接C，正常。B上连接该部门全部电脑，故障。<br>找到那条会导致故障的线路，换掉网线，OK.<br>确认问题原因居然是<strong><em>网线！</em></strong></p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>子交换机上的网线问题会影响主交换。</p><h3 id="共享打印机安装出现0x00000709"><a href="#共享打印机安装出现0x00000709" class="headerlink" title="共享打印机安装出现0x00000709"></a>共享打印机安装出现0x00000709</h3><p>解决办法：重启打印机服务器的Print Spooler服务，重启本地计算机</p><h3 id="账号密码问题"><a href="#账号密码问题" class="headerlink" title="账号密码问题"></a>账号密码问题</h3><p>局域网有xp电脑可以正常访问共享电脑，排序账号密码问题。</p><h3 id="共享设置问题"><a href="#共享设置问题" class="headerlink" title="共享设置问题"></a>共享设置问题</h3><p>xp系统访问正常，win7系统访问显示“帐号密码错误”。于是想到共享设置问题。</p><blockquote><p>开始=&gt;<br>运行=&gt;<br>gpedit.msc=&gt;<br>本地计算机策略=&gt;<br>计算机配置=&gt;<br>Windows设置=&gt;<br>安全设置=&gt;<br>本地策略=&gt;<br>安全选项=&gt;<br>网络安全：LAN管理器身份验证级别=&gt;<br>发送LM &amp; NTLM响应</p></blockquote><p>但是之前win7是可以正常访问的，所以该项设置是正确的。</p><h3 id="时间设置问题"><a href="#时间设置问题" class="headerlink" title="时间设置问题"></a>时间设置问题</h3><p>于是询问是什么时候不能访问的，告之电脑蓝屏重启后。那么原因自然是蓝屏导致共享电脑设置的时间出现错误。</p><blockquote><p>如果win7的系统时间和访问的共享文件夹的创建时间间隔太长的话，会出现此现象。这是win7的安全机制造成的。<br>将共享电脑时间设置为当前时间即可</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>window常用软件</title>
      <link href="/2016/11/08/window%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/"/>
      <url>/2016/11/08/window%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="压缩软件7-zip"><a href="#压缩软件7-zip" class="headerlink" title="压缩软件7-zip"></a>压缩软件7-zip</h3><p>终端命令(需要将安装目录添加到环境变量)</p><blockquote><p>7z a file.zip filefold #添加文件压缩<br>7z e file.zip filefold #释放文件解压</p></blockquote><h3 id="电脑清理ccleaner"><a href="#电脑清理ccleaner" class="headerlink" title="电脑清理ccleaner"></a>电脑清理ccleaner</h3><p>电脑清理工具：清理注册表，系统垃圾文件 下载地址 <a href="http://pan.baidu.com/s/1c0G34re" target="_blank" rel="noopener">http://pan.baidu.com/s/1c0G34re</a><br>断网后注册，可用注册码</p><blockquote><p>注册名： R J. van der Linden<br>注册码：CBEW-ZZJA-84DT-VZQG-SRJC<br>注册名：Registered User<br>注册码：CBB4-FJN4-EPC6-G5P6-QT4C</p></blockquote><h3 id="卸载软件Total-Uninstall"><a href="#卸载软件Total-Uninstall" class="headerlink" title="卸载软件Total Uninstall"></a>卸载软件Total Uninstall</h3><p>电脑清理工具：卸载软件<br>破解版v6.16.0下载地址<a href="http://pan.baidu.com/s/1mgwAta4" target="_blank" rel="noopener">http://pan.baidu.com/s/1mgwAta4</a></p><h3 id="驱动管理工具DriverDownloader"><a href="#驱动管理工具DriverDownloader" class="headerlink" title="驱动管理工具DriverDownloader"></a>驱动管理工具DriverDownloader</h3><p>下载地址 <a href="http://pan.baidu.com/s/1qW9tPF2" target="_blank" rel="noopener">http://pan.baidu.com/s/1qW9tPF2</a><br>需要使用代理更新驱动，在Settings设置(前提是设置了代理上网)</p><blockquote><p>proxy 127.0.0.1<br>port 1080</p></blockquote><p>注册码</p><blockquote><p>DF12-2RM2-JDPE-1009</p></blockquote><p>如果提示its usage limit 将1009改成逐渐+1，改成1010，1011等等等等</p><h3 id="下载工具IDM-Internet-Download-Manager-6-25版"><a href="#下载工具IDM-Internet-Download-Manager-6-25版" class="headerlink" title="下载工具IDM(Internet Download Manager)6.25版"></a>下载工具IDM(Internet Download Manager)6.25版</h3><p>下载地址<br><a href="http://www.internetdownloadmanager.com/download.html" target="_blank" rel="noopener">官网</a><br><a href="http://pan.baidu.com/s/1c0Be5Bq" target="_blank" rel="noopener">官网下载版</a><br><a href="http://pan.baidu.com/s/1eQfmv8e" target="_blank" rel="noopener">破解版</a><br>注册码(断网注册)</p><pre><code>DBNJC-D4R59-YPAGA-T3S1Q  #已经失效  F9TZ9-P6IGF-SME74-2WP21  CJA0S-K6CO4-R4NPJ-EKNRK  F9TZ9-P6IGF-SME74-2WP21  CJA0S-K6CO4-R4NPJ-EKNRK  N0Z90-KJTTW-7TZO4-I27A1  629U7-XLT5H-6SCGJ-2CENZ  XONF7-PMUOL-HU7P4-D1QQX  N0Z90-KJTTW-7TZO4-I27A1  L67GT-CE6TR-DFT1D-XWVCM </code></pre><p>或者使用host修改办法<br>host文件添加</p><pre><code>127.0.0.1 registeridm.com127.0.0.1 www.registeridm.com127.0.0.1 www.internetdownloadmanager.com</code></pre><p>打开IDM，注册，注册码如下：</p><pre><code>OS5HG-K90NH-SXOGT-7JYEZR2C1T-O0KQO-JAVU2-4MMYPM2A16-47AAW-6NLYP-V1E0JIZO7M-360FW-QY1XP-AWLPN46YFS-S9G7H-QZFWI-QQBQBTUTR2-I2NHO-GQBC6-ZECWH</code></pre><h3 id="终端管理工具Cmder"><a href="#终端管理工具Cmder" class="headerlink" title="终端管理工具Cmder"></a>终端管理工具Cmder</h3><p>下载地址<a href="http://cmder.net/" target="_blank" rel="noopener">官方</a></p><h3 id="文件图片批量处理软件"><a href="#文件图片批量处理软件" class="headerlink" title="文件图片批量处理软件"></a>文件图片批量处理软件</h3><p>Bulk Rename Utility<br>下载地址<a href="http://www.bulkrenameutility.co.uk/Main_Intro.php" target="_blank" rel="noopener">官方</a><a href="http://pan.baidu.com/s/1sjpaa1R" target="_blank" rel="noopener">云盘</a></p><h3 id="文件资源管理器Total-Commander"><a href="#文件资源管理器Total-Commander" class="headerlink" title="文件资源管理器Total Commander"></a>文件资源管理器Total Commander</h3><p><a href="http://pan.baidu.com/s/1dEvQm5b" target="_blank" rel="noopener">破解版下载</a><br>快捷键</p><blockquote><p>F3——查看文件<br>F4——编辑文件<br>F5——拷贝文件<br>F6——重命名、移动文件<br>F7——新建文件夹<br>F8——删除文件、文件夹<br>F10——菜单条激活开关<br>ALT<br>Alt+F1——改变左边窗口的驱动器<br>Alt+F2——改变右边窗口的驱动器<br>Alt+Shift+F3——使用内部查看程序浏览文件<br>Alt+F5——压缩文件/文件夹<br>Alt+Shift+F5——压缩文件/文件夹，并删除原文件/文件夹<br>Alt+F7——查找文件/文件夹<br>Alt+F9——文件解压缩<br>Alt+left/right——切换至上次进入的前一个/后一个文件夹<br>Alt+down——显示历史访问地址列表<br>SHIFT<br>Shift+F4——用外部编辑器（UltraEdit）创建新文件<br>Shift+F5——复制（重命名）文件/文件夹到当前文件夹<br>Shift+Ctrl+F5——创建所选对象的快捷方式<br>Shift+F6——重命名文件/文件夹<br>Shift+ESC——Total Commander最小化<br>NUM<br>NUM + ——选择属性相同的一组文件<br>NUM — ——清除所选文件中属性相同的一组文件<br>NUM * ——反向选择<br>NUM / ——恢复选择<br>CTRL+NUM + ——全部选择<br>CTRL+NUM - ——清除全部选择<br>Alt+NUM + ——选择与当前光标选中的文件扩展名相同的一组文件<br>CTRL<br>Ctrl+PgUP——回上一级目录<br>Ctrl+left/right——在左边/右边文件窗口中显示当前文件夹列表<br>CTRL+/——返回根目录<br>CTRL+SHIFT+F1——缩略图视图（图片预览）<br>CTRL+F2——显示文件/文件夹详细资料<br>CTRL+F3——以名称排序<br>CTRL+F4——以扩展名排序<br>CTRL+F5——以文件的创建时间排序<br>CTRL+F6——以文件的大小排序<br>CTRL+F8——显示目录结构<br>CTRL+F9——打印当前光标处的文件<br>CTRL+F10——显示所有文件<br>CTRL+F11——显示所有可执行文件/隐藏非执行文件<br>CTRL+ENTER——将当前文件名复制到TC的命令行<br>CTRL+SHIFT+ENTER——将当前完整路径及文件名复制到TC的命令行<br>CTRL+D——打开常用文件夹列表（可作书签用）<br>CTRL+F——连接到FTP服务器<br>CTRL+SHIFT+F——断开与FTP服务器的连接<br>CTRL+Q——打开/关闭快速查看<br>CTRL+U——切换左右文件窗口显示内容<br>CTRL+W——关闭当前目录标签<br>CTRL+SHIFT+W——关闭所有目录标签<br>CTRL+Y——清空命令行输入框并置光标于命令行<br>ESC——清空命令行输入框并置光标于文件窗口<br>INSERT——选择文件/目录<br>SPACE——选择文件/目录<br>SHIFT+ENTER——<br>1.当命令行输入框有字符串命令：运行命令行的字符串命令<br>2.当光标位于压缩文件用相应的压缩工具打开压缩文件<br>3.位于压缩文件内：将所选中的文件解到临时文件目录，并试图将其做压缩文件的解压处理<br>ALT+ENTER——显示所选文件属性<br>Total Commander常用快捷键<br>显示编辑文件：<br>F3：这个恐怕是使用程度最高的快捷键了，专门用来查看文件。需要说明的是，默认安装的TC 5.5版只能查看文本及一些关联的影像文件，图片只支持BMP等很少的种类。如需要查看更多类型的文件，还需要安装插件。<br>Ctrl + Q：快速预览。<br>F4：主要用来编辑文本文件。可以设置外部程序来编辑文本(我设置的是Editplus)。<br>Shift + F4： 新建文本文件，调用记事本编辑（自定义编辑器）。<br>Ctrl + Z： 编辑文件/文件夹的说明。<br>Ctlt + Enter：查看文件或文件夹属性。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br>Shift + 空格： 选中光标所在，不计算文件夹的容量。<br>Alt + Shift + Enter：计算当前窗格下所有文件夹的占用空间，设置后再点击顶栏的“大小”可使文件夹参与排序，迅速找到占用空间最大的文件夹。<br>Ctrl+Shift+Enter获取光标所在处文件/文件夹的绝对路径并显示在命令行里。 操作复制文件<br>F5：复制文件，这个也是最常用的快捷键之一。TC分为左、右两个窗口，我们把光标选中的文件拷贝到另一个窗口。另外，TC也支持以鼠标拖拽方式复制文件，两者哪个更方便完全由你的个人喜好决定。<br>Shift + F5： 同目录复制<br>F6：移动文件，将光标选中的文件移动到另一个窗口。<br>shift+Ins TC中的块拷贝<br>SHIFT + F6 重命名文件（F2修改版）<br>Ctrl + M： 批量更改文件名。<br>空格 选择文件/文件夹(如同 INSERT)。如果光标处文件夹还未选中，按空格键后，计算其占用空间（含子文件夹）并用字节数代替</p><p>（详细资料显示方式下）。通过 ‘配置’ - ‘选项’ - ‘操作’ - ‘用空格键选择’ 可禁用该特性。 右键长按 在NC风格下这是调用 Windows 风格下的右键菜单<br>Shift + F10——显示关联试菜单，类似于鼠标右键的效果<br>新建<br>SHIFT + F4 新建文本文件，加载到编辑器(自定义）<br>F7：新建一个或多层文件夹。可以像DOS那样新建多层的目录，比如c:/file/a/b/c 删除<br>F8 / Del：删除文件。与Windows一样，按住Shift + Delete，则直接删除而不放到回收站中。<br>搜索定位<br>Alt + Ctrl + 任意字母 或 Alt+任意字母 或 任意字母 ：快速定位文件 [菜单：配置–选项–快速搜索 中设置]<br>Alt + F7：搜索。有了TC之后，我再没用过Windows系统自带的搜索。TC的搜索简单，而且速度快，功能全，非常好用。<br>Ctrl + D：常用文件夹列表。按下会弹出浮动窗口，能够快速跳转到设定好的文件夹中。(非常好用）<br>ctrl + s: 快速搜索只显示所选文件<br>Alt + ↓：历史文件夹列表，可以快速回溯到你曾经到过的某个文件夹。<br>Alt + ← 或 →：快速后退或前进历史目录。<br>Tab： 左右窗口间切换。<br>Alt + Tab： 窗口标签间切换。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br><em>(小键盘星号键)：反向选择。<br>+(小键盘加号键)：选择全部或指定类型的文件。<br>-(小键盘加号键)：取消选择全部或指定类型的文件。<br>Ctrl + A：全选当前窗口所有文件。与Windows资源管理器不同，按下此快捷键并不选中文件夹。<br>Shift + ↓ 和 Shift + ↑：选择或取消选择文件或文件夹。<br>Ctrl+↑： 在当前窗口的新标签中打开光标处文件夹<br>Ctrl+↓： 在对面窗口的新标签中打开光标处文件夹<br>Ctrl + ←/→：如果光标在窗格顶部，将左/右窗格的显示内容调整为一样的；如果光标所在处是一个文件夹，在左/右窗格打开此文件夹；如果光标所在处是一个压缩文件，在左/右窗格打开此文件。<br>Ctrl + num</em> 锁定/解锁当前标签。<br>ALT+F1 改变左侧窗口的驱动器<br>ALT+F2 改变右侧窗口的驱动器<br>压缩文件<br>Alt + F5：压缩选中的文件。按下回车，生成后的压缩包将会出现另一个目的窗口中。<br>Alt + F6 解压缩文件<br>显示方式<br>Ctrl + B： 显示当前文件夹及子文件夹下的所有文件。<br>Ctrl + R： 刷新<br>Ctrl + F1-8、10-12 不同方式在窗口显示文件列表</p></blockquote><h3 id="翻译软件-灵格斯"><a href="#翻译软件-灵格斯" class="headerlink" title="翻译软件 灵格斯"></a>翻译软件 灵格斯</h3><p>下载地址<a href="http://www.lingoes.cn/" target="_blank" rel="noopener">http://www.lingoes.cn/</a></p><h3 id="CorelDRAWX7破解版"><a href="#CorelDRAWX7破解版" class="headerlink" title="CorelDRAWX7破解版"></a>CorelDRAWX7破解版</h3><p>下载地址[百度网盘]（<a href="http://pan.baidu.com/s/1ntVwlgH）" target="_blank" rel="noopener">http://pan.baidu.com/s/1ntVwlgH）</a><br>断网注册</p><h3 id="XMIND7破解版"><a href="#XMIND7破解版" class="headerlink" title="XMIND7破解版"></a>XMIND7破解版</h3><p>下载地址<a href="http://pan.baidu.com/s/1i3OdeVr" target="_blank" rel="noopener">百度网盘</a></p>]]></content>
      
      
      <categories>
          
          <category> 办公 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>硬链接软链接方式</title>
      <link href="/2016/11/08/%E7%A1%AC%E9%93%BE%E6%8E%A5%E8%BD%AF%E9%93%BE%E6%8E%A5%E6%96%B9%E5%BC%8F/"/>
      <url>/2016/11/08/%E7%A1%AC%E9%93%BE%E6%8E%A5%E8%BD%AF%E9%93%BE%E6%8E%A5%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h3 id="硬链结和符号链接的区别"><a href="#硬链结和符号链接的区别" class="headerlink" title="硬链结和符号链接的区别"></a>硬链结和符号链接的区别</h3><p>硬连接记录的是目标的 inode,符号连接记录的是目标的 path。<br>软连接就像是快捷方式,而硬连接就像是备份!符号连接可以做跨分区的 link；而 硬连接由于 inode 的缘故，只能在本分区中做 link.所以,符号连接的使用频率要高的多。</p><h3 id="软链接文件"><a href="#软链接文件" class="headerlink" title="软链接文件"></a>软链接文件</h3><p>软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。和win下的快捷方式差不多。链接文件甚至可以链接不存在的文件，这就产生一般称之为”断链”的问题(或曰“现象”)，链接文件甚至可以循环链接自己。类似于编程语言中的递归。 命令格式：</p><pre><code>ln [-s] source_path target_path </code></pre><h3 id="硬链接文件"><a href="#硬链接文件" class="headerlink" title="硬链接文件"></a>硬链接文件</h3><p>info ln 命令告诉您，硬链接是已存在文件的另一个名字，硬连接的命令是</p><pre><code>ln -d existfile newfile </code></pre><p>硬链接文件有两个限制 1、不允许给目录创建硬链接；<br>2、只有在同一文件系统中的文件之间才能创建链接。<br>对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。修改其中一个，与其连接的文件同时被修改</p><h3 id="Windows-下创建硬链接，只能适用于-NTFS-文件系统"><a href="#Windows-下创建硬链接，只能适用于-NTFS-文件系统" class="headerlink" title="Windows 下创建硬链接，只能适用于 NTFS 文件系统"></a>Windows 下创建硬链接，只能适用于 NTFS 文件系统</h3><pre><code>fsutil hardlink create NewFileName ExistingFileName</code></pre><h3 id="Windows-下创建软链接"><a href="#Windows-下创建软链接" class="headerlink" title="Windows 下创建软链接"></a>Windows 下创建软链接</h3><p>NTFS只支持对目录的软链接，微软把它称作 junction。但是对于文件的软链接，微软也有提供解决方案，那就是快捷方式(Shortcut，.lnk 文件)。不过软链接和快捷方式不是一个层次上的东西，前者是底层文件系统的功能，后者是应用层的功能。Windows 下目录的快捷方式用 dir 看起来是个文件。<br>命令方式</p><pre><code>junction  LinkDirectory ExistingDirectory</code></pre><p>例如</p><pre><code>junction d:\link c:\winnt</code></pre><p>将为c:\winnt 建立一个链接目录 d:\link，C和D分区都要是 NTFS 格式，在资源管理器和 dir 列示中 d:\link 都以目录的面目存在的。d:\link 就像是 c:\winnt 的一个引用一般，删除 d:\link 目录中的内容也就是删除了 c:\winnt 中的内容，但删除 d:\link 本身是不会影响到 c:\winnt 的。</p><h3 id="win7可以使用mklink命令"><a href="#win7可以使用mklink命令" class="headerlink" title="win7可以使用mklink命令"></a>win7可以使用mklink命令</h3><pre><code>λ mklink /?创建符号链接。MKLINK [[/D] | [/H] | [/J]] Link Target        /D      创建目录符号链接。默认为文件                符号链接。        /H      创建硬链接而非符号链接。        /J      创建目录联接。        Link    指定新的符号链接名称。        Target  指定新链接引用的路径                (相对或绝对)。</code></pre><p>其中\D \J区别如下</p><pre><code>E:\λ mkdir SourceDirE:\λ mklink /D DTargetDir\ SourceDir\为 DTargetDir\ &lt;&lt;===&gt;&gt; SourceDir\ 创建的符号链接E:\λ mklink /J JTargetDir\ SourceDir\为 JTargetDir\ &lt;&lt;===&gt;&gt; SourceDir\ 创建的联接</code></pre><p><img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160127111417.png" alt> <img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160127111459.png" alt> SourceDir,JTargetDir,DTargetDir 3个文件夹内部修改/增加/删除都会互相影响。<br>复制JTargetDir, 不会出现新的目录，文件夹文件内部复制 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160127112544.png" alt> 这样复制会影响DTargetDir和SourceDir，慎用！ 复制DTargetDir文件夹会生成一个全新的文件夹，不会被其他文件夹影响，也不能影响其他文件夹。 复制JTargetDir的父级目录不会影响该目录，复制生成的目录下JTargetDir目录会变成独立的文件夹且文件夹内为空 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160127132448.png" alt> ![][0.048387699760496616] [0.048387699760496616]: <a href="http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png" target="_blank" rel="noopener">http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png</a> 删除JTargetDir,DTargetDir均不影响SourceDir<br>删除SorceDir,会使得JTargetDir和DTargetDir失效 使用mklink /D时需要保证源目录和目标目录在同一个目录下，否则创建成功但不能正常访问</p><h3 id="linux服务器的软硬件链接"><a href="#linux服务器的软硬件链接" class="headerlink" title="linux服务器的软硬件链接"></a>linux服务器的软硬件链接</h3><p>软链接可以跨文件系统，硬链接不可以</p><pre><code>ln source target # 硬链接ln -s source target # 软链接</code></pre><p>软链接如果跨文件夹，必须使用绝对路径,否则会出现软链接无法访问的情况</p><pre><code>ln -s /var/www/html/Upload/product/manual/en/ /var/www/html/manual</code></pre>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php将pdf转为jpg，png图片</title>
      <link href="/2016/11/08/php%E5%B0%86pdf%E8%BD%AC%E4%B8%BAjpg%EF%BC%8Cpng%E5%9B%BE%E7%89%87/"/>
      <url>/2016/11/08/php%E5%B0%86pdf%E8%BD%AC%E4%B8%BAjpg%EF%BC%8Cpng%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>WINDOW,PHP5.2</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>安装ImageMagick并添加环境变量 <a href="http://www.imagemagick.org/script/index.php" target="_blank" rel="noopener">官网</a><br>安装php扩展php_imagick.dll,并在php.ini开启 <a href="https://pecl.php.net/package/imagick" target="_blank" rel="noopener">官网</a><br>查看是否载入扩展</p><pre><code>phpinfo();</code></pre><p>安装Ghostscript并添加环境变量 <a href="http://www.ghostscript.com/download/" target="_blank" rel="noopener">官网</a></p><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p><a href="http://pan.baidu.com/s/1kTOkhFL" target="_blank" rel="noopener">百度网盘</a></p><h3 id="测试是否可以正常运行"><a href="#测试是否可以正常运行" class="headerlink" title="测试是否可以正常运行"></a>测试是否可以正常运行</h3><pre><code>λ convert.exe SEZ588Hu.pdf SEZ588Hu.png</code></pre><h3 id="php代码"><a href="#php代码" class="headerlink" title="php代码"></a>php代码</h3><p>生成jpg文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $im = <span class="keyword">new</span> imagick(<span class="string">'A.pdf[0]'</span>);</span><br><span class="line">    $im-&gt;setImageFormat(<span class="string">'jpg'</span>);</span><br><span class="line">    $im-&gt;writeImages(<span class="string">'A.jpg'</span>, <span class="keyword">true</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>或者直接输出到浏览器</p><pre><code class="php"><span class="meta">&lt;?php</span>    $im = <span class="keyword">new</span> imagick(<span class="string">'file.pdf[0]'</span>);    $im-&gt;setImageFormat(<span class="string">'jpg'</span>);    header(<span class="string">'Content-Type: image/jpeg'</span>);    <span class="keyword">echo</span> $im;<span class="meta">?&gt;</span></code></pre><h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>1，将Ghostscript64位卸载，安装32位<br>2，将php.ini里的upload_tmp_dir对应目录权限修改为IISUER可读写</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oracle virtualbox入门基础</title>
      <link href="/2016/11/08/oracle%20virtualbox%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>/2016/11/08/oracle%20virtualbox%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="安装和主机共享"><a href="#安装和主机共享" class="headerlink" title="安装和主机共享"></a>安装和主机共享</h3><blockquote><p>点击设备，安装增强功能</p></blockquote><h3 id="共享剪贴板"><a href="#共享剪贴板" class="headerlink" title="共享剪贴板"></a>共享剪贴板</h3><blockquote><p>点击设备，共享剪贴板，双向</p></blockquote><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><blockquote><p>显示客户机菜单 右Ctrl+C 全屏快捷键 右Ctrl+F</p></blockquote><h3 id="4中网络连接形式-以下内容来自网络"><a href="#4中网络连接形式-以下内容来自网络" class="headerlink" title="4中网络连接形式(以下内容来自网络)"></a>4中网络连接形式(以下内容来自网络)</h3><p><strong>第一种 NAT模式</strong><br>解释： NAT模式是最简单的实现虚拟机上网的方式，你可以这样理解：Vhost访问网络的所有数据都是由主机提供的，vhost并不真实存在于网络中，主机与网络中的任何机器都不能查看和访问到Vhost的存在。<br>虚拟机与主机关系：<br>只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机。<br>虚拟机与网络中其他主机的关系：<br>只能单向访问，虚拟机可以访问到网络中其他主机，其他主机不能通过网络访问到虚拟机。<br>虚拟机与虚拟机之间的关系：<br>相互不能访问，虚拟机与虚拟机各自完全独立，相互间无法通过网络访问彼此。<br>IP:10.0.2.15<br>网关：10.0.2.2<br>DNS：10.0.2.3<br>一台虚拟机的多个网卡可以被设定使用 NAT， 第一个网卡连接了到专用网 10.0.2.0，第二个网卡连接到专用网络 10.0.3.0，等等。默认得到的客户端ip（IP Address）是10.0.2.15，网关（Gateway）是10.0.2.2，域名服务器（DNS）是10.0.2.3，可以手动参考这个进行修改。<br>NAT方案优缺点：<br>笔记本已插网线时： 虚拟机可以访问主机，虚拟机可以访问互联网，在做了端口映射后（最后有说明），主机可以访问虚拟机上的服务（如数据库）。<br>笔记本没插网线时： 主机的“本地连接”有红叉的，虚拟机可以访问主机，虚拟机不可以访问互联网，在做了端口映射后，主机可以访问虚拟机上的服务（如数据库）。 <strong>第二种 Bridged Adapter模式</strong><br>解释：<br>网桥模式是我最喜欢的用的一种模式，同时，模拟度也是相当完美。你可以这样理解，它是通过主机网卡，架设了一条桥，直接连入到网络中了。因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。<br>虚拟机与主机关系：<br>可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于网络中其他主机关系：<br>可以相互访问，同样因为虚拟机在真实网络段中有独立IP，虚拟机与所有网络其他主机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于虚拟机关系：<br>可以相互访问，原因同上。<br>IP：一般是DHCP分配的，与主机的“本地连接”的IP 是同一网段的。虚拟机就能与主机互相通信。<br>笔记本已插网线时：（若网络中有DHCP服务器）主机与虚拟机会通过DHCP分别得到一个IP，这两个IP在同一网段。 主机与虚拟机可以ping通，虚拟机可以上互联网。<br>笔记本没插网线时：主机与虚拟机不能通信。主机的“本地连接”有红叉，就不能手工指定IP。虚拟机也不能通过DHCP得到IP地址，手工指定IP后，也无法与主机通信，因为主机无IP。<br>这时主机的VirtualBox Host-Only Network 网卡是有ip的，192.168.56.1。虚拟机就算手工指定了IP 192.168.56.<em>，也ping不能主机。 *</em>第三种 Internal模式**<br>解释：<br>内网模式，顾名思义就是内部网络模式，虚拟机与外网完全断开，只实现虚拟机于虚拟机之间的内部网络模式。<br>虚拟机与主机关系：<br>不能相互访问，彼此不属于同一个网络，无法相互访问。<br>虚拟机与网络中其他主机关系：<br>不能相互访问，理由同上。<br>虚拟机与虚拟机关系：<br>可以相互访问，前提是在设置网络时，两台虚拟机设置同一网络名称。如上配置图中，名称为intnet。<br>IP: VirtualBox的DHCP服务器会为它分配IP ，一般得到的是192.168.56.101，因为是从101起分的，也可手工指定192.168.56.<em>。<br>笔记本已插网线时：虚拟机可以与主机的VirtualBox Host-Only Network 网卡通信<br>这种方案不受主机本地连接（网卡）是否有红叉的影响。 *</em>第四种 Host-only Adapter模式**<br>解释：<br>主机模式，这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这种模式下，通过虚拟机及网卡的设置都可以被实现。<br>我们可以理解为Vbox在主机中模拟出一张专供虚拟机使用的网卡，所有虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网及其他很多功能，比如（网卡共享、网卡桥接等）。<br>虚拟机与主机关系<br>默认不能相互访问，双方不属于同一IP段，host-only网卡默认IP段为192.168.56.X 子网掩码为255.255.255.0，后面的虚拟机被分配到的也都是这个网段。通过网卡共享、网卡桥接等，可以实现虚拟机于主机相互访问。<br>虚拟机与网络主机关系<br>默认不能相互访问，原因同上，通过设置，可以实现相互访问。<br>虚拟机与虚拟机关系<br>默认可以相互访问，都是同处于一个网段。<br>虚拟机访问主机 用的是主机的VirtualBox Host-Only Network网卡的IP：192.168.56.1 ，不管主机“本地连接”有无红叉，永远通。<br>主机访问虚拟机，用是的虚拟机的网卡3的IP： 192.168.56.101 ，不管主机“本地连接”有无红叉，永远通。<br>虚拟机访问互联网，用的是自己的网卡2， 这时主机要能通过“本地连接”有线上网，（无线网卡不行） 通过对以上几种网络模式的了解，我们就可以灵活运用，模拟组建出我们所想要的任何一种网络环境了。<br>比如我想模拟出来一个一台主机，监控一个局域网上网情况的网络环境。<br>首先我开启了两台虚拟机vhost1与vhost2，当然如果硬件允许，我同样可以再增加vhost3、vhost4…<br>所有的vhost我都设置成internat内网模式，网络名称为intnal，网关为192.168.56.100，意思就是通过 192.168.56.100网卡上网。其中有一台vhost1我设置为双网卡，一张为内网模式（192.168.56.100），一张为网桥模式 （192.168.1.101）。两张网卡设置双网卡共享上网<br>虚拟机之间为局域网，其中有一台虚拟机vhost1通过与外网相连，所有局域网中的虚拟机又通过vhost1来实现上外网。这样vhost1就可以监控整个虚拟机局域网上网情况了。</p><h3 id="xp下全屏"><a href="#xp下全屏" class="headerlink" title="xp下全屏"></a>xp下全屏</h3><p>安装增强包后再全局设置里设置成本机的分辨率 <img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160119172333.png" alt></p><h3 id="Ubuntu全屏"><a href="#Ubuntu全屏" class="headerlink" title="Ubuntu全屏"></a>Ubuntu全屏</h3><p>首先，安装增强包，点击Run Software<img src="http://7xq3ry.com1.z0.glb.clouddn.com/20160114170837.png" alt> 重启虚拟机<br>点击设备-&gt;分配光驱-&gt;移除虚拟盘<br>点击 右Ctrl+F全屏快捷键</p><h3 id="Ubuntu设置桥接网卡"><a href="#Ubuntu设置桥接网卡" class="headerlink" title="Ubuntu设置桥接网卡"></a>Ubuntu设置桥接网卡</h3><p>在设置-&gt;网络-&gt;连接方式-&gt;桥接网卡</p><pre><code>sudo vim /etc/network/interfaces</code></pre><p>修改配置文件,对应的信息要和主机的一致，保证虚拟机和主机在同一IP段</p><pre><code># The primary network interfaceauto eth0iface eth0 inet staticaddress 192.168.2.1gateway 192.168.2.254netmask 255.255.255.0#network 192.168.2.0#broadcast 192.168.2.255</code></pre><p>重启</p><pre><code>sudo /etc/init.d/networking restart</code></pre><p>在主机中设置上级路由器，放行虚拟机的MAC地址保证虚拟机可以访问外网。</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
